{"version":3,"file":"TaskProgressModal.js","sources":["components/message-pop-up/TaskProgressModal.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvOTcyNDcvRGVza3RvcC91bmktZWNvZnVsL2NvbXBvbmVudHMvbWVzc2FnZS1wb3AtdXAvVGFza1Byb2dyZXNzTW9kYWwudnVl"],"sourcesContent":["<template>\r\n\t<uni-popup ref=\"popup\" type=\"center\" :mask-click=\"false\">\r\n\t\t<view class=\"progress-modal\">\r\n\t\t\t<!-- 标题 -->\r\n\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t<uni-icons type=\"spinner-cycle\" size=\"24\" color=\"#166534\" class=\"spinning-icon\" />\r\n\t\t\t\t<text class=\"modal-title\">{{ title }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 进度条 -->\r\n\t\t\t<view class=\"progress-container\">\r\n\t\t\t\t<view class=\"progress-bar\">\r\n\t\t\t\t\t<view class=\"progress-fill\" :style=\"{ width: progress + '%' }\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<text class=\"progress-text\">{{ progress }}%</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 状态信息 -->\r\n\t\t\t<view class=\"status-info\">\r\n\t\t\t\t<view class=\"status-row\">\r\n\t\t\t\t\t<text class=\"status-label\">状态：</text>\r\n\t\t\t\t\t<text class=\"status-value\" :class=\"'status-' + state\">{{ stateText }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"status-row\">\r\n\t\t\t\t\t<text class=\"status-label\">当前步骤：</text>\r\n\t\t\t\t\t<text class=\"status-value status-step\">{{ statusText }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"estimatedTime\" class=\"status-row\">\r\n\t\t\t\t\t<text class=\"status-label\">预计剩余：</text>\r\n\t\t\t\t\t<text class=\"status-value status-time\">{{ estimatedTime }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 操作按钮（暂时隐藏取消功能）-->\r\n\t<!-- \t\t<view class=\"modal-actions\">\r\n\t\t\t\t<button v-if=\"cancelable\" class=\"btn-cancel\" @tap=\"handleCancel\">\r\n\t\t\t\t\t<uni-icons type=\"close\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t<text>取消任务</text>\r\n\t\t\t\t</button>\r\n\t\t\t</view> -->\r\n\t\t</view>\r\n\t</uni-popup>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue'\r\n\r\n// Props\r\nconst props = defineProps({\r\n\ttitle: {\r\n\t\ttype: String,\r\n\t\tdefault: '任务执行中'\r\n\t},\r\n\tprogress: {\r\n\t\ttype: Number,\r\n\t\tdefault: 0\r\n\t},\r\n\tstatusText: {\r\n\t\ttype: String,\r\n\t\tdefault: '正在处理...'\r\n\t},\r\n\tstate: {\r\n\t\ttype: String,\r\n\t\tdefault: 'running' // pending/running/success/failed\r\n\t},\r\n\tcancelable: {\r\n\t\ttype: Boolean,\r\n\t\tdefault: true\r\n\t}\r\n})\r\n\r\n// Emits\r\nconst emit = defineEmits(['cancel'])\r\n\r\n// Refs\r\nconst popup = ref(null)\r\n\r\n// 计算属性\r\nconst stateText = computed(() => {\r\n\tswitch (props.state) {\r\n\t\tcase 'pending': return '等待中'\r\n\t\tcase 'running': return '运行中'\r\n\t\tcase 'success': return '已完成'\r\n\t\tcase 'failed': return '失败'\r\n\t\tdefault: return '处理中'\r\n\t}\r\n})\r\n\r\n// 预计剩余时间（简单估算）\r\nconst estimatedTime = computed(() => {\r\n\tif (props.progress >= 100) return null\r\n\tif (props.progress <= 0) return null\r\n\t\r\n\t// 假设任务总时长3分钟，根据当前进度估算剩余时间\r\n\tconst totalSeconds = 180 // 3分钟\r\n\tconst remainingPercent = 100 - props.progress\r\n\tconst remainingSeconds = Math.ceil((remainingPercent / 100) * totalSeconds)\r\n\t\r\n\tif (remainingSeconds < 60) {\r\n\t\treturn `${remainingSeconds}秒`\r\n\t} else {\r\n\t\tconst minutes = Math.floor(remainingSeconds / 60)\r\n\t\tconst seconds = remainingSeconds % 60\r\n\t\treturn seconds > 0 ? `${minutes}分${seconds}秒` : `${minutes}分钟`\r\n\t}\r\n})\r\n\r\n// 方法\r\nfunction open() {\r\n\tpopup.value?.open()\r\n}\r\n\r\nfunction close() {\r\n\tpopup.value?.close()\r\n}\r\n\r\nfunction handleCancel() {\r\n\tuni.showModal({\r\n\t\ttitle: '确认取消',\r\n\t\tcontent: '确定要取消当前任务吗？',\r\n\t\tconfirmText: '确定取消',\r\n\t\tconfirmColor: '#dc2626',\r\n\t\tsuccess: (res) => {\r\n\t\t\tif (res.confirm) {\r\n\t\t\t\temit('cancel')\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// 暴露方法给父组件\r\ndefineExpose({\r\n\topen,\r\n\tclose\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.progress-modal {\r\n\twidth: 600rpx;\r\n\tbackground: #ffffff;\r\n\tborder-radius: 24rpx;\r\n\tpadding: 48rpx 40rpx;\r\n\tbox-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.12);\r\n}\r\n\r\n.modal-header {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tgap: 16rpx;\r\n\tmargin-bottom: 40rpx;\r\n}\r\n\r\n.spinning-icon {\r\n\tanimation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n\tfrom { transform: rotate(0deg); }\r\n\tto { transform: rotate(360deg); }\r\n}\r\n\r\n.modal-title {\r\n\tfont-size: 36rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #166534;\r\n}\r\n\r\n.progress-container {\r\n\tmargin-bottom: 32rpx;\r\n}\r\n\r\n.progress-bar {\r\n\twidth: 100%;\r\n\theight: 16rpx;\r\n\tbackground: #e5e7eb;\r\n\tborder-radius: 8rpx;\r\n\toverflow: hidden;\r\n\tmargin-bottom: 16rpx;\r\n}\r\n\r\n.progress-fill {\r\n\theight: 100%;\r\n\tbackground: linear-gradient(90deg, #166534 0%, #22c55e 100%);\r\n\tborder-radius: 8rpx;\r\n\ttransition: width 0.3s ease;\r\n}\r\n\r\n.progress-text {\r\n\tdisplay: block;\r\n\ttext-align: center;\r\n\tfont-size: 32rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #166534;\r\n}\r\n\r\n.status-info {\r\n\tbackground: #f9fafb;\r\n\tborder-radius: 16rpx;\r\n\tpadding: 24rpx;\r\n\tmargin-bottom: 32rpx;\r\n}\r\n\r\n.status-row {\r\n\tdisplay: flex;\r\n\talign-items: flex-start;\r\n\tmargin-bottom: 16rpx;\r\n\t\r\n\t&:last-child {\r\n\t\tmargin-bottom: 0;\r\n\t}\r\n}\r\n\r\n.status-label {\r\n\tfont-size: 28rpx;\r\n\tcolor: #6b7280;\r\n\tmin-width: 140rpx;\r\n\tflex-shrink: 0;\r\n}\r\n\r\n.status-value {\r\n\tfont-size: 28rpx;\r\n\tcolor: #1f2937;\r\n\tflex: 1;\r\n\tword-break: break-all;\r\n}\r\n\r\n.status-running {\r\n\tcolor: #166534;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.status-pending {\r\n\tcolor: #f59e0b;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.status-success {\r\n\tcolor: #22c55e;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.status-failed {\r\n\tcolor: #dc2626;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.status-step {\r\n\tline-height: 1.6;\r\n}\r\n\r\n.status-time {\r\n\tcolor: #f59e0b;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.modal-actions {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n}\r\n\r\n.btn-cancel {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tgap: 8rpx;\r\n\tpadding: 20rpx 48rpx;\r\n\tbackground: #ffffff;\r\n\tborder: 2rpx solid #dc2626;\r\n\tborder-radius: 12rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #dc2626;\r\n\t\r\n\t&:active {\r\n\t\topacity: 0.8;\r\n\t\tbackground: #fef2f2;\r\n\t}\r\n}\r\n</style>\r\n","import Component from 'C:/Users/97247/Desktop/uni-ecoful/components/message-pop-up/TaskProgressModal.vue'\nwx.createComponent(Component)"],"names":["ref","computed"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA,UAAM,QAAQ;AA2Bd,UAAM,QAAQA,cAAG,IAAC,IAAI;AAGtB,UAAM,YAAYC,cAAQ,SAAC,MAAM;AAChC,cAAQ,MAAM,OAAK;AAAA,QAClB,KAAK;AAAW,iBAAO;AAAA,QACvB,KAAK;AAAW,iBAAO;AAAA,QACvB,KAAK;AAAW,iBAAO;AAAA,QACvB,KAAK;AAAU,iBAAO;AAAA,QACtB;AAAS,iBAAO;AAAA,MAChB;AAAA,IACF,CAAC;AAGD,UAAM,gBAAgBA,cAAQ,SAAC,MAAM;AACpC,UAAI,MAAM,YAAY;AAAK,eAAO;AAClC,UAAI,MAAM,YAAY;AAAG,eAAO;AAGhC,YAAM,eAAe;AACrB,YAAM,mBAAmB,MAAM,MAAM;AACrC,YAAM,mBAAmB,KAAK,KAAM,mBAAmB,MAAO,YAAY;AAE1E,UAAI,mBAAmB,IAAI;AAC1B,eAAO,GAAG,gBAAgB;AAAA,MAC5B,OAAQ;AACN,cAAM,UAAU,KAAK,MAAM,mBAAmB,EAAE;AAChD,cAAM,UAAU,mBAAmB;AACnC,eAAO,UAAU,IAAI,GAAG,OAAO,IAAI,OAAO,MAAM,GAAG,OAAO;AAAA,MAC1D;AAAA,IACF,CAAC;AAGD,aAAS,OAAO;;AACf,kBAAM,UAAN,mBAAa;AAAA,IACd;AAEA,aAAS,QAAQ;;AAChB,kBAAM,UAAN,mBAAa;AAAA,IACd;AAiBA,aAAa;AAAA,MACZ;AAAA,MACA;AAAA,IACD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrID,GAAG,gBAAgB,SAAS;"}