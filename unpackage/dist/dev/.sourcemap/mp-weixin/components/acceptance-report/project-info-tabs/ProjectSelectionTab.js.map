{"version":3,"file":"ProjectSelectionTab.js","sources":["components/acceptance-report/project-info-tabs/ProjectSelectionTab.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvOTcyNDcvRGVza3RvcC91bmktZWNvZnVsL2NvbXBvbmVudHMvYWNjZXB0YW5jZS1yZXBvcnQvcHJvamVjdC1pbmZvLXRhYnMvUHJvamVjdFNlbGVjdGlvblRhYi52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"project-selection-tab\">\r\n\t\t<!-- 项目选择器 -->\r\n\t\t<view class=\"form-group\">\r\n\t\t\t<text class=\"form-label\">请选择要进行竣工验收的项目</text>\r\n\t\t\t<text class=\"form-tip\">项目文件已在项目管理模块上传并自动处理</text>\r\n\t\t\t\r\n\t\t\t<!-- 自定义项目选择器触发按钮 -->\r\n\t\t\t<view class=\"project-selector\" @tap=\"handleOpenPicker\">\r\n\t\t\t\t<view class=\"selector-content\">\r\n\t\t\t\t\t<view v-if=\"selectedProject\" class=\"selected-project\">\r\n\t\t\t\t\t\t<uni-icons type=\"folder\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t<view class=\"project-info\">\r\n\t\t\t\t\t\t\t<text class=\"project-name\">{{ selectedProject.name }}</text>\r\n\t\t\t\t\t\t\t<text v-if=\"selectedProject.description\" class=\"project-desc\">\r\n\t\t\t\t\t\t\t\t{{ selectedProject.description }}\r\n\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-else class=\"placeholder\">\r\n\t\t\t\t\t\t<uni-icons type=\"folder-add\" size=\"20\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t<text class=\"placeholder-text\">请选择项目</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<uni-icons type=\"down\" size=\"16\" color=\"#6b7280\" />\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 项目文件列表（只读） -->\r\n\t\t<view v-if=\"selectedProjectId && projectFiles.length > 0\" class=\"subsection\">\r\n\t\t\t<view class=\"subsection-head\">\r\n\t\t\t\t<uni-icons type=\"paperclip\" size=\"18\" color=\"#166534\" />\r\n\t\t\t\t<text class=\"subsection-title\">项目文件列表（{{ projectFiles.length }} 个文件）</text>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"file-list\">\r\n\t\t\t\t<view v-for=\"file in projectFiles\" :key=\"file.document_id\" class=\"file-item\">\r\n\t\t\t\t\t<view class=\"file-info\">\r\n\t\t\t\t\t\t<uni-icons :type=\"getFileIcon(file.file_extension)\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t<view class=\"file-details\">\r\n\t\t\t\t\t\t\t<text class=\"file-name\">{{ file.filename }}</text>\r\n\t\t\t\t\t\t\t<text class=\"file-meta\">\r\n\t\t\t\t\t\t\t\t{{ formatFileSize(file.size_bytes) }} · {{ formatFileStatus(file.status) }}\r\n\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"file-status\">\r\n\t\t\t\t\t\t<text class=\"status-badge\" :class=\"getStatusClass(file.status)\">\r\n\t\t\t\t\t\t\t{{ getStatusText(file.status) }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 空状态提示 -->\r\n\t\t<view v-else-if=\"selectedProjectId && projectFiles.length === 0\" class=\"empty-state\">\r\n\t\t\t<uni-icons type=\"folder-add\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t<text class=\"empty-text\">该项目暂无文件</text>\r\n\t\t\t<text class=\"empty-tip\">请先在项目管理模块上传文件</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 操作按钮 -->\r\n\t\t<view class=\"action-row\">\r\n\t\t\t<button \r\n\t\t\t\tclass=\"btn btn--primary\" \r\n\t\t\t\t@tap=\"handleExtract\"\r\n\t\t\t\t:disabled=\"!selectedProjectId || projectFiles.length === 0\">\r\n\t\t\t\t<uni-icons type=\"search\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t<text>提取项目基本信息</text>\r\n\t\t\t</button>\r\n\t\t\t\r\n\t\t\t<!-- 清除缓存按钮 -->\r\n\t\t\t<button v-if=\"baseTable.length > 0\" class=\"btn btn--ghost\" @tap=\"clearProjectCache\">\r\n\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t<text>清除缓存</text>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\r\n\r\n\t\t\r\n\t\t<!-- 任务进度弹窗 -->\r\n\t\t<TaskProgressModal \r\n\t\t\tref=\"taskProgressModal\" \r\n\t\t\t:title=\"taskProgressTitle\"\r\n\t\t\t:progress=\"taskProgress\" \r\n\t\t\t:statusText=\"taskStatusText\"\r\n\t\t\t:state=\"taskState\" \r\n\t\t\t:cancelable=\"false\" />\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { useProjectInfo } from '@/composables/useProjectInfo.js'\r\nimport TaskProgressModal from '@/components/message-pop-up/TaskProgressModal.vue'\r\n\r\n// 从 composable 获取所有状态和方法\r\nconst {\r\n\tselectedProjectId,\r\n\tselectedProject,\r\n\tprojectFiles,\r\n\tbaseTable,\r\n\textractionOk,\r\n\ttaskProgressTitle,\r\n\ttaskProgress,\r\n\ttaskStatusText,\r\n\ttaskState,\r\n\t\r\n\t// 方法\r\n\tsimulateExtract,\r\n\tclearProjectCache,\r\n\tgetFileIcon,\r\n\tformatFileSize,\r\n\tformatFileStatus,\r\n\tgetStatusText,\r\n\tgetStatusClass\r\n} = useProjectInfo()\r\n\r\n// 定义向上传递的事件\r\nconst emit = defineEmits(['open-picker'])\r\n\r\n// 组件内部的状态\r\nconst taskProgressModal = ref(null)\r\n\r\n// 打开项目选择器 - 通知父组件\r\nfunction handleOpenPicker() {\r\n\temit('open-picker')\r\n}\r\n\r\n// 处理提取\r\nasync function handleExtract() {\r\n\tawait simulateExtract(taskProgressModal.value)\r\n\t\r\n\t// 提取成功后，基本信息区域会自动显示（通过 v-if 控制）\r\n\tif (extractionOk.value) {\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '信息提取成功，请查看下方基本信息',\r\n\t\t\ticon: 'success',\r\n\t\t\tduration: 2000\r\n\t\t})\r\n\t}\r\n}\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n.project-selection-tab {\r\n\t// width: 100%;\r\n\tpadding: 24rpx;\r\n}\r\n\r\n.form-group {\r\n\tmargin-bottom: 32rpx;\r\n}\r\n\r\n.form-label {\r\n\tdisplay: block;\r\n\tfont-size: 28rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #1e293b;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.form-tip {\r\n\tdisplay: block;\r\n\tfont-size: 24rpx;\r\n\tcolor: #64748b;\r\n\tmargin-bottom: 16rpx;\r\n}\r\n\r\n// 项目选择器样式\r\n.project-selector {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n\tpadding: 24rpx;\r\n\tbackground: #ffffff;\r\n\tborder: 2rpx solid #e2e8f0;\r\n\tborder-radius: 12rpx;\r\n\tcursor: pointer;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.project-selector:active {\r\n\tbackground: #f8fafc;\r\n\tborder-color: #166534;\r\n}\r\n\r\n.selector-content {\r\n\tflex: 1;\r\n}\r\n\r\n.selected-project {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 16rpx;\r\n}\r\n\r\n.project-info {\r\n\tflex: 1;\r\n}\r\n\r\n.project-name {\r\n\tdisplay: block;\r\n\tfont-size: 28rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #1e293b;\r\n\tmargin-bottom: 4rpx;\r\n}\r\n\r\n.project-desc {\r\n\tdisplay: block;\r\n\tfont-size: 24rpx;\r\n\tcolor: #64748b;\r\n}\r\n\r\n.placeholder {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 12rpx;\r\n}\r\n\r\n.placeholder-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #9ca3af;\r\n}\r\n\r\n// 文件列表样式\r\n.subsection {\r\n\tmargin-bottom: 32rpx;\r\n}\r\n\r\n.subsection-head {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 12rpx;\r\n\tpadding: 16rpx 0;\r\n\tmargin-bottom: 16rpx;\r\n\tborder-bottom: 2rpx solid #e2e8f0;\r\n}\r\n\r\n.subsection-title {\r\n\tfont-size: 28rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #166534;\r\n}\r\n\r\n.file-list {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 16rpx;\r\n}\r\n\r\n.file-item {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n\tpadding: 20rpx;\r\n\tbackground: #f8fafc;\r\n\tborder-radius: 12rpx;\r\n\tborder: 1rpx solid #e2e8f0;\r\n}\r\n\r\n.file-info {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 16rpx;\r\n\tflex: 1;\r\n}\r\n\r\n.file-details {\r\n\tflex: 1;\r\n}\r\n\r\n.file-name {\r\n\tdisplay: block;\r\n\tfont-size: 26rpx;\r\n\tfont-weight: 500;\r\n\tcolor: #1e293b;\r\n\tmargin-bottom: 4rpx;\r\n}\r\n\r\n.file-meta {\r\n\tdisplay: block;\r\n\tfont-size: 22rpx;\r\n\tcolor: #64748b;\r\n}\r\n\r\n.file-status {\r\n\tflex-shrink: 0;\r\n}\r\n\r\n.status-badge {\r\n\tdisplay: inline-block;\r\n\tpadding: 8rpx 16rpx;\r\n\tfont-size: 22rpx;\r\n\tfont-weight: 500;\r\n\tborder-radius: 8rpx;\r\n\twhite-space: nowrap;\r\n}\r\n\r\n.status-uploaded {\r\n\tbackground: #dbeafe;\r\n\tcolor: #1e40af;\r\n}\r\n\r\n.status-processing {\r\n\tbackground: #fef3c7;\r\n\tcolor: #92400e;\r\n}\r\n\r\n.status-success {\r\n\tbackground: #dcfce7;\r\n\tcolor: #166534;\r\n}\r\n\r\n.status-error {\r\n\tbackground: #fee2e2;\r\n\tcolor: #991b1b;\r\n}\r\n\r\n// 空状态样式\r\n.empty-state {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 80rpx 40rpx;\r\n\ttext-align: center;\r\n}\r\n\r\n.empty-text {\r\n\tdisplay: block;\r\n\tfont-size: 28rpx;\r\n\tfont-weight: 500;\r\n\tcolor: #64748b;\r\n\tmargin-top: 24rpx;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.empty-tip {\r\n\tdisplay: block;\r\n\tfont-size: 24rpx;\r\n\tcolor: #94a3b8;\r\n}\r\n\r\n// 操作按钮样式\r\n.action-row {\r\n\tdisplay: flex;\r\n\tgap: 16rpx;\r\n\tmargin-top: 32rpx;\r\n}\r\n\r\n.btn {\r\n\tflex: 1;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tgap: 8rpx;\r\n\t// padding: 24rpx 32rpx;\r\n\tfont-size: 28rpx;\r\n\tfont-weight: 500;\r\n\tborder-radius: 12rpx;\r\n\tborder: none;\r\n\tcursor: pointer;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.btn--primary {\r\n\tbackground: #166534;\r\n\tcolor: #ffffff;\r\n}\r\n\r\n.btn--primary:active {\r\n\tbackground: #14532d;\r\n}\r\n\r\n.btn--primary:disabled {\r\n\tbackground: #cbd5e1;\r\n\tcolor: #94a3b8;\r\n\tcursor: not-allowed;\r\n}\r\n\r\n.btn--ghost {\r\n\tbackground: transparent;\r\n\tcolor: #dc2626;\r\n\tborder: 2rpx solid #dc2626;\r\n}\r\n\r\n.btn--ghost:active {\r\n\tbackground: #fef2f2;\r\n}\r\n\r\n\r\n// 响应式设计\r\n@media (max-width: 768px) {\r\n\t.action-row {\r\n\t\tflex-direction: column;\r\n\t}\r\n\t\r\n\t.btn {\r\n\t\twidth: 100%;\r\n\t}\r\n}\r\n</style>\r\n","import Component from 'C:/Users/97247/Desktop/uni-ecoful/components/acceptance-report/project-info-tabs/ProjectSelectionTab.vue'\nwx.createComponent(Component)"],"names":["useProjectInfo","ref","uni"],"mappings":";;;;;;;;;;;AA+FA,MAAM,oBAAoB,MAAW;;;;;AAGrC,UAAM;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA;AAAA,MAGA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD,IAAIA,0CAAgB;AAGpB,UAAM,OAAO;AAGb,UAAM,oBAAoBC,cAAG,IAAC,IAAI;AAGlC,aAAS,mBAAmB;AAC3B,WAAK,aAAa;AAAA,IACnB;AAGA,mBAAe,gBAAgB;AAC9B,YAAM,gBAAgB,kBAAkB,KAAK;AAG7C,UAAI,aAAa,OAAO;AACvBC,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACb,CAAG;AAAA,MACD;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7IA,GAAG,gBAAgB,SAAS;"}