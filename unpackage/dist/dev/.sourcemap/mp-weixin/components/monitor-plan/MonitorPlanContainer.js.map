{"version":3,"file":"MonitorPlanContainer.js","sources":["components/monitor-plan/MonitorPlanContainer.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvOTcyNDcvRGVza3RvcC91bmktZWNvZnVsL2NvbXBvbmVudHMvbW9uaXRvci1wbGFuL01vbml0b3JQbGFuQ29udGFpbmVyLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"monitor-plan-container\">\r\n\t\t<!-- 未选项目时：组件内部空状态 -->\r\n\t\t<view v-if=\"!projectId\" class=\"empty-state\">\r\n\t\t\t<uni-icons type=\"folder-add\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t<text class=\"empty-text\">请先选择项目</text>\r\n\t\t\t<text class=\"empty-tip\">请在第一步选择项目后，即可生成监测方案</text>\r\n\t\t</view>\r\n\t\t<!-- 已选项目：原来的完整界面 -->\r\n\t\t<view v-else class=\"section-card\">\r\n\t\t\t<view class=\"section-header\">\r\n\t\t\t\t<uni-icons type=\"eye\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t<text class=\"section-title\">监测方案</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"section-body\">\r\n\t\t\t\t<!-- 空状态提示 -->\r\n\t\t\t\t<view class=\"empty-state\">\r\n\t\t\t\t\t<uni-icons type=\"eye\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t<text class=\"empty-text\">AI帮您制定监测方案</text>\r\n\t\t\t\t\t<text class=\"empty-tip\">请点击下方按钮为您生成智能检测方案</text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 操作按钮 -->\r\n\t\t\t\t<view class=\"action-row\">\r\n\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"handleGenerate\" :disabled=\"isGenerating\">\r\n\t\t\t\t\t\t<uni-icons type=\"refresh-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t<text>生成监测方案</text>\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t<!-- 生成后显示下载按钮 -->\r\n\t\t\t\t\t<button v-if=\"canDownload\" class=\"btn btn--primary\" @tap=\"handleDownload\">\r\n\t\t\t\t\t\t<uni-icons type=\"cloud-download-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t<text>下载监测方案</text>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 预览卡片（生成后显示） -->\r\n\t\t\t\t<view v-if=\"plan\" class=\"plan-preview\">\r\n\t\t\t\t\t<view class=\"preview-header\">\r\n\t\t\t\t\t\t<uni-icons type=\"checkmark-circle\" size=\"18\" color=\"#166534\" />\r\n\t\t\t\t\t\t<text class=\"preview-title\">环保验收监测方案已为您已生成，请点击下载！</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- <view class=\"preview-content\">\r\n\t\t\t\t\t\t<text class=\"preview-text\">环保验收监测方案已生成，包含以下内容：</text>\r\n\t\t\t\t\t\t<view class=\"preview-sections\">\r\n\t\t\t\t\t\t\t<text class=\"section-item\">• 项目基本情况</text>\r\n\t\t\t\t\t\t\t<text class=\"section-item\">• 环保设施建设情况</text>\r\n\t\t\t\t\t\t\t<text class=\"section-item\">• 污染物详细情况</text>\r\n\t\t\t\t\t\t\t<text class=\"section-item\">• 方案已生成，请点击下载</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 进度弹窗 -->\r\n\t\t<TaskProgressModal ref=\"taskProgressModal\" :title=\"taskProgressTitle\" :progress=\"taskProgress\"\r\n\t\t\t:statusText=\"taskStatusText\" :state=\"taskState\" />\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue'\r\n\timport {\r\n\t\tuseMonitorPlan\r\n\t} from '@/composables/useMonitorPlan.js'\r\n\timport TaskProgressModal from '@/components/message-pop-up/TaskProgressModal.vue'\r\n\r\n\tconst props = defineProps({\r\n\t\t// 项目ID\r\n\t\tprojectId: {\r\n\t\t\ttype: [Number, String],\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\t// 是否已提取项目信息\r\n\t\thasExtracted: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t})\r\n\r\n\tconst emit = defineEmits(['plan-generated'])\r\n\r\n\t// 使用 composable\r\n\tconst {\r\n\t\tplan,\r\n\t\tcanDownload,\r\n\t\tisGenerating,\r\n\t\ttaskProgress,\r\n\t\ttaskStatusText,\r\n\t\ttaskState,\r\n\t\tgeneratePlan,\r\n\t\tdownloadPlan\r\n\t} = useMonitorPlan()\r\n\r\n\t// 进度弹窗 ref\r\n\tconst taskProgressModal = ref(null)\r\n\tconst taskProgressTitle = ref('监测方案生成中')\r\n\r\n\t// 生成监测方案\r\n\tasync function handleGenerate() {\r\n\t\tawait generatePlan(\r\n\t\t\tprops.projectId,\r\n\t\t\tprops.hasExtracted,\r\n\t\t\ttaskProgressModal.value\r\n\t\t)\r\n\r\n\t\t// 触发事件通知父组件\r\n\t\temit('plan-generated')\r\n\t}\r\n\r\n\t// 下载监测方案\r\n\tasync function handleDownload() {\r\n\t\tawait downloadPlan(props.projectId)\r\n\t}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\t.monitor-plan-container {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.section-card {\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 16rpx;\r\n\t\toverflow: hidden;\r\n\t\tbox-shadow: 0 2rpx 12rpx rgba(15, 23, 42, 0.08);\r\n\t}\r\n\r\n\t.section-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t\tpadding: 28rpx 24rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-bottom: 1rpx solid #e2e8f0;\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #166534;\r\n\t}\r\n\r\n\t.section-body {\r\n\t\tpadding: 32rpx 24rpx;\r\n\t}\r\n\r\n\t.empty-state {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 80rpx 40rpx;\r\n\t\tgap: 16rpx;\r\n\t}\r\n\r\n\t.empty-text {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #64748b;\r\n\t}\r\n\r\n\t.empty-tip {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #94a3b8;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.action-row {\r\n\t\tdisplay: flex;\r\n\t\tgap: 16rpx;\r\n\t\tjustify-content: center;\r\n\t\tmargin-top: 32rpx;\r\n\t}\r\n\r\n\t.btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tgap: 8rpx;\r\n\t\t// padding: 24rpx 48rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 500;\r\n\t\ttransition: all 0.3s ease;\r\n\t\tborder: none;\r\n\t}\r\n\r\n\t.btn--primary {\r\n\t\tbackground: #166534;\r\n\t\tcolor: #ffffff;\r\n\t}\r\n\r\n\t.btn--primary:active {\r\n\t\topacity: 0.8;\r\n\t\ttransform: scale(0.98);\r\n\t}\r\n\r\n\t.btn--primary:disabled {\r\n\t\topacity: 0.5;\r\n\t\tcursor: not-allowed;\r\n\t}\r\n\r\n\t.plan-preview {\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #f0fdf4;\r\n\t\tborder-radius: 12rpx;\r\n\t\tborder: 1rpx solid #dcfce7;\r\n\t\tmargin-top: 32rpx;\r\n\t}\r\n\r\n\t.preview-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.preview-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #166534;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.preview-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.preview-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #374151;\r\n\t}\r\n\r\n\t.preview-sections {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t\tpadding-left: 20rpx;\r\n\t}\r\n\r\n\t.section-item {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #475569;\r\n\t}\r\n\r\n\t/* 响应式设计 */\r\n\t@media (max-width: 768px) {\r\n\t\t.action-row {\r\n\t\t\tflex-direction: column;\r\n\t\t}\r\n\r\n\t\t.btn {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'C:/Users/97247/Desktop/uni-ecoful/components/monitor-plan/MonitorPlanContainer.vue'\nwx.createComponent(Component)"],"names":["useMonitorPlan","ref"],"mappings":";;;;;;;;;;;AAqEC,MAAM,oBAAoB,MAAW;;;;;;;;;;;;;;;;;AAErC,UAAM,QAAQ;AAad,UAAM,OAAO;AAGb,UAAM;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACA,IAAGA,0CAAgB;AAGpB,UAAM,oBAAoBC,cAAG,IAAC,IAAI;AAClC,UAAM,oBAAoBA,cAAG,IAAC,SAAS;AAGvC,mBAAe,iBAAiB;AAC/B,YAAM;AAAA,QACL,MAAM;AAAA,QACN,MAAM;AAAA,QACN,kBAAkB;AAAA,MAClB;AAGD,WAAK,gBAAgB;AAAA,IACrB;AAGD,mBAAe,iBAAiB;AAC/B,YAAM,aAAa,MAAM,SAAS;AAAA,IAClC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpHF,GAAG,gBAAgB,SAAS;"}