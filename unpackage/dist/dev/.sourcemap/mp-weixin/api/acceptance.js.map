{"version":3,"file":"acceptance.js","sources":["api/acceptance.js"],"sourcesContent":["/**\r\n * api/acceptance.js\r\n * 验收报告页面，各个方法总结\r\n * author:zyg\r\n * date:2025.12.1\r\n */\r\n\r\nimport {\r\n\tBASE_URL\r\n} from '@/utils/config.js'\r\nimport {\r\n\trequest\r\n} from '@/utils/request.js'\r\n\r\n//---------- 文件上传、文件处理方法----------------//\r\n/**\r\n * 上传单个文件到后端\r\n * @param {Object} file - uni-file-picker返回的文件对象\r\n * @returns {Promise} 上传结果\r\n */\r\nexport async function uploadFileToBackend(file) {\r\n\t// 获取文件路径\r\n\tconst filePath = file.url || file.path || file.tempFilePath\r\n\r\n\tif (!filePath) {\r\n\t\tthrow new Error('文件路径无效')\r\n\t}\r\n\r\n\ttry {\r\n\t\t// 使用封装的 upload 方法\r\n\t\tconst data = await request.upload('/api/v1/completion/documents/upload', filePath, {\r\n\t\t\tname: 'file',\r\n\t\t\tformData: {\r\n\t\t\t\tcategory: 'eia_report' // 标记为环评报告\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn {\r\n\t\t\tsuccess: true,\r\n\t\t\tdocument_id: data.document_id,\r\n\t\t\tfilename: data.filename,\r\n\t\t\tsize_bytes: data.size_bytes,\r\n\t\t\tupload_time: data.upload_time\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tthrow new Error(error.message || '上传失败')\r\n\t}\r\n}\r\n\r\n/**\r\n * 批量上传文件\r\n * @param {Array} files - 文件数组\r\n * @returns {Promise} 上传结果数组\r\n */\r\nexport async function uploadMultipleFiles(files) {\r\n\tif (!files || files.length === 0) {\r\n\t\tthrow new Error('没有选择文件')\r\n\t}\r\n\r\n\tconst uploadPromises = files.map(file => uploadFileToBackend(file))\r\n\treturn await Promise.all(uploadPromises)\r\n}\r\n\r\n\r\n/**\r\n * 获取已上传文件列表\r\n * @returns {Promise<Array>} 格式化后的文件列表\r\n */\r\nexport async function fetchUploadedFiles() {\r\n\ttry {\r\n\t\tconst res = await request.get('/api/v1/completion/documents?skip=0&limit=100')\r\n\t\tif (Array.isArray(res)) {\r\n\t\t\treturn res.map(file => ({\r\n\t\t\t\tname: file.filename,\r\n\t\t\t\text: file.metadata?.file_extension || '',\r\n\t\t\t\tdocument_id: file.document_id,\r\n\t\t\t\tsize: file.size_bytes,\r\n\t\t\t\tupload_time: file.upload_time\r\n\t\t\t}))\r\n\t\t}\r\n\t\treturn []\r\n\t} catch (error) {\r\n\t\tconsole.error('自动刷新文件列表失败:', error)\r\n\t\treturn []\r\n\t}\r\n}\r\n\r\n/**\r\n * 删除指定上传的文件\r\n * @param {string} document_id\r\n * @returns {Promise<void>}\r\n */\r\nexport async function deleteFile(document_id) {\r\n\tif (!document_id) throw new Error('document_id 不能为空')\r\n\tawait request.delete(`/api/v1/completion/documents/${document_id}`)\r\n}\r\n\r\n\r\n/**\r\n * 执行任务（提取项目信息）\r\n * @param {Object} options - 选项\r\n * @param {boolean} options.hideLoading - 是否隐藏 loading\r\n * @param {number} options.timeout - 超时时间（毫秒）\r\n * @returns {Promise<Object>} 任务执行结果\r\n */\r\nexport async function runTask(options = {}) {\r\n\tconst {\r\n\t\thideLoading = false,\r\n\t\t\ttimeout = 600000 // 默认10分钟\r\n\t} = options\r\n\r\n\ttry {\r\n\t\tconst result = await request.get(`/api/v1/completion/index-parallel-extract-info`, {\r\n\t\t\ttimeout,\r\n\t\t\thideLoading\r\n\t\t})\r\n\r\n\t\t// 数据校验\r\n\t\tif (!result || result.status !== 'success') {\r\n\t\t\tthrow new Error(result?.message || '任务执行失败')\r\n\t\t}\r\n\r\n\t\t// 适配后端实际返回\r\n\t\tconst data = result.result\r\n\t\tif (!data || typeof data !== 'object' || Object.keys(data).length === 0) {\r\n\t\t  throw new Error('未提取到任何项目信息，请检查文件内容是否完整')\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t  status: result.status,\r\n\t\t  result: data\r\n\t\t}\r\n\r\n\t\t// 返回前端期望的格式（保持向后兼容）\r\n\t\treturn {\r\n\t\t\tstatus: result.status,\r\n\t\t\tresult: result.extract_info.result\r\n\t\t}\r\n\t} catch (error) {\r\n\t\t// 错误分类处理\r\n\t\tif (error.code === 'NETWORK_ERROR' && error.message.includes('timeout')) {\r\n\t\t\tthrow new Error('提取超时：文档过大或网络不稳定，请稍后重试')\r\n\t\t} else if (error.code === 'HTTP_ERROR' && error.message.includes('404')) {\r\n\t\t\tthrow new Error('任务不存在，请联系管理员配置')\r\n\t\t} else {\r\n\t\t\tthrow error\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * 转换后端提取结果为 baseTable 格式（支持嵌套对象）\r\n * @param {Object} result - 后端返回的 result 对象\r\n * @returns {Array} baseTable 格式的数组\r\n */\r\nexport function transformExtractResult(result) {\r\n\t// 完整的字段映射表：后端中文 key -> 英文 id + 显示标签\r\n\tconst FIELD_MAP = {\r\n\t\t// 基本信息\r\n\t\t'建设项目名称': {\r\n\t\t\tid: 'project_name',\r\n\t\t\tlabel: '建设项目名称'\r\n\t\t},\r\n\t\t'建设单位名称': {\r\n\t\t\tid: 'company_name',\r\n\t\t\tlabel: '建设单位名称'\r\n\t\t},\r\n\t\t'建设地点': {\r\n\t\t\tid: 'project_address',\r\n\t\t\tlabel: '建设地点'\r\n\t\t},\r\n\t\t'建设项目性质': {\r\n\t\t\tid: 'project_type',\r\n\t\t\tlabel: '建设项目性质'\r\n\t\t},\r\n\t\t'产品及产能': {\r\n\t\t\tid: 'product_scale',\r\n\t\t\tlabel: '产品及产能'\r\n\t\t},\r\n\r\n\t\t// 审批信息\r\n\t\t'环评报告表审批部门': {\r\n\t\t\tid: 'assessment_department',\r\n\t\t\tlabel: '环评报告表审批部门'\r\n\t\t},\r\n\t\t'环评报告表编制单位': {\r\n\t\t\tid: 'assessment_unit',\r\n\t\t\tlabel: '环评报告表编制单位'\r\n\t\t},\r\n\r\n\t\t// 投资信息\r\n\t\t'投资总概算(万元)': {\r\n\t\t\tid: 'investment',\r\n\t\t\tlabel: '投资总概算(万元)'\r\n\t\t},\r\n\t\t'环保投资总概算(万元)': {\r\n\t\t\tid: 'env_investment',\r\n\t\t\tlabel: '环保投资总概算(万元)'\r\n\t\t},\r\n\t\t'比例': {\r\n\t\t\tid: 'env_investment_ratio',\r\n\t\t\tlabel: '环保投资占比'\r\n\t\t},\r\n\r\n\t\t// 建设内容\r\n\t\t'主要建设内容': {\r\n\t\t\tid: 'construction_content',\r\n\t\t\tlabel: '主要建设内容'\r\n\t\t},\r\n\t\t'改扩建项目变动情况': {\r\n\t\t\tid: 'project_changes',\r\n\t\t\tlabel: '改扩建项目变动情况'\r\n\t\t},\r\n\r\n\t\t// 污染物\r\n\t\t'生产工艺': {\r\n\t\t\tid: 'production_process',\r\n\t\t\tlabel: '生产工艺'\r\n\t\t},\r\n\t\t'噪声执行标准': {\r\n\t\t\tid: 'noise_standard',\r\n\t\t\tlabel: '噪声标准'\r\n\t\t},\r\n\t\t'固体废物产生情况': {\r\n\t\t\tid: 'solid_generation',\r\n\t\t\tlabel: '固体废物产生情况'\r\n\t\t},\r\n\t\t'污染物产排情况': {\r\n\t\t\tid: 'pollutants_emission',\r\n\t\t\tlabel: '污染物产排情况',\r\n\t\t\ttype: 'table' // 添加类型标识\r\n\t\t},\r\n\r\n\t}\r\n\r\n\tconst baseTable = []\r\n\r\n\t// 遍历 result 对象\r\n\tObject.entries(result).forEach(([chineseKey, value]) => {\r\n\t\t// 如果有映射，按映射显示\r\n\t\tif (FIELD_MAP[chineseKey]) {\r\n\t\t\tconst fieldConfig = FIELD_MAP[chineseKey]\r\n\r\n\t\t\t// ✅ 特殊处理表格类型数据\r\n\t\t\tif (fieldConfig.type === 'table') {\r\n\t\t\t\tbaseTable.push({\r\n\t\t\t\t\tid: fieldConfig.id,\r\n\t\t\t\t\tlabel: fieldConfig.label,\r\n\t\t\t\t\tvalue: value, // 保留原始对象，不进行格式化\r\n\t\t\t\t\tsource: 'extracted',\r\n\t\t\t\t\ttype: 'table' // 前端通过这个类型来识别需要渲染表格\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t// 普通字段正常处理\r\n\t\t\t\tbaseTable.push({\r\n\t\t\t\t\tid: fieldConfig.id,\r\n\t\t\t\t\tlabel: fieldConfig.label,\r\n\t\t\t\t\tvalue: formatValue(value),\r\n\t\t\t\t\tsource: 'extracted'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 如果是嵌套对象（但不是表格类型），展开显示\r\n\t\telse if (typeof value === 'object' && value !== null) {\r\n\t\t\tObject.entries(value).forEach(([subKey, subValue]) => {\r\n\t\t\t\tbaseTable.push({\r\n\t\t\t\t\tid: `${chineseKey}_${subKey}`,\r\n\t\t\t\t\tlabel: `${chineseKey} - ${subKey}`,\r\n\t\t\t\t\tvalue: formatValue(subValue),\r\n\t\t\t\t\tsource: 'extracted'\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t\t// 如果没有映射，直接显示\r\n\t\telse {\r\n\t\t\tbaseTable.push({\r\n\t\t\t\tid: chineseKey,\r\n\t\t\t\tlabel: chineseKey,\r\n\t\t\t\tvalue: formatValue(value),\r\n\t\t\t\tsource: 'extracted'\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\r\n\r\n\r\n\t// 按id顺序排序\r\n\tconst ORDER = [\r\n\t\t'project_name', // 建设项目名称\r\n\t\t'company_name', // 建设单位名称\r\n\t\t'project_address', // 建设地点\r\n\t\t'project_type', // 建设项目性质\r\n\t\t'product_scale', // 产品及产能\r\n\t\t'assessment_department', // 环评报告表审批部门\r\n\t\t'assessment_unit', // 环评报告表编制单位\r\n\t\t'investment', // 投资总概算(万元)\r\n\t\t'env_investment', // 环保投资总概算(万元)\r\n\t\t'env_investment_ratio', // 比例\r\n\t\t'construction_content', // 主要建设内容\r\n\t\t'project_changes', // 改扩建项目变动情况\r\n\t\t'production_process', // 生产工艺\r\n\t\t'noise_standard', // 噪声执行标准\r\n\t\t'solid_generation', // 固体废物产生情况\r\n\t\t'pollutants_emission', // 污染物产排情况\r\n\t];\r\n\treturn baseTable.sort((a, b) => {\r\n\t\tconst aIndex = ORDER.indexOf(a.id)\r\n\t\tconst bIndex = ORDER.indexOf(b.id)\r\n\t\tif (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex\r\n\t\tif (aIndex !== -1) return -1\r\n\t\tif (bIndex !== -1) return 1\r\n\t\treturn 0\r\n\t})\r\n}\r\n\r\n// 格式化值的辅助函数（处理数组、对象等）\r\nfunction formatValue(value) {\r\n\t// 如果是数组，转成字符串\r\n\tif (Array.isArray(value)) {\r\n\t\treturn value.length > 0 ? JSON.stringify(value, null, 2) : '-'\r\n\t}\r\n\t// 如果是对象，转成字符串\r\n\tif (typeof value === 'object' && value !== null) {\r\n\t\treturn JSON.stringify(value, null, 2)\r\n\t}\r\n\t// 如果是数字，直接返回\r\n\tif (typeof value === 'number') {\r\n\t\treturn value\r\n\t}\r\n\t// 如果是字符串，去掉首尾空格\r\n\tif (typeof value === 'string') {\r\n\t\treturn value.trim() || '-'\r\n\t}\r\n\t// 其他情况\r\n\treturn value || ''\r\n}\r\n\r\n/**\r\n * 标识牌下载\r\n * 纯前端数据 → 后端生成 Word\r\n * @param {Object} signboard  \r\n * @returns {Promise<ArrayBuffer>}\r\n */\r\nexport function downloadSignboardWord(signboard) {\r\n\tconst payload = {\r\n\t\tsections: signboard.sections.map(sec => ({\r\n\t\t\tblock: sec.block,\r\n\t\t\titems: sec.items.map(it => ({\r\n\t\t\t\ttitle: it.title,\r\n\t\t\t\tcontent: it.content\r\n\t\t\t}))\r\n\t\t}))\r\n\t};\r\n\r\n\t// #ifdef H5\r\n\t// H5 环境：uni.request 的 arraybuffer 不稳定，使用原生 fetch\r\n\treturn fetch(BASE_URL + '/api/v1/completion/signboard/download', {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json'\r\n\t\t},\r\n\t\tbody: JSON.stringify(payload)\r\n\t}).then(res => {\r\n\t\tif (!res.ok) throw new Error('生成失败')\r\n\t\treturn res.arrayBuffer()\r\n\t})\r\n\t// #endif\r\n\r\n\t// #ifndef H5\r\n\t// 小程序/App 环境：直接使用 uni.request（因为 responseType 需要特殊处理）\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tuni.request({\r\n\t\t\turl: BASE_URL + '/api/v1/completion/signboard/download',\r\n\t\t\tmethod: 'POST',\r\n\t\t\tdata: payload,\r\n\t\t\theader: {\r\n\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t},\r\n\t\t\tresponseType: 'arraybuffer',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tconsole.log('标识牌下载响应:', res)\r\n\t\t\t\tif (res.statusCode === 200 && res.data) {\r\n\t\t\t\t\t// 检查是否是 ArrayBuffer\r\n\t\t\t\t\tif (res.data instanceof ArrayBuffer && res.data.byteLength > 0) {\r\n\t\t\t\t\t\tresolve(res.data)\r\n\t\t\t\t\t} else if (typeof res.data === 'string' && res.data.length > 0) {\r\n\t\t\t\t\t\t// 如果返回的是字符串，说明小程序没有正确处理 arraybuffer\r\n\t\t\t\t\t\tuni.showToast({ title: '文件格式错误', icon: 'none' })\r\n\t\t\t\t\t\treject(new Error('文件格式错误'))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error('空文件'))\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treject(new Error('生成失败'))\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfail: (error) => {\r\n\t\t\t\treject(new Error(error.errMsg || '网络请求失败'))\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t// #endif\r\n}\r\n\r\n/**\r\n * 生成并下载监测方案（Word/Markdown）\r\n * 调用后端 RAG + LLM 生成监测方案文档\r\n * @param {Object} options - 选项\r\n * @param {boolean} options.hideLoading - 是否隐藏 loading（默认 false）\r\n * @param {number} options.timeout - 超时时间（毫秒，默认10分钟）\r\n * @returns {Promise<ArrayBuffer>} 文件的二进制数据\r\n */\r\nexport function downloadMonitorPlan(options = {}) {\r\n  const {\r\n    hideLoading = false,\r\n    timeout = 600000  // 默认10分钟，因为涉及 RAG 检索 + LLM 生成\r\n  } = options\r\n\r\n  // #ifdef H5\r\n  // H5 环境：uni.request 的 arraybuffer 不稳定，使用原生 fetch\r\n  const controller = new AbortController()\r\n  const timeoutId = setTimeout(() => controller.abort(), timeout)\r\n  \r\n  return fetch(BASE_URL + '/api/v1/completion/monitor-plan/generate', {\r\n    method: 'GET',\r\n    signal: controller.signal\r\n  }).then(res => {\r\n    clearTimeout(timeoutId)\r\n    if (!res.ok) throw new Error('生成失败')\r\n    return res.arrayBuffer()\r\n  }).catch(err => {\r\n    clearTimeout(timeoutId)\r\n    if (err.name === 'AbortError') {\r\n      throw new Error('请求超时，请稍后重试')\r\n    }\r\n    throw err\r\n  })\r\n  // #endif\r\n\r\n  // #ifndef H5\r\n  // 小程序/App 环境：直接使用 uni.request\r\n  return new Promise((resolve, reject) => {\r\n    const requestTask = uni.request({\r\n      url: BASE_URL + '/api/v1/completion/monitor-plan/generate',\r\n      method: 'GET',\r\n      responseType: 'arraybuffer',\r\n      timeout: timeout,\r\n      success: (res) => {\r\n        console.log('监测方案下载响应:', res)\r\n        if (res.statusCode === 200 && res.data) {\r\n          // 检查是否是 ArrayBuffer\r\n          if (res.data instanceof ArrayBuffer && res.data.byteLength > 0) {\r\n            resolve(res.data)\r\n          } else if (typeof res.data === 'string' && res.data.length > 0) {\r\n            // 如果返回的是字符串，说明小程序没有正确处理 arraybuffer\r\n            uni.showToast({ title: '文件格式错误', icon: 'none' })\r\n            reject(new Error('文件格式错误'))\r\n          } else {\r\n            reject(new Error('空文件'))\r\n          }\r\n        } else {\r\n          reject(new Error('生成失败'))\r\n        }\r\n      },\r\n      fail: (error) => {\r\n        reject(new Error(error.errMsg || '网络请求失败'))\r\n      }\r\n    })\r\n\r\n    // 超时处理\r\n    setTimeout(() => {\r\n      requestTask.abort()\r\n      reject(new Error('请求超时，监测方案生成时间较长，请稍后重试'))\r\n    }, timeout)\r\n  })\r\n  // #endif\r\n}\r\n\r\n\r\n"],"names":["request","uni","BASE_URL"],"mappings":"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"}