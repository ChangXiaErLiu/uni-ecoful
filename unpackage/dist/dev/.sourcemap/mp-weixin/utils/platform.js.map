{"version":3,"file":"platform.js","sources":["utils/platform.js"],"sourcesContent":["﻿// utils/platform.js\n// 判断屏幕大小，确定web还是移动端\nimport { computed, onMounted, onUnmounted, ref } from 'vue'\n\nexport function usePlatformInfo() {\n  const windowWidth = ref(375)\n  const windowHeight = ref(812)\n  const platform = ref('web')\n\n  function refreshSizeSync() {\n    try {\n      const info = uni.getSystemInfoSync()\n      windowWidth.value = info.windowWidth\n      windowHeight.value = info.windowHeight\n      platform.value = info.platform || 'web'\n    } catch (e) {\n      // H5 兜底\n      if (typeof window !== 'undefined') {\n        windowWidth.value = window.innerWidth\n        windowHeight.value = window.innerHeight\n        platform.value = 'web'\n      }\n    }\n  }\n\n  function handleResize(res) {\n    try {\n      if (res?.size) {\n        windowWidth.value = res.size.windowWidth\n        windowHeight.value = res.size.windowHeight\n      } else if (typeof window !== 'undefined') {\n        windowWidth.value = window.innerWidth\n        windowHeight.value = window.innerHeight\n      }\n    } catch {}\n  }\n\n  // 立即初始化一次（避免首屏误判）\n  refreshSizeSync()\n\n  onMounted(() => {\n    // 优先用 uni.onWindowResize\n    if (typeof uni.onWindowResize === 'function') {\n      uni.onWindowResize(handleResize)\n    }\n    // H5 兜底：部分版本/环境 uni.onWindowResize 不触发\n    if (typeof window !== 'undefined') {\n      window.addEventListener('resize', handleResize)\n    }\n  })\n\n  onUnmounted(() => {\n    if (typeof uni.offWindowResize === 'function') {\n      uni.offWindowResize(handleResize)\n    }\n    if (typeof window !== 'undefined') {\n      window.removeEventListener('resize', handleResize)\n    }\n  })\n\n  const isDesktop = computed(() => windowWidth.value >= 1024)\n  const isTablet  = computed(() => windowWidth.value >= 768 && windowWidth.value < 1024)\n  const isMobile  = computed(() => windowWidth.value < 768)\n\n  return { windowWidth, windowHeight, platform, isDesktop, isTablet, isMobile }\n}\n"],"names":["ref","uni","onMounted","onUnmounted","computed"],"mappings":";;AAIO,SAAS,kBAAkB;AAChC,QAAM,cAAcA,cAAG,IAAC,GAAG;AAC3B,QAAM,eAAeA,cAAG,IAAC,GAAG;AAC5B,QAAM,WAAWA,cAAG,IAAC,KAAK;AAE1B,WAAS,kBAAkB;AACzB,QAAI;AACF,YAAM,OAAOC,cAAG,MAAC,kBAAmB;AACpC,kBAAY,QAAQ,KAAK;AACzB,mBAAa,QAAQ,KAAK;AAC1B,eAAS,QAAQ,KAAK,YAAY;AAAA,IACnC,SAAQ,GAAG;AAEV,UAAI,OAAO,WAAW,aAAa;AACjC,oBAAY,QAAQ,OAAO;AAC3B,qBAAa,QAAQ,OAAO;AAC5B,iBAAS,QAAQ;AAAA,MAClB;AAAA,IACF;AAAA,EACF;AAED,WAAS,aAAa,KAAK;AACzB,QAAI;AACF,UAAI,2BAAK,MAAM;AACb,oBAAY,QAAQ,IAAI,KAAK;AAC7B,qBAAa,QAAQ,IAAI,KAAK;AAAA,MACtC,WAAiB,OAAO,WAAW,aAAa;AACxC,oBAAY,QAAQ,OAAO;AAC3B,qBAAa,QAAQ,OAAO;AAAA,MAC7B;AAAA,IACF,QAAO;AAAA,IAAE;AAAA,EACX;AAGD,kBAAiB;AAEjBC,gBAAAA,UAAU,MAAM;AAEd,QAAI,OAAOD,cAAAA,MAAI,mBAAmB,YAAY;AAC5CA,oBAAG,MAAC,eAAe,YAAY;AAAA,IAChC;AAED,QAAI,OAAO,WAAW,aAAa;AACjC,aAAO,iBAAiB,UAAU,YAAY;AAAA,IAC/C;AAAA,EACL,CAAG;AAEDE,gBAAAA,YAAY,MAAM;AAChB,QAAI,OAAOF,cAAAA,MAAI,oBAAoB,YAAY;AAC7CA,oBAAG,MAAC,gBAAgB,YAAY;AAAA,IACjC;AACD,QAAI,OAAO,WAAW,aAAa;AACjC,aAAO,oBAAoB,UAAU,YAAY;AAAA,IAClD;AAAA,EACL,CAAG;AAED,QAAM,YAAYG,cAAQ,SAAC,MAAM,YAAY,SAAS,IAAI;AAC1D,QAAM,WAAYA,cAAQ,SAAC,MAAM,YAAY,SAAS,OAAO,YAAY,QAAQ,IAAI;AACrF,QAAM,WAAYA,cAAQ,SAAC,MAAM,YAAY,QAAQ,GAAG;AAExD,SAAO,EAAE,aAAa,cAAc,UAAU,WAAW,UAAU,SAAU;AAC/E;;"}