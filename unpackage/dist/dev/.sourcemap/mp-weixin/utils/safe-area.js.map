{"version":3,"file":"safe-area.js","sources":["utils/safe-area.js"],"sourcesContent":["// utf-8\n// 中文注释：安全区与导航栏尺寸工具，统一获取状态栏、胶囊与底部安全区，跨端兜底\nimport { ref, computed, onMounted } from 'vue'\n\nexport function useSafeArea() {\n  const statusBarHeightPx = ref(0)\n  // 中文注释：兜底导航栏高度（iOS 通常 44px）\n  const navBarHeightPx = ref(44)\n  // 中文注释：底部安全区高度（适配全面屏/Home 指示条）\n  const safeAreaBottomPx = ref(0)\n  // 中文注释：总导航高度（状态栏 + 自定义导航高度）\n  const totalNavHeightPx = computed(() => Number(statusBarHeightPx.value || 0) + Number(navBarHeightPx.value || 0))\n\n  function refresh() {\n    try {\n      const info = uni.getSystemInfoSync()\n      statusBarHeightPx.value = Number(info.statusBarHeight || 0)\n\n      // 中文注释：计算底部安全区（以 screenHeight 与 safeArea.bottom 差值为准）\n      try {\n        const screenH = Number(info.screenHeight || 0)\n        const safeBottom = Number((info.safeArea && info.safeArea.bottom) || 0)\n        const insetBottom = Math.max(0, screenH - safeBottom)\n        safeAreaBottomPx.value = isNaN(insetBottom) ? 0 : insetBottom\n      } catch (e) {\n        safeAreaBottomPx.value = 0\n      }\n\n      // #ifdef MP-WEIXIN\n      try {\n        const cap = uni.getMenuButtonBoundingClientRect()\n        // 中文注释：自定义导航栏高度应该让内容区从胶囊底部开始，并留出底部边距\n        // 计算胶囊顶部到状态栏的间距\n        const topGap = cap.top - statusBarHeightPx.value\n        // 导航栏高度 = 胶囊高度 + 顶部间距 + 底部间距（上下对称）\n        navBarHeightPx.value = cap.height + Math.abs(topGap) + Math.abs(topGap)\n        \n        // 调试日志：输出所有关键数据\n        // console.log('=== 安全区调试信息 ===')\n        // console.log('statusBarHeight:', statusBarHeightPx.value)\n        // console.log('cap.top:', cap.top)\n        // console.log('cap.bottom:', cap.bottom)\n        // console.log('cap.height:', cap.height)\n        // console.log('topGap:', topGap)\n        // console.log('计算公式: cap.height + |topGap| * 2 =', cap.height, '+', Math.abs(topGap) * 2)\n        // console.log('navBarHeight:', navBarHeightPx.value)\n        // console.log('totalNavHeight:', statusBarHeightPx.value + navBarHeightPx.value)\n        // console.log('===================')\n      } catch (e) {\n        navBarHeightPx.value = 44\n      }\n      // #endif\n\n      // #ifndef MP-WEIXIN\n      // 中文注释：其他端给出一个合理的默认值\n      if (!navBarHeightPx.value || isNaN(navBarHeightPx.value)) {\n        navBarHeightPx.value = 44\n      }\n      // #endif\n    } catch (e) {\n      statusBarHeightPx.value = 20\n      navBarHeightPx.value = 44\n      safeAreaBottomPx.value = 0\n    }\n  }\n\n  onMounted(refresh)\n  refresh()\n\n  return {\n    statusBarHeightPx,\n    navBarHeightPx,\n    totalNavHeightPx,\n    safeAreaBottomPx,\n  }\n}\n\n"],"names":["ref","computed","uni","onMounted"],"mappings":";;AAIO,SAAS,cAAc;AAC5B,QAAM,oBAAoBA,cAAG,IAAC,CAAC;AAE/B,QAAM,iBAAiBA,cAAG,IAAC,EAAE;AAE7B,QAAM,mBAAmBA,cAAG,IAAC,CAAC;AAE9B,QAAM,mBAAmBC,cAAAA,SAAS,MAAM,OAAO,kBAAkB,SAAS,CAAC,IAAI,OAAO,eAAe,SAAS,CAAC,CAAC;AAEhH,WAAS,UAAU;AACjB,QAAI;AACF,YAAM,OAAOC,cAAG,MAAC,kBAAmB;AACpC,wBAAkB,QAAQ,OAAO,KAAK,mBAAmB,CAAC;AAG1D,UAAI;AACF,cAAM,UAAU,OAAO,KAAK,gBAAgB,CAAC;AAC7C,cAAM,aAAa,OAAQ,KAAK,YAAY,KAAK,SAAS,UAAW,CAAC;AACtE,cAAM,cAAc,KAAK,IAAI,GAAG,UAAU,UAAU;AACpD,yBAAiB,QAAQ,MAAM,WAAW,IAAI,IAAI;AAAA,MACnD,SAAQ,GAAG;AACV,yBAAiB,QAAQ;AAAA,MAC1B;AAGD,UAAI;AACF,cAAM,MAAMA,cAAG,MAAC,gCAAiC;AAGjD,cAAM,SAAS,IAAI,MAAM,kBAAkB;AAE3C,uBAAe,QAAQ,IAAI,SAAS,KAAK,IAAI,MAAM,IAAI,KAAK,IAAI,MAAM;AAAA,MAavE,SAAQ,GAAG;AACV,uBAAe,QAAQ;AAAA,MACxB;AAAA,IASF,SAAQ,GAAG;AACV,wBAAkB,QAAQ;AAC1B,qBAAe,QAAQ;AACvB,uBAAiB,QAAQ;AAAA,IAC1B;AAAA,EACF;AAEDC,gBAAAA,UAAU,OAAO;AACjB,UAAS;AAET,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD;AACH;;"}