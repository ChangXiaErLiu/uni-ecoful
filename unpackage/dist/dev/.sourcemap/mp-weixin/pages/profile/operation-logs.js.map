{"version":3,"file":"operation-logs.js","sources":["pages/profile/operation-logs.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9vcGVyYXRpb24tbG9ncy52dWU"],"sourcesContent":["<!-- 操作/登录日志页面（UTF-8，中文注释） -->\n<template>\n  <app-layout current=\"pages/profile/operation-logs\">\n    <view class=\"profile-page\">\n      <view class=\"profile__card\">\n        <view class=\"profile__card-header\">\n          <uni-icons type=\"list\" size=\"20\" color=\"#276019\" />\n          <text class=\"profile__card-title\">操作日志</text>\n        </view>\n        <view class=\"profile__card-content\">\n          <view v-if=\"loading && page===1\" class=\"list-hint\">加载中...</view>\n          <view v-else-if=\"list.length===0\" class=\"list-hint\">暂无日志</view>\n\n          <view v-for=\"(item, idx) in list\" :key=\"item.id || idx\" class=\"log-row\">\n            <view class=\"log-main\">\n              <text class=\"log-type\">{{ item.type || '操作' }}</text>\n              <text class=\"log-time\">{{ item.time || '-' }}</text>\n            </view>\n            <view class=\"log-sub\">{{ (item.device || '-') + ' · ' + (item.ip || '-') + ' · ' + (item.result || '-') }}</view>\n          </view>\n\n          <view v-if=\"hasMore\" class=\"load-more\">\n            <button class=\"btn-secondary\" :disabled=\"loadingMore\" @tap=\"loadMore\">{{ loadingMore ? '加载中...' : '加载更多' }}</button>\n          </view>\n        </view>\n      </view>\n\n      <view class=\"safe-area-bottom\" />\n    </view>\n  </app-layout>\n</template>\n\n<script setup>\n// UTF-8，中文注释\nimport { ref } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\nimport AppLayout from '@/components/layout/AppLayout.vue'\nimport { navTitleStore } from '@/stores/navTitle.js'\nimport { request } from '@/utils/request.js'\n\nconst navTitle = navTitleStore()\nonShow(() => {\n  navTitle.setTitle('操作日志')\n  init()\n})\n\nconst list = ref([])\nconst page = ref(1)\nconst pageSize = 20\nconst hasMore = ref(false)\nconst loading = ref(false)\nconst loadingMore = ref(false)\n\nasync function init() {\n  page.value = 1\n  list.value = []\n  await fetchList()\n}\n\nasync function fetchList() {\n  if (page.value === 1) loading.value = true\n  try {\n    const res = await request({ url: `/user/logs?page=${page.value}&size=${pageSize}`, method: 'GET' })\n    const rows = res?.list || []\n    list.value = page.value === 1 ? rows : list.value.concat(rows)\n    const total = res?.page?.total || 0\n    const current = list.value.length\n    hasMore.value = current < total\n  } catch (e) {\n    if (page.value === 1) list.value = []\n    uni.showToast({ title: '加载失败', icon: 'none' })\n  } finally {\n    if (page.value === 1) loading.value = false\n    loadingMore.value = false\n  }\n}\n\nfunction loadMore() {\n  if (!hasMore.value || loadingMore.value) return\n  loadingMore.value = true\n  page.value += 1\n  fetchList()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.profile-page { display: flex; flex-direction: column; gap: 24rpx; background-color: #f5f7fa; }\n.profile__card { background-color: #ffffff; border-radius: 20rpx; overflow: hidden; }\n.profile__card-header { display: flex; align-items: center; gap: 16rpx; padding: 32rpx 32rpx 24rpx; border-bottom: 1rpx solid #f1f5f9; }\n.profile__card-title { font-size: 30rpx; font-weight: 600; color: #0f172a; }\n.profile__card-content { padding: 0; }\n\n.log-row { padding: 24rpx 32rpx; border-bottom: 1rpx solid #f8fafc; }\n.log-main { display: flex; justify-content: space-between; gap: 16rpx; }\n.log-type { font-size: 28rpx; color: #0f172a; font-weight: 600; }\n.log-time { font-size: 26rpx; color: #64748b; }\n.log-sub { margin-top: 8rpx; font-size: 26rpx; color: #94a3b8; }\n\n.load-more { display: flex; justify-content: center; padding: 20rpx 0 28rpx; }\n.btn-secondary { padding: 16rpx 24rpx; background: #f1f5f9; color: #276019; border: none; border-radius: 12rpx; font-size: 26rpx; }\n\n.list-hint { padding: 32rpx; font-size: 28rpx; color: #94a3b8; text-align: center; }\n.safe-area-bottom { height: env(safe-area-inset-bottom); min-height: 0rpx; }\n</style>\n\n","import MiniProgramPage from 'C:/Users/97247/Desktop/uni-ecoful/pages/profile/operation-logs.vue'\nwx.createPage(MiniProgramPage)"],"names":["navTitleStore","onShow","ref","request","uni"],"mappings":";;;;;;;;;;;;AAoCA,MAAM,YAAY,MAAW;AAY7B,MAAM,WAAW;;;;AARjB,UAAM,WAAWA,gBAAAA,cAAe;AAChCC,kBAAAA,OAAO,MAAM;AACX,eAAS,SAAS,MAAM;AACxB,WAAM;AAAA,IACR,CAAC;AAED,UAAM,OAAOC,cAAG,IAAC,EAAE;AACnB,UAAM,OAAOA,cAAG,IAAC,CAAC;AAElB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,cAAcA,cAAG,IAAC,KAAK;AAE7B,mBAAe,OAAO;AACpB,WAAK,QAAQ;AACb,WAAK,QAAQ,CAAE;AACf,YAAM,UAAW;AAAA,IACnB;AAEA,mBAAe,YAAY;;AACzB,UAAI,KAAK,UAAU;AAAG,gBAAQ,QAAQ;AACtC,UAAI;AACF,cAAM,MAAM,MAAMC,cAAAA,QAAQ,EAAE,KAAK,mBAAmB,KAAK,KAAK,SAAS,QAAQ,IAAI,QAAQ,MAAK,CAAE;AAClG,cAAM,QAAO,2BAAK,SAAQ,CAAE;AAC5B,aAAK,QAAQ,KAAK,UAAU,IAAI,OAAO,KAAK,MAAM,OAAO,IAAI;AAC7D,cAAM,UAAQ,gCAAK,SAAL,mBAAW,UAAS;AAClC,cAAM,UAAU,KAAK,MAAM;AAC3B,gBAAQ,QAAQ,UAAU;AAAA,MAC3B,SAAQ,GAAG;AACV,YAAI,KAAK,UAAU;AAAG,eAAK,QAAQ,CAAE;AACrCC,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,MACjD,UAAY;AACR,YAAI,KAAK,UAAU;AAAG,kBAAQ,QAAQ;AACtC,oBAAY,QAAQ;AAAA,MACrB;AAAA,IACH;AAEA,aAAS,WAAW;AAClB,UAAI,CAAC,QAAQ,SAAS,YAAY;AAAO;AACzC,kBAAY,QAAQ;AACpB,WAAK,SAAS;AACd,gBAAW;AAAA,IACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjFA,GAAG,WAAW,eAAe;"}