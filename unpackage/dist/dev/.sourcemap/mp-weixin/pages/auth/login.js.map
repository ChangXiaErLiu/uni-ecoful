{"version":3,"file":"login.js","sources":["pages/auth/login.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYXV0aC9sb2dpbi52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"auth\">\r\n\t\t<view class=\"auth__card\">\r\n\t\t\t<view class=\"auth__header\">\r\n\t\t\t\t<text class=\"auth__title\">登录账户</text>\r\n\t\t\t\t<text class=\"auth__subtitle\">选择登录方式，体验智能工作台</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 登录方式切换 -->\r\n\t\t\t<view class=\"auth__tabs\">\r\n\t\t\t\t<view class=\"auth__tab\" :class=\"{ 'auth__tab--active': activeTab === 'code' }\" @tap=\"switchTab('code')\">\r\n\t\t\t\t\t验证码登录\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"auth__tab\" :class=\"{ 'auth__tab--active': activeTab === 'password' }\"\r\n\t\t\t\t\t@tap=\"switchTab('password')\">\r\n\t\t\t\t\t密码登录\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"auth__tab\" :class=\"{ 'auth__tab--active': activeTab === 'wechat' }\"\r\n\t\t\t\t\t@tap=\"switchTab('wechat')\">\r\n\t\t\t\t\t微信登录\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 验证码登录 -->\r\n\t\t\t<view v-if=\"activeTab === 'code'\" class=\"auth__form\">\r\n\t\t\t\t<view class=\"auth__input-group\">\r\n\t\t\t\t\t<uni-icons type=\"phone\" size=\"20\" color=\"#64748b\" class=\"auth__input-icon\"></uni-icons>\r\n\t\t\t\t\t<input v-model=\"mobile\" class=\"auth__input\" placeholder=\"请输入手机号\" type=\"number\" maxlength=\"11\"\r\n\t\t\t\t\t\tconfirm-type=\"done\" @confirm=\"loginWithCode\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"auth__input-group\">\r\n\t\t\t\t\t<uni-icons type=\"chat\" size=\"20\" color=\"#64748b\" class=\"auth__input-icon\"></uni-icons>\r\n\t\t\t\t\t<input v-model=\"code\" class=\"auth__input auth__input--code\" placeholder=\"请输入验证码\" type=\"number\"\r\n\t\t\t\t\t\tmaxlength=\"6\" confirm-type=\"done\" @confirm=\"loginWithCode\" />\r\n\t\t\t\t\t<button class=\"auth__code-btn\" :disabled=\"codeCountdown > 0\" @tap=\"sendCode\">\r\n\t\t\t\t\t\t{{ codeCountdown > 0 ? `${codeCountdown}s后重发` : '发送验证码' }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<button class=\"auth__button auth__button--primary\" @tap=\"loginWithCode\">登录</button>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 密码登录 -->\r\n\t\t\t<view v-if=\"activeTab === 'password'\" class=\"auth__form\">\r\n\t\t\t\t<view class=\"auth__input-group\">\r\n\t\t\t\t\t<uni-icons type=\"person\" size=\"20\" color=\"#64748b\" class=\"auth__input-icon\"></uni-icons>\r\n\t\t\t\t\t<input v-model=\"account\" class=\"auth__input\" placeholder=\"请输入手机号/用户名\" confirm-type=\"done\"\r\n\t\t\t\t\t\t@confirm=\"loginWithPassword\" />\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"auth__input-group\">\r\n\t\t\t\t\t<uni-icons type=\"locked\" size=\"20\" color=\"#64748b\" class=\"auth__input-icon\"></uni-icons>\r\n\t\t\t\t\t<input v-model=\"password\" class=\"auth__input\" placeholder=\"请输入密码\"\r\n\t\t\t\t\t\t:type=\"showPassword ? 'text' : 'password'\" confirm-type=\"done\" @confirm=\"loginWithPassword\" />\r\n\t\t\t\t\t<uni-icons :type=\"showPassword ? 'eye-slash' : 'eye'\" size=\"20\" color=\"#64748b\"\r\n\t\t\t\t\t\tclass=\"auth__password-toggle\" @tap=\"togglePassword\"></uni-icons>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"auth__forgot\">\r\n\t\t\t\t\t<a class=\"auth__link\" @tap=\"goForgotPassword\">忘记密码？</a>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<button class=\"auth__button auth__button--primary\" @tap=\"loginWithPassword\">登录</button>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 微信扫码登录 -->\r\n\t\t\t<view v-if=\"activeTab === 'wechat'\" class=\"auth__wechat-scan\">\r\n\t\t\t\t<view class=\"auth__qrcode-container\">\r\n\t\t\t\t\t<view class=\"auth__qrcode-placeholder\">\r\n\t\t\t\t\t\t<!-- 这里放置二维码，实际项目中替换为真实二维码 -->\r\n\t\t\t\t\t\t<uni-icons type=\"weixin\" size=\"120\" color=\"#22c55e\"></uni-icons>\r\n\t\t\t\t\t\t<text class=\"auth__qrcode-text\">微信扫码登录</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"auth__qrcode-desc\">请使用微信扫描二维码登录</text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"auth__wechat-tips\">\r\n\t\t\t\t\t<text class=\"auth__wechat-tip\">打开微信扫一扫</text>\r\n\t\t\t\t\t<text class=\"auth__wechat-tip\">扫描上方二维码</text>\r\n\t\t\t\t\t<text class=\"auth__wechat-tip\">点击授权登录</text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 刷新二维码按钮 -->\r\n\t\t\t\t<button class=\"auth__refresh-btn\" @tap=\"refreshQRCode\">\r\n\t\t\t\t\t<uni-icons type=\"refresh\" size=\"16\" color=\"#2563eb\"></uni-icons>\r\n\t\t\t\t\t刷新二维码\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 注册链接 -->\r\n\t\t\t<view class=\"auth__footer\">\r\n\t\t\t\t<text class=\"auth__footer-text\">还没有账户？</text>\r\n\t\t\t\t<a class=\"auth__link\" @tap=\"goRegister\">立即注册</a>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tonUnmounted,\r\n\t\tonMounted\r\n\t} from 'vue'\r\n\timport {\r\n\t\tuseUserStore\r\n\t} from '@/stores/user.js'\r\n\r\n\t// 用户状态管理\r\n\tconst userStore = useUserStore()\r\n\r\n\t// 响应式数据\r\n\tconst activeTab = ref('password') // 默认验证码登录\r\n\tconst mobile = ref('')\r\n\tconst code = ref('')\r\n\tconst account = ref('')\r\n\tconst password = ref('')\r\n\tconst showPassword = ref(false)\r\n\tconst codeCountdown = ref(0)\r\n\tconst qrCodeUrl = ref('') // 存储二维码URL\r\n\tlet countdownTimer = null\r\n\tlet qrCodeTimer = null // 用于轮询二维码状态\r\n\r\n\t// 切换登录方式\r\n\tfunction switchTab(tab) {\r\n\t\t// 先停止之前的轮询\r\n\t\tstopPolling()\r\n\r\n\t\tactiveTab.value = tab\r\n\t\t// 清空表单\r\n\t\tmobile.value = ''\r\n\t\tcode.value = ''\r\n\t\taccount.value = ''\r\n\t\tpassword.value = ''\r\n\r\n\t\t// 切换到微信登录时，只在没有二维码时生成\r\n\t\tif (tab === 'wechat' && !qrcodeId.value) {\r\n\t\t\tgenerateQRCode()\r\n\t\t}\r\n\t}\r\n\r\n\t// 二维码ID\r\n\tconst qrcodeId = ref('')\r\n\tconst pollingCount = ref(0) // 轮询次数计数\r\n\tconst MAX_POLLING_COUNT = 60 // 最多轮询60次（3分钟）\r\n\r\n\t// 停止轮询\r\n\tfunction stopPolling() {\r\n\t\tif (qrCodeTimer) {\r\n\t\t\tclearInterval(qrCodeTimer)\r\n\t\t\tqrCodeTimer = null\r\n\t\t}\r\n\t\tpollingCount.value = 0\r\n\t\tconsole.log('已停止二维码轮询')\r\n\t}\r\n\r\n\t// 生成二维码\r\n\tasync function generateQRCode() {\r\n\t\t// 先停止之前的轮询\r\n\t\tstopPolling()\r\n\r\n\t\t// 重置二维码ID\r\n\t\tqrcodeId.value = ''\r\n\t\tqrCodeUrl.value = ''\r\n\r\n\t\t// #ifdef H5\r\n\t\t// H5 端：生成二维码并轮询状态\r\n\t\ttry {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '生成二维码中...'\r\n\t\t\t})\r\n\r\n\t\t\tconst {\r\n\t\t\t\tgetWeChatQRCode\r\n\t\t\t} = await import('@/api/auth.js')\r\n\t\t\tconst res = await getWeChatQRCode()\r\n\r\n\t\t\tqrcodeId.value = res.qrcode_id\r\n\t\t\tqrCodeUrl.value = res.qrcode_url\r\n\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\tconsole.log('二维码生成成功，ID:', qrcodeId.value)\r\n\r\n\t\t\t// 开始轮询二维码状态\r\n\t\t\tstartPollingQRCode()\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('生成二维码失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '生成二维码失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t\t// #endif\r\n\r\n\t\t// #ifndef H5\r\n\t\t// 小程序端：直接调用微信授权\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '小程序端请使用微信授权登录',\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t\t// #endif\r\n\t}\r\n\r\n\t// 刷新二维码\r\n\tfunction refreshQRCode() {\r\n\t\tconsole.log('用户手动刷新二维码')\r\n\t\tstopPolling()\r\n\t\tgenerateQRCode()\r\n\t}\r\n\r\n\t// 开始轮询二维码状态\r\n\tasync function startPollingQRCode() {\r\n\t\t// 确保之前的定时器已清理\r\n\t\tif (qrCodeTimer) {\r\n\t\t\tclearInterval(qrCodeTimer)\r\n\t\t\tqrCodeTimer = null\r\n\t\t}\r\n\r\n\t\tconst {\r\n\t\t\tcheckQRCodeStatus\r\n\t\t} = await import('@/api/auth.js')\r\n\r\n\t\tpollingCount.value = 0\r\n\t\tconsole.log('开始轮询二维码状态，ID:', qrcodeId.value)\r\n\r\n\t\tqrCodeTimer = setInterval(async () => {\r\n\t\t\t// 检查轮询次数\r\n\t\t\tpollingCount.value++\r\n\t\t\tconsole.log(`轮询二维码状态 [${pollingCount.value}/${MAX_POLLING_COUNT}]`)\r\n\r\n\t\t\tif (pollingCount.value > MAX_POLLING_COUNT) {\r\n\t\t\t\tstopPolling()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '二维码已过期，请刷新',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\t// 如果不在微信登录tab，停止轮询\r\n\t\t\tif (activeTab.value !== 'wechat') {\r\n\t\t\t\tconsole.log('已切换到其他登录方式，停止轮询')\r\n\t\t\t\tstopPolling()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await checkQRCodeStatus(qrcodeId.value)\r\n\r\n\t\t\t\tif (res.status === 'confirmed') {\r\n\t\t\t\t\t// 扫码确认，完成登录\r\n\t\t\t\t\tconsole.log('二维码已确认，开始登录')\r\n\t\t\t\t\tstopPolling()\r\n\t\t\t\t\tawait handleWeChatLogin()\r\n\t\t\t\t} else if (res.status === 'expired') {\r\n\t\t\t\t\t// 二维码过期\r\n\t\t\t\t\tconsole.log('二维码已过期')\r\n\t\t\t\t\tstopPolling()\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '二维码已过期，请刷新',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('轮询二维码状态失败:', error)\r\n\t\t\t\t// 出错时停止轮询\r\n\t\t\t\tstopPolling()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '网络错误，请刷新二维码',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}, 3000) // 每3秒轮询一次\r\n\t}\r\n\r\n\t// 微信登录\r\n\tasync function handleWeChatLogin() {\r\n\t\ttry {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '登录中...',\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\t// 使用 mock_code 进行测试\r\n\t\t\tconst result = await userStore.loginByWechat('mock_code')\r\n\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\tif (result.success) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: '/pages/home/index'\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1500)\r\n\t\t\t} else {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: result.error?.message || '登录失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('微信登录失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '登录失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 发送验证码\r\n\tasync function sendCode() {\r\n\t\tif (!mobile.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入手机号',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!/^1[3-9]\\d{9}$/.test(mobile.value)) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '手机号格式不正确',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// 调用发送验证码接口\r\n\t\t\tconst {\r\n\t\t\t\tsendSmsCode\r\n\t\t\t} = await import('@/api/auth.js')\r\n\t\t\tawait sendSmsCode(mobile.value, 'login')\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '验证码已发送',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t\t// 开始倒计时\r\n\t\t\tcodeCountdown.value = 60\r\n\t\t\tcountdownTimer = setInterval(() => {\r\n\t\t\t\tcodeCountdown.value--\r\n\t\t\t\tif (codeCountdown.value <= 0) {\r\n\t\t\t\t\tclearInterval(countdownTimer)\r\n\t\t\t\t}\r\n\t\t\t}, 1000)\r\n\t\t} catch (error) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: error.message || error.detail || '发送失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 切换密码显示/隐藏\r\n\tfunction togglePassword() {\r\n\t\tshowPassword.value = !showPassword.value\r\n\t}\r\n\r\n\t// 验证码登录\r\n\tasync function loginWithCode() {\r\n\t\tif (!mobile.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入手机号',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!code.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入验证码',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '登录中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\tconst result = await userStore.loginByCode(mobile.value, code.value)\r\n\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\tif (result.success) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 延迟跳转\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: '/pages/home/index'\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1500)\r\n\t\t\t} else {\r\n\t\t\t\tconst errorMsg = result.error?.message || result.error?.data?.detail || '登录失败'\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: errorMsg,\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('验证码登录异常:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '登录失败，请稍后重试',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 密码登录\r\n\tasync function loginWithPassword() {\r\n\t\t// 表单验证\r\n\t\tif (!account.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入账号',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!password.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入密码',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 调用登录接口\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '登录中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\tconst result = await userStore.loginByPassword(account.value, password.value)\r\n\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\tif (result.success) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 延迟跳转，让用户看到成功提示\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t// 跳转到首页\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: '/pages/home/index'\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1500)\r\n\t\t\t} else {\r\n\t\t\t\t// 登录失败\r\n\t\t\t\tconst errorMsg = result.error?.message || result.error?.data?.detail || '登录失败，请检查账号密码'\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: errorMsg,\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('登录异常:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '登录失败，请稍后重试',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// 回车登录\r\n\tlet keyHandler\r\n\tonMounted(() => {\r\n\t\t// #ifdef H5\r\n\t\tkeyHandler = (e) => {\r\n\t\t\tif (e.key === 'Enter') {\r\n\t\t\t\tactiveTab.value === 'code' && loginWithCode()\r\n\t\t\t\tactiveTab.value === 'password' && loginWithPassword()\r\n\t\t\t\tactiveTab.value === 'wechat' && refreshQRCode() // 微信页按回车刷新二维码\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.addEventListener('keyup', keyHandler)\r\n\t\t// #endif\r\n\t})\r\n\r\n\tonUnmounted(() => {\r\n\t\t// #ifdef H5\r\n\t\tdocument.removeEventListener('keyup', keyHandler)\r\n\t\t// #endif\r\n\t})\r\n\r\n\t// 忘记密码\r\n\tfunction goForgotPassword() {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: '/pages/auth/forgot-password'\r\n\t\t})\r\n\t}\r\n\r\n\t// 注册\r\n\tfunction goRegister() {\r\n\t\tuni.navigateTo({\r\n\t\t\turl: '/pages/auth/register'\r\n\t\t})\r\n\t}\r\n\r\n\t// 清理定时器\r\n\tonUnmounted(() => {\r\n\t\tif (countdownTimer) {\r\n\t\t\tclearInterval(countdownTimer)\r\n\t\t\tcountdownTimer = null\r\n\t\t}\r\n\t\tstopPolling()\r\n\t})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.auth {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmin-height: 100vh;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 48rpx;\r\n\t\tbackground: linear-gradient(135deg, #e0f2fe, #ede9fe);\r\n\t}\r\n\r\n\t.auth__card {\r\n\t\twidth: 100%;\r\n\t\tmax-width: 640rpx;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 32rpx;\r\n\t\tpadding: 48rpx;\r\n\t\tbox-shadow: 0 24rpx 60rpx rgba(15, 23, 42, 0.12);\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 32rpx;\r\n\t}\r\n\r\n\t.auth__header {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.auth__title {\r\n\t\tfont-size: 40rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #0f172a;\r\n\t}\r\n\r\n\t.auth__subtitle {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #64748b;\r\n\t}\r\n\r\n\t.auth__tabs {\r\n\t\tdisplay: flex;\r\n\t\tbackground-color: #f8fafc;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 8rpx;\r\n\t}\r\n\r\n\t.auth__tab {\r\n\t\tflex: 1;\r\n\t\ttext-align: center;\r\n\t\tpadding: 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #64748b;\r\n\t\tborder-radius: 12rpx;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t.auth__tab--active {\r\n\t\tbackground-color: #ffffff;\r\n\t\tcolor: #2563eb;\r\n\t\tfont-weight: 500;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(37, 99, 235, 0.1);\r\n\t}\r\n\r\n\t.auth__form {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 32rpx;\r\n\t}\r\n\r\n\t.auth__input-group {\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tborder: 1px solid rgba(148, 163, 184, 0.6);\r\n\t\tborder-radius: 16rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.auth__input-icon {\r\n\t\tpadding: 0 24rpx;\r\n\t}\r\n\r\n\t.auth__input {\r\n\t\tflex: 1;\r\n\t\theight: 88rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tborder: none;\r\n\t\toutline: none;\r\n\t}\r\n\r\n\t.auth__input--code {\r\n\t\tborder-right: 1px solid rgba(148, 163, 184, 0.3);\r\n\t}\r\n\r\n\t.auth__code-btn {\r\n\t\theight: 88rpx;\r\n\t\tline-height: 88rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tbackground-color: transparent;\r\n\t\tcolor: #2563eb;\r\n\t\tborder: none;\r\n\t\twhite-space: nowrap;\r\n\r\n\t\t&[disabled] {\r\n\t\t\tcolor: #94a3b8;\r\n\t\t}\r\n\t}\r\n\r\n\t.auth__password-toggle {\r\n\t\tpadding: 0 24rpx;\r\n\t}\r\n\r\n\t.auth__forgot {\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.auth__button {\r\n\t\theight: 88rpx;\r\n\t\tline-height: 88rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tborder: none;\r\n\t\tborder-radius: 16rpx;\r\n\t\tbackground-color: #e2e8f0;\r\n\t\tcolor: #334155;\r\n\t\tmargin-left: 0;\r\n\t\tmargin-right: 0;\r\n\t}\r\n\r\n\t.auth__button--primary {\r\n\t\tbackground: linear-gradient(135deg, #2563eb, #3b82f6);\r\n\t\tcolor: #ffffff;\r\n\t}\r\n\r\n\t/* 微信扫码登录样式 */\r\n\t.auth__wechat-scan {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 40rpx;\r\n\t}\r\n\r\n\t.auth__qrcode-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 24rpx;\r\n\t}\r\n\r\n\t.auth__qrcode-placeholder {\r\n\t\twidth: 400rpx;\r\n\t\theight: 400rpx;\r\n\t\tborder: 2rpx dashed #e2e8f0;\r\n\t\tborder-radius: 24rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tgap: 24rpx;\r\n\t\tbackground-color: #f8fafc;\r\n\t}\r\n\r\n\t.auth__qrcode-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #475569;\r\n\t}\r\n\r\n\t.auth__qrcode-desc {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #64748b;\r\n\t}\r\n\r\n\t.auth__wechat-tips {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t}\r\n\r\n\t.auth__wechat-tip {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #64748b;\r\n\t\tposition: relative;\r\n\t\tpadding-left: 40rpx;\r\n\r\n\t\t&::before {\r\n\t\t\tcontent: \"•\";\r\n\t\t\tposition: absolute;\r\n\t\t\tleft: 20rpx;\r\n\t\t\tcolor: #22c55e;\r\n\t\t}\r\n\t}\r\n\r\n\t.auth__refresh-btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tbackground-color: transparent;\r\n\t\tcolor: #2563eb;\r\n\t\tborder: none;\r\n\t\tfont-size: 26rpx;\r\n\t\tpadding: 20rpx 40rpx;\r\n\t\tborder-radius: 16rpx;\r\n\t\tborder: 1rpx solid #2563eb;\r\n\t}\r\n\r\n\t.auth__footer {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n\r\n\t.auth__footer-text {\r\n\t\tcolor: #64748b;\r\n\t}\r\n\r\n\t.auth__link {\r\n\t\tcolor: #2563eb;\r\n\t\tbackground: transparent;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/97247/Desktop/uni-ecoful/pages/auth/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","uni","onMounted","onUnmounted"],"mappings":"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"}