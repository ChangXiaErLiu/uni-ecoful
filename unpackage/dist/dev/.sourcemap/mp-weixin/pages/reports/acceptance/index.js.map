{"version":3,"file":"index.js","sources":["pages/reports/acceptance/index.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVwb3J0cy9hY2NlcHRhbmNlL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<app-layout current=\"pages/reports/acceptance/index\">\r\n\t\t<view class=\"acceptance-page\">\r\n\t\t\t<!-- 步骤导航 -->\r\n\t\t\t<view class=\"acceptance-steps\">\r\n\t\t\t\t<view class=\"steps-container\">\r\n\t\t\t\t\t<template v-if=\"isMobile\">\r\n\t\t\t\t\t\t<uni-data-select v-model=\"currentStep\" :localdata=\"stepSelectOptions\" placeholder=\"选择步骤\"\r\n\t\t\t\t\t\t\tclass=\"mobile-step-select\" />\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t<view class=\"desktop-steps\" role=\"tablist\">\r\n\t\t\t\t\t\t\t<view v-for=\"(step, index) in stepNames\" :key=\"index\" class=\"step-item\" :class=\"{\r\n                  'step-item--active': currentStep === index,\r\n                  'step-item--completed': stepDone(index)\r\n                }\" role=\"tab\" :aria-selected=\"currentStep === index\" @tap=\"currentStep = index\">\r\n\t\t\t\t\t\t\t\t<view class=\"step-indicator\">\r\n\t\t\t\t\t\t\t\t\t<text v-if=\"stepDone(index)\" class=\"step-check\">✓</text>\r\n\t\t\t\t\t\t\t\t\t<text v-else class=\"step-number\">{{ index + 1 }}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<text class=\"step-label\">{{ step }}</text>\r\n\t\t\t\t\t\t\t\t<view v-if=\"index < stepNames.length - 1\" class=\"step-connector\" />\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 主要内容区域 -->\r\n\t\t\t<view class=\"acceptance-content\">\r\n\t\t\t\t<scroll-view class=\"content-scroll\" scroll-y>\r\n\t\t\t\t\t<!-- 步骤0: 选择项目、提取基本信息 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 0\" class=\"content-section\">\r\n\t\t\t\t\t\t<ProjectInfoContainer @extraction-complete=\"handleExtractionComplete\" />\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 步骤1: 监测方案 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 1\" class=\"content-section\">\r\n\t\t\t\t\t\t<MonitorPlanContainer :projectId=\"selectedProjectId\"\r\n\t\t\t\t\t\t\t:hasExtracted=\"projectInfoState.extractionOk.value\" @plan-generated=\"handlePlanGenerated\" />\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 步骤2: 提资单比对 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 2\" class=\"content-section\">\r\n\t\t\t\t\t\t<view class=\"section-card\">\r\n\t\t\t\t\t\t\t<view class=\"section-header\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"list\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t<text class=\"section-title\">提资单比对</text>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<view class=\"section-body\">\r\n\t\t\t\t\t\t\t\t<!-- 环保资料提交管理系统界面 -->\r\n\t\t\t\t\t\t\t\t<view class=\"tizidan-container\">\r\n\t\t\t\t\t\t\t\t\t<!-- 顶部描述 -->\r\n\t\t\t\t\t\t\t\t\t<view class=\"tizidan-header\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-title\">环保资料提交管理系统</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-subtitle\">请按要求提交相关环保资料</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 加载失败提示 -->\r\n\t\t\t\t\t\t\t\t\t<view v-if=\"tizidanItems.length === 0\" class=\"empty-state\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"refresh\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"empty-text\">加载失败，请重新刷新！</text>\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"fetchTizidanData\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"refresh\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>重新加载</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 正常内容 -->\r\n\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-content\">\r\n\t\t\t\t\t\t\t\t\t\t<!-- 将提资单项分组显示 -->\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 1、项目历史以来环评报告及批复 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">1.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">项目历史以来环评报告及批复</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('项目历史以来环评报告及批复')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"getItemFiles(item).length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ getItemFiles(item).length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, getFileKey(item))\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '继续上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"getItemFiles(item).length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in getItemFiles(item)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, getFileKey(item), fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 2、项目相关环保验收资料 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">2.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">项目相关环保验收资料</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('项目相关环保验收资料')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.files && item.files.length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ item.files.length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, null)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '继续上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.files && item.files.length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in item.files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, null, fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 3、（房地产项目提供）房地产相关证件 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">3.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">（房地产项目提供）房地产相关证件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('（房地产项目提供）房地产相关证件')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"getItemFiles(item).length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ getItemFiles(item).length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, getFileKey(item))\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ getSubmittedStatus(item) ? '继续上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"getItemFiles(item).length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in getItemFiles(item)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, getFileKey(item), fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 4-9项 - 统一布局的普通项 -->\r\n\t\t\t\t\t\t\t\t\t\t<template v-for=\"level1Name in ['污染治理设施设计方案', '厂区总平面图及各层平面图（CAD版本）', \r\n\t\t\t\t\t                          '厂区排水设计图（CAD版本）', '排污许可证', '排水许可证', '危废处置协议及相应处置资质']\" :key=\"level1Name\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"hasItemsByLevel1(level1Name)\" class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-section-number\">{{ getSectionNumber(level1Name) }}.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">{{ level1Name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1(level1Name)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.files && item.files.length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ item.files.length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, null)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '继续上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.files && item.files.length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in item.files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, null, fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 10、其他需要提供的资料 -->\r\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"hasItemsByLevel1('其他需要提供的资料')\" class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">10.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">其他需要提供的资料</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('其他需要提供的资料')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 输入框 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-other-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"item.customText\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"请输入其他需要提供的资料（以防万一以上资料不满足特殊项目要求）\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"textarea\" :maxlength=\"500\" :clearable=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:autoHeight=\"true\" class=\"custom-textarea\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"submitOtherMaterials(item.record_id)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t提交\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.files && item.files.length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ item.files.length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, null)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '继续上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.files && item.files.length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in item.files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, null, fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<tizidan-footer>\r\n\t\t\t\t\t\t\t\t\t<view class=\"footer-content\">\r\n\t\t\t\t\t\t\t\t\t\t<!-- 添加资料接收者信息输入区域 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"phone\" size=\"16\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"contact-info-title\">资料接收者信息</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info-form\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 联系人 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"contact-info-label\">联系人：</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"contactPerson\" placeholder=\"请输入联系人姓名\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:clearable=\"true\" class=\"contact-info-input\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 电话 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"contact-info-label\">电话：</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"contactPhone\" placeholder=\"请输入联系电话\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:clearable=\"true\" class=\"contact-info-input\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 邮箱 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"contact-info-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"contact-info-label\">邮箱：</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"contactEmail\" placeholder=\"请输入电子邮箱\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:clearable=\"true\" class=\"contact-info-input\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"footer-text\">请确保所有需要的资料完整准确提交</text>\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"generateAndDownloadTizidan\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"download-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>生成并下载验收报告提资单</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</tizidan-footer>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\r\n\t\t\t\t\t<!-- 步骤3: 现场踏勘比对 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 3\" class=\"content-section\">\r\n\t\t\t\t\t\t<FieldSurveyContainer :userId=\"user_id\" :projectId=\"selectedProjectId\"\r\n\t\t\t\t\t\t\t:signboard=\"projectInfoState.signboard\" :baseTable=\"projectInfoState.baseTable.value\"\r\n\t\t\t\t\t\t\t:datasheet=\"projectInfoState.datasheet\"\r\n\t\t\t\t\t\t\t@generate-signboard=\"projectInfoState.generateSignboard\" />\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 步骤4: 竣工验收报告 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 4\" class=\"content-section\">\r\n\t\t\t\t\t\t<AcceptanceReportContainer :projectId=\"selectedProjectId\"\r\n\t\t\t\t\t\t\t:hasExtracted=\"projectInfoState.extractionOk.value\"\r\n\t\t\t\t\t\t\t@report-generated=\"handleReportGenerated\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 底部导航 -->\r\n\t\t\t<view class=\"acceptance-navigation\">\r\n\t\t\t\t<view class=\"nav-buttons\">\r\n\t\t\t\t\t<button class=\"btn btn--ghost\" :disabled=\"currentStep === 0\" @tap=\"prevStep\">\r\n\t\t\t\t\t\t<uni-icons type=\"left\" size=\"16\" color=\"#5b6b7b\" />\r\n\t\t\t\t\t\t<text>上一步</text>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class=\"btn btn--primary\" :disabled=\"currentStep === stepNames.length - 1\" @tap=\"nextStep\">\r\n\t\t\t\t\t\t<text>下一步</text>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</app-layout>\r\n\r\n\t<!-- 新增项目基本信息弹窗 -->\r\n\t<uni-popup ref=\"newBaseInfoPopup\" type=\"center\">\r\n\t\t<view class=\"modal\">\r\n\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t<text class=\"modal-title\">新增项目基本信息</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"modal-body\">\r\n\t\t\t\t<text class=\"modal-description\">请在下方输入信息名称</text>\r\n\t\t\t\t<uni-easyinput v-model=\"newBaseInfoLabel\" placeholder=\"如：项目名称/单位名称\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"modal-actions\">\r\n\t\t\t\t<button class=\"btn btn--ghost\" @tap=\"closeBaseInfo\">取消</button>\r\n\t\t\t\t<button class=\"btn btn--primary\" @tap=\"confirmAddBaseInfo\">确定</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</uni-popup>\r\n\r\n\t<!-- 任务进度弹窗 -->\r\n\t<TaskProgressModal ref=\"taskProgressModal\" :title=\"taskProgressTitle\" :progress=\"taskProgress\"\r\n\t\t:statusText=\"taskStatusText\" :state=\"taskState\" :cancelable=\"false\" />\r\n\r\n\t<!-- 项目选择弹窗 -->\r\n\t<uni-popup ref=\"projectPickerPopup\" type=\"center\" :mask-click=\"true\">\r\n\t\t<view class=\"project-picker-modal\">\r\n\t\t\t<view class=\"picker-header\">\r\n\t\t\t\t<text class=\"picker-title\">选择项目</text>\r\n\t\t\t\t<view class=\"picker-close\" @tap=\"closeProjectPicker\">\r\n\t\t\t\t\t<uni-icons type=\"close\" size=\"20\" color=\"#6b7280\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 搜索框 -->\r\n\t\t\t<view class=\"picker-search\">\r\n\t\t\t\t<uni-easyinput v-model=\"projectSearchKeyword\" placeholder=\"搜索项目名称...\" prefixIcon=\"search\"\r\n\t\t\t\t\t:clearable=\"true\" @input=\"onSearchInput\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 项目统计 -->\r\n\t\t\t<view class=\"picker-stats\">\r\n\t\t\t\t<text class=\"stats-text\">\r\n\t\t\t\t\t共 {{ filteredProjects.length }} 个项目\r\n\t\t\t\t\t<text v-if=\"projectSearchKeyword\" class=\"stats-highlight\">\r\n\t\t\t\t\t\t（搜索结果）\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 项目列表 -->\r\n\t\t\t<scroll-view class=\"picker-list\" scroll-y>\r\n\t\t\t\t<view v-for=\"project in filteredProjects\" :key=\"project.id\" class=\"picker-item\"\r\n\t\t\t\t\t:class=\"{ 'picker-item--active': selectedProjectId === project.id }\" @tap=\"selectProject(project)\">\r\n\t\t\t\t\t<view class=\"picker-item-icon\">\r\n\t\t\t\t\t\t<uni-icons type=\"folder\" size=\"22\"\r\n\t\t\t\t\t\t\t:color=\"selectedProjectId === project.id ? '#166534' : '#6b7280'\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"picker-item-content\">\r\n\t\t\t\t\t\t<text class=\"picker-item-name\">{{ project.name }}</text>\r\n\t\t\t\t\t\t<text v-if=\"project.description\" class=\"picker-item-desc\">\r\n\t\t\t\t\t\t\t{{ project.description }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t<view v-if=\"project.folder_name\" class=\"picker-item-meta\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"calendar\" size=\"14\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t<text class=\"meta-text\">{{ project.folder_name }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"picker-item-action\">\r\n\t\t\t\t\t\t<view v-if=\"selectedProjectId === project.id\" class=\"selected-badge\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"checkmarkempty\" size=\"18\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<uni-icons v-else type=\"right\" size=\"16\" color=\"#d1d5db\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 空状态 -->\r\n\t\t\t\t<view v-if=\"filteredProjects.length === 0\" class=\"picker-empty\">\r\n\t\t\t\t\t<uni-icons type=\"search\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t<text class=\"picker-empty-text\">\r\n\t\t\t\t\t\t{{ projectSearchKeyword ? '未找到匹配的项目' : '暂无项目' }}\r\n\t\t\t\t\t</text>\r\n\t\t\t\t\t<text v-if=\"projectSearchKeyword\" class=\"picker-empty-tip\">\r\n\t\t\t\t\t\t试试其他关键词或清空搜索\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t</uni-popup>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\treactive,\r\n\t\tcomputed,\r\n\t\tnextTick,\r\n\t\twatch,\r\n\t\tonUnmounted\r\n\t} from 'vue'\r\n\timport {\r\n\t\tusePlatformInfo\r\n\t} from '@/utils/platform'\r\n\timport AppLayout from '@/components/layout/AppLayout.vue'\r\n\timport {\r\n\t\tonShow,\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\timport TaskProgressModal from '@/components/message-pop-up/TaskProgressModal.vue'\r\n\timport ProjectInfoContainer from '@/components/acceptance-report/ProjectInfoContainer.vue'\r\n\timport FieldSurveyContainer from '@/components/field-survey/FieldSurveyContainer.vue'\r\n\timport MonitorPlanContainer from '@/components/monitor-plan/MonitorPlanContainer.vue'\r\n\timport AcceptanceReportContainer from '@/components/acceptance-report/AcceptanceReportContainer.vue'\r\n\timport {\r\n\t\tuseProjectInfo\r\n\t} from '@/composables/useProjectInfo.js'\r\n\timport {\r\n\t\tuseFieldSurveyData\r\n\t} from '@/composables/useFieldSurveyData.js'\r\n\timport {\r\n\t\tuseMonitorPlan\r\n\t} from '@/composables/useMonitorPlan.js'\r\n\timport {\r\n\t\tuseAcceptanceReport\r\n\t} from '@/composables/useAcceptanceReport.js'\r\n\timport {\r\n\t\tnavTitleStore\r\n\t} from '@/stores/navTitle.js'\r\n\r\n\t//手机端头部页面标题\r\n\tconst navTitle = navTitleStore()\r\n\tonShow(() => navTitle.setTitle('环评项目竣工验收'))\r\n\r\n\t//手机页面规定\r\n\tconst {\r\n\t\tisMobile\r\n\t} = usePlatformInfo()\r\n\r\n\t// 任务进度弹窗相关状态\r\n\tconst taskProgressModal = ref(null)\r\n\tconst taskProgressTitle = ref('信息提取中')\r\n\tconst taskProgress = ref(0)\r\n\tconst taskStatusText = ref('正在初始化...')\r\n\tconst taskState = ref('running')\r\n\r\n\r\n\t// 每个步骤定义--------------------------\r\n\t// 步骤标题\r\n\tconst stepNames = ['选择项目与提取信息', '监测方案', '提资单比对', '现场踏勘比对', '竣工验收报告']\r\n\r\n\t// 默认从第一步开始(0)\r\n\tconst currentStep = ref(0)\r\n\r\n\t// 手机端步骤选择\r\n\tconst stepNamesDisplay = computed(() => stepNames.map((n, i) => stepDone(i) ? (n + ' ✓') : n))\r\n\tconst stepSelectOptions = computed(() => stepNames.map((n, i) => ({\r\n\t\ttext: stepDone(i) ? (n + ' ✓') : n,\r\n\t\tvalue: i\r\n\t})))\r\n\r\n\t// 步骤更改时\r\n\tfunction onStepChange(e) {\r\n\t\tconst idx = Number(e?.currentIndex ?? e?.detail?.currentIndex ?? 0);\r\n\t\tif (!Number.isNaN(idx)) currentStep.value = idx\r\n\t}\r\n\r\n\t// 上一步按钮\r\n\tfunction prevStep() {\r\n\t\tif (currentStep.value > 0) currentStep.value -= 1\r\n\t}\r\n\t// 下一步按钮\r\n\tfunction nextStep() {\r\n\t\tif (currentStep.value < stepNames.length - 1) currentStep.value += 1\r\n\t}\r\n\r\n\t// 从 useProjectInfo composable 获取第一步的状态\r\n\tconst projectInfoState = useProjectInfo()\r\n\tconst {\r\n\t\tselectedProjectId,\r\n\t\tfilteredProjects,\r\n\t\tprojectSearchKeyword\r\n\t} = projectInfoState\r\n\r\n\t// 所有步骤的完成度\r\n\tfunction stepDone(i) {\r\n\t\tswitch (i) {\r\n\t\t\tcase 0:\r\n\t\t\t\treturn projectInfoState.extractionOk.value;\r\n\t\t\tcase 1:\r\n\t\t\t\treturn monitorPlanState.canDownload.value;\r\n\t\t\tcase 2:\r\n\t\t\t\treturn tizidanItems.value && tizidanItems.value.some(item => item.submitted);\r\n\t\t\tcase 3:\r\n\t\t\t\treturn fieldSurveyData.fieldworkComparison && fieldSurveyData.fieldworkComparison.value && fieldSurveyData.fieldworkComparison.value.length > 0;\r\n\t\t\tcase 4:\r\n\t\t\t\treturn acceptanceReportState.canDownloadReport.value;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\t// 第一步：项目信息管理（已重构为独立组件）\r\n\t// 所有状态和方法已迁移到 composables/useProjectInfo.js\r\n\t// 通过 ProjectInfoContainer 组件使用\r\n\r\n\t// 处理提取完成事件\r\n\tfunction handleExtractionComplete() {\r\n\t\t// console.log('✅ 项目信息提取完成')\r\n\t}\r\n\r\n\t// 初始化和清理\r\n\tonLoad(async () => {\r\n\t\t// 初始化项目信息管理\r\n\t\tawait projectInfoState.initialize()\r\n\t})\r\n\r\n\tonUnmounted(() => {\r\n\t\t// 清理项目信息管理\r\n\t\tprojectInfoState.cleanup()\r\n\t})\r\n\r\n\t// 监测方案生成成功的回调\r\n\t// 监测方案状态管理\r\n\tconst monitorPlanState = useMonitorPlan()\r\n\r\n\r\n\tfunction handlePlanGenerated() {\r\n\t\t// console.log('✅ 监测方案生成成功')\r\n\t}\r\n\r\n\t// 以下现场踏勘比对的方法-------------------------\r\n\t// 现场踏勘模块已拆分到独立组件，使用 useFieldSurveyData composable 管理状态\r\n\tconst fieldSurveyData = useFieldSurveyData()\r\n\r\n\t// 以下是竣工验收报告的方法-------------------------\r\n\t// 竣工验收报告状态管理\r\n\tconst acceptanceReportState = useAcceptanceReport()\r\n\r\n\t// 竣工验收报告生成成功的回调\r\n\tfunction handleReportGenerated() {\r\n\t\t// console.log('✅ 竣工验收报告生成成功')\r\n\t}\r\n\r\n\r\n\t// 以下提资单比对的方法-------------------------\r\n\t//bywilson 获取user_id和project_id从本地缓存uni.getStorageSync\r\n\t// 获取项目ID\r\n\tconst project_id = uni.getStorageSync('acceptance_project_id')\r\n\tconst userInfoStr = uni.getStorageSync('userInfo')\r\n\tconst userInfo = userInfoStr ? JSON.parse(userInfoStr) : null\r\n\t// 获取user_id \r\n\tconst user_id = userInfo?.id || userInfo?.user_id\r\n\t// console.log(\"test userid\",user_id)\r\n\t// console.log(\"test project_id\",project_id)\r\n\t// 上传提资单文件\r\n\tconst eco_baseUrl = \"http://172.16.1.61:8000\"\r\n\r\n\t// 提资单数据\r\n\tconst tizidanItems = ref([])\r\n\tconst tizidanRecordMap = ref({}) // 用于存储 record_id 到前端索引的映射\r\n\t// 在 data 部分添加资料接收者信息\r\n\tconst contactPerson = ref('')\r\n\tconst contactPhone = ref('')\r\n\tconst contactEmail = ref('')\r\n\r\n\t// 修改下载函数为生成并下载提资单\r\n\tasync function generateAndDownloadTizidan() {\r\n\t\tif (!selectedProjectId.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请先选择项目',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 验证资料接收者信息\r\n\t\tif (!contactPerson.value.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入接收资料的联系人',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!contactPhone.value.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入电话',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!contactEmail.value.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入邮箱',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 显示下载中提示\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '正在生成文档…',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\t// 调用生成提资单接口\r\n\t\t\tconst url = eco_baseUrl + '/api/v1/completion/tzdDetail/generate_and_download_tzd_doc'\r\n\r\n\t\t\tconst formData = {\r\n\t\t\t\tuser_id: user_id,\r\n\t\t\t\tproject_id: project_id,\r\n\t\t\t\tcontact_person: contactPerson.value,\r\n\t\t\t\tcontact_phone: contactPhone.value,\r\n\t\t\t\tcontact_email: contactEmail.value\r\n\t\t\t}\r\n\r\n\t\t\t// 使用 POST 请求发送数据\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: url,\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: formData,\r\n\t\t\t\t\tsuccess: (res) => resolve(res),\r\n\t\t\t\t\tfail: (err) => reject(err)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\tconst data = response.data\r\n\t\t\t\tif (data.success) {\r\n\t\t\t\t\tif (data.download_url) {\r\n\t\t\t\t\t\t// 延迟 1 秒再下载，确保文件已保存\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tdownloadGeneratedFile(data.download_url, data.file_name)\r\n\t\t\t\t\t\t}, 1000)\r\n\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '文档生成成功，开始下载',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: data.message || '生成成功',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(data.message || '生成文档失败')\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(`请求失败，状态码：${response.statusCode}`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('生成提资单失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '生成失败: ' + (error.message || '未知错误'),\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t// 下载生成的文档\r\n\tasync function downloadGeneratedFile(downloadUrl, fileName) {\r\n\t\ttry {\r\n\t\t\t// 构建完整的下载 URL\r\n\t\t\tconst fullUrl = eco_baseUrl + downloadUrl\r\n\r\n\t\t\tconsole.log('开始下载文件:', fullUrl)\r\n\r\n\t\t\t// 显示下载进度\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '正在下载文档…',\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\t// #ifdef H5\r\n\t\t\t// H5环境：直接打开链接下载\r\n\t\t\twindow.open(fullUrl, '_blank')\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载已开始',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序环境\r\n\t\t\tconst downloadTask = uni.downloadFile({\r\n\t\t\t\turl: fullUrl,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\tconst tempFilePath = res.tempFilePath\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: tempFilePath,\r\n\t\t\t\t\t\t\tsuccess: (saveRes) => {\r\n\t\t\t\t\t\t\t\tconsole.log('文件保存成功:', saveRes.savedFilePath)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '文件已保存',\r\n\t\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: (saveErr) => {\r\n\t\t\t\t\t\t\t\tconsole.error('保存文件失败:', saveErr)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '保存失败: ' + (saveErr.errMsg || '未知错误'),\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: `下载失败，状态码: ${res.statusCode}`,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tconsole.error('下载请求失败:', err)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '下载请求失败: ' + (err.errMsg || '未知错误'),\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// 监听下载进度\r\n\t\t\tdownloadTask.onProgressUpdate((res) => {\r\n\t\t\t\tconsole.log('下载进度', res.progress)\r\n\t\t\t\tconsole.log('已经下载的数据长度', res.totalBytesWritten)\r\n\t\t\t\tconsole.log('预期需要下载的数据总长度', res.totalBytesExpectedToWrite)\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t// App环境\r\n\t\t\tuni.downloadFile({\r\n\t\t\t\turl: fullUrl,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\tconst tempFilePath = res.tempFilePath\r\n\t\t\t\t\t\tplus.runtime.openFile(tempFilePath, {}, (e) => {\r\n\t\t\t\t\t\t\tif (e.code !== 0) {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '打开文件失败',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: `下载失败，状态码: ${res.statusCode}`,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tconsole.error('下载请求失败:', err)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '下载请求失败: ' + (err.errMsg || '未知错误'),\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('下载文件失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载失败: ' + (error.message || '未知错误'),\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 重置提交状态\r\n\tfunction resetSubmissionStatus(item) {\r\n\t\t// 重置主提交状态\r\n\t\titem.submitted = false\r\n\r\n\t\t// 重置各个子提交状态\r\n\t\tconst subStatusKeys = ['submitted1_1', 'submitted1_2', 'submitted3_1', 'submitted3_2', 'submitted3_3']\r\n\t\tsubStatusKeys.forEach(key => {\r\n\t\t\tif (item[key] !== undefined) {\r\n\t\t\t\titem[key] = false\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 切换\"本项目是否需要\"复选框\r\n\tasync function toggleRequired(item) {\r\n\t\tif (!item || !item.record_id) {\r\n\t\t\tconsole.error('切换复选框失败：item或record_id不存在')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// 切换状态\r\n\t\t\tconst newRequired = !item.required\r\n\t\t\titem.required = newRequired\r\n\r\n\t\t\t// 显示加载中\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '保存中...',\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\t// 调用后端接口更新数据库\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/update_require',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecord_id: item.record_id,\r\n\t\t\t\t\t\tis_require: newRequired ? 1 : 0,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('更新is_require成功:', res)\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('更新is_require失败:', err)\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200 && response.data.success) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: newRequired ? '已标记为需要' : '已标记为不需要',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 如果取消勾选，不需要清空文件，但要隐藏文件上传区域\r\n\t\t\t\t// 文件数据保留，只是隐藏显示\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.data?.message || '更新失败')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('切换复选框失败:', error)\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\t// 恢复原来的状态\r\n\t\t\titem.required = !item.required\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `保存失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// 辅助函数：获取特定子项的 required 状态\r\n\tfunction getRequiredStatus(items, mainIndex, subType) {\r\n\t\tif (!items[mainIndex]) return false\r\n\r\n\t\tconst item = items[mainIndex]\r\n\t\tconst statusKey = `submitted${subType}`\r\n\t\treturn item[statusKey] !== undefined ? item.required : false\r\n\t}\r\n\r\n\t// 辅助函数：获取特定子项的 files\r\n\tfunction getFiles(items, mainIndex, subType) {\r\n\t\tif (!items[mainIndex]) return []\r\n\r\n\t\tconst item = items[mainIndex]\r\n\t\tconst fileKey = `files${subType}`\r\n\t\treturn item[fileKey] || []\r\n\t}\r\n\r\n\r\n\t// 辅助函数：获取特定子项的 record_id\r\n\tfunction getRecordId(items, mainIndex, subType) {\r\n\t\tif (!items[mainIndex]) return null\r\n\r\n\t\tconst item = items[mainIndex]\r\n\t\t// 对于子项，我们使用主项的 record_id\r\n\t\treturn item.record_id\r\n\t}\r\n\r\n\t// 切换\"本项目是否需要\"复选框（针对子项）\r\n\tasync function toggleRequiredForItem(items, mainIndex, subType) {\r\n\t\tconst item = items[mainIndex]\r\n\t\tif (!item || !item.record_id) {\r\n\t\t\tconsole.error('切换复选框失败：item或record_id不存在')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// 切换状态\r\n\t\t\tconst newRequired = !getRequiredStatus(items, mainIndex, subType)\r\n\r\n\t\t\t// 更新本地状态\r\n\t\t\tconst statusKey = `submitted${subType}`\r\n\t\t\tif (item[statusKey] !== undefined) {\r\n\t\t\t\t// 如果有子项状态，保持原有的 submitted 状态\r\n\t\t\t\t// 这里我们只更新 required 状态\r\n\t\t\t\tconsole.log(`切换子项 ${mainIndex}-${subType} 的required状态为:`, newRequired)\r\n\t\t\t}\r\n\r\n\t\t\t// 显示加载中\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '保存中...',\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\t// 调用后端接口更新数据库\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/update_require',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecord_id: item.record_id,\r\n\t\t\t\t\t\tis_require: newRequired ? 1 : 0,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('更新is_require成功:', res)\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('更新is_require失败:', err)\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200 && response.data.success) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: newRequired ? '已标记为需要' : '已标记为不需要',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 更新本地状态\r\n\t\t\t\t// 由于子项的 required 状态存储在同一个记录中，我们需要重新获取数据\r\n\t\t\t\tawait fetchTizidanData()\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.data?.message || '更新失败')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('切换复选框失败:', error)\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `保存失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// 辅助函数：根据level1_name获取所有项目\r\n\tfunction getItemsByLevel1(level1Name) {\r\n\t\treturn tizidanItems.value.filter(item => item.level1_name === level1Name)\r\n\t}\r\n\r\n\t// 辅助函数：检查是否有指定level1_name的项目\r\n\tfunction hasItemsByLevel1(level1Name) {\r\n\t\treturn tizidanItems.value.some(item => item.level1_name === level1Name)\r\n\t}\r\n\r\n\t// 辅助函数：获取分组编号\r\n\tfunction getSectionNumber(level1Name) {\r\n\t\tconst level1Names = [\r\n\t\t\t'项目历史以来环评报告及批复',\r\n\t\t\t'项目相关环保验收资料',\r\n\t\t\t'（房地产项目提供）房地产相关证件',\r\n\t\t\t'污染治理设施设计方案',\r\n\t\t\t'厂区总平面图及各层平面图（CAD版本）',\r\n\t\t\t'厂区排水设计图（CAD版本）',\r\n\t\t\t'排污许可证',\r\n\t\t\t'排水许可证',\r\n\t\t\t'危废处置协议及相应处置资质',\r\n\t\t\t'其他需要提供的资料'\r\n\t\t]\r\n\t\treturn level1Names.indexOf(level1Name) + 1\r\n\t}\r\n\r\n\t// 辅助函数：获取项目编号\r\n\tfunction getItemNumber(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) return '1-1'\r\n\t\t\tif (level2Name.includes('批复')) return '1-2'\r\n\t\t} else if (level1Name === '项目相关环保验收资料') {\r\n\t\t\treturn '2'\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) return '3-1'\r\n\t\t\tif (level2Name.includes('规划许可证')) return '3-2'\r\n\t\t\tif (level2Name.includes('规划验收合格证')) return '3-3'\r\n\t\t} else {\r\n\t\t\treturn getSectionNumber(level1Name)\r\n\t\t}\r\n\r\n\t\treturn getSectionNumber(level1Name)\r\n\t}\r\n\r\n\t// 辅助函数：获取项目标题\r\n\tfunction getItemTitle(item) {\r\n\t\tif (item.level2_name && item.level2_name.trim()) {\r\n\t\t\treturn item.level2_name\r\n\t\t}\r\n\t\treturn item.level1_name\r\n\t}\r\n\r\n\t// 辅助函数：获取项目文件\r\n\tfunction getItemFiles(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\t// 处理特殊子项的文件\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) {\r\n\t\t\t\treturn item.files1_1 || []\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('批复')) {\r\n\t\t\t\treturn item.files1_2 || []\r\n\t\t\t}\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) {\r\n\t\t\t\treturn item.files3_1 || []\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划许可证')) {\r\n\t\t\t\treturn item.files3_2 || []\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划验收合格证')) {\r\n\t\t\t\treturn item.files3_3 || []\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 默认返回主文件列表\r\n\t\treturn item.files || []\r\n\t}\r\n\r\n\t// 辅助函数：获取文件键名\r\n\tfunction getFileKey(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) return '1_1'\r\n\t\t\tif (level2Name.includes('批复')) return '1_2'\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) return '3_1'\r\n\t\t\tif (level2Name.includes('规划许可证')) return '3_2'\r\n\t\t\tif (level2Name.includes('规划验收合格证')) return '3_3'\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t}\r\n\r\n\t// 辅助函数：获取提交状态\r\n\tfunction getSubmittedStatus(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) {\r\n\t\t\t\treturn item.submitted1_1 || false\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('批复')) {\r\n\t\t\t\treturn item.submitted1_2 || false\r\n\t\t\t}\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) {\r\n\t\t\t\treturn item.submitted3_1 || false\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划许可证')) {\r\n\t\t\t\treturn item.submitted3_2 || false\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划验收合格证')) {\r\n\t\t\t\treturn item.submitted3_3 || false\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn item.submitted || false\r\n\t}\r\n\r\n\t// 修改上传文件函数，支持子项类型\r\n\tasync function uploadTizidanFile(recordId, subType = null) {\r\n\t\tif (!recordId) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '记录ID不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 选择多个文件\r\n\t\tuni.chooseFile({\r\n\t\t\tcount: 9,\r\n\t\t\textension: ['.doc', '.docx', '.pdf', '.xls', '.xlsx', '.png', '.jpg', '.jpeg', '.zip', '.rar',\r\n\t\t\t\t'.dwg', '.dxf'\r\n\t\t\t],\r\n\t\t\tsuccess: async (chooseRes) => {\r\n\t\t\t\tconst tempFiles = chooseRes.tempFiles\r\n\r\n\t\t\t\t// 逐个上传文件\r\n\t\t\t\tfor (let i = 0; i < tempFiles.length; i++) {\r\n\t\t\t\t\tawait uploadSingleFile(recordId, subType, tempFiles[i])\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 重新加载数据\r\n\t\t\t\tawait fetchTizidanData()\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: `已成功上传${tempFiles.length}个文件`,\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 3000\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tconsole.error('选择文件失败:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '选择文件失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 修改删除文件函数，支持子项类型\r\n\tasync function deleteTizidanFile(recordId, subType, fileIndex) {\r\n\t\t// 从当前数据中查找项目\r\n\t\tconst item = tizidanItems.value.find(item => item.record_id === recordId)\r\n\t\tif (!item) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '记录不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 获取文件列表\r\n\t\tconst files = getItemFiles(item)\r\n\t\tif (fileIndex >= files.length) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '文件不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst fileName = files[fileIndex].name\r\n\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '确认删除',\r\n\t\t\tcontent: `确定要删除文件 \"${fileName}\" 吗？删除后不可恢复。`,\r\n\t\t\tsuccess: async (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t// 调用后端删除接口\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle: '删除中...'\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\turl: eco_baseUrl +\r\n\t\t\t\t\t\t\t\t\t'/api/v1/completion/tzdDetail/delete_file_by_id',\r\n\t\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\trecord_id: recordId,\r\n\t\t\t\t\t\t\t\t\tfile_name: fileName,\r\n\t\t\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tsuccess: (res) => resolve(res),\r\n\t\t\t\t\t\t\t\tfail: (err) => reject(err)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tif (response.statusCode === 200 && response.data.success) {\r\n\t\t\t\t\t\t\t// 重新加载数据\r\n\t\t\t\t\t\t\tawait fetchTizidanData()\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '文件删除成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new Error(response.data?.message || '删除失败')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.error('删除文件失败:', error)\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: `删除失败: ${error.message}`,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} finally {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 获取提资单数据时，确保正确处理子项数据\r\n\tasync function fetchTizidanData() {\r\n\t\ttry {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '加载中...'\r\n\t\t\t})\r\n\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/datasheet',\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('请求成功:', res)\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log('请求失败:', err)\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response && response.statusCode === 200) {\r\n\t\t\t\tconst data = response.data\r\n\r\n\t\t\t\tif (!data.items || !Array.isArray(data.items)) {\r\n\t\t\t\t\tthrow new Error('数据格式不正确: items 不存在或不是数组')\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 直接使用后端返回的数据\r\n\t\t\t\ttizidanItems.value = data.items\r\n\r\n\t\t\t\tconsole.log('提资单数据加载完成:', tizidanItems.value)\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '数据加载成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(`请求失败，状态码：${response?.statusCode || '未知'}`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('获取提资单数据失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载失败，请重新刷新！',\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t\ttizidanItems.value = []\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// 上传单个文件\r\n\tasync function uploadSingleFile(recordId, subType, file) {\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '上传文件中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\t// 使用 record_id 进行上传\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/upload_file_by_id',\r\n\t\t\t\t\tfilePath: file.path,\r\n\t\t\t\t\tname: 'file',\r\n\t\t\t\t\tformData: {\r\n\t\t\t\t\t\trecord_id: recordId,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (uploadRes) => {\r\n\t\t\t\t\t\tif (uploadRes.statusCode === 200) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tconst data = JSON.parse(uploadRes.data)\r\n\t\t\t\t\t\t\t\tresolve(data)\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\treject(new Error('解析响应失败'))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject(new Error(`上传失败，状态码：${uploadRes.statusCode}`))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\treject(new Error('网络请求失败'))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (!response.success) {\r\n\t\t\t\tthrow new Error(response.message || '文件上传失败')\r\n\t\t\t}\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`文件上传失败:`, error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `文件上传失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t// 提交其他需要提供的资料\r\n\tasync function submitOtherMaterials(recordId) {\r\n\t\t// 找到对应的项目\r\n\t\tconst itemIndex = tizidanItems.value.findIndex(item => item.record_id === recordId)\r\n\t\tif (itemIndex === -1) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '项目不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst item = tizidanItems.value[itemIndex]\r\n\t\tconst memoContent = item.customText || ''\r\n\r\n\t\tif (!memoContent.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入其他需要提供的资料',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '提交中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/update_memo',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecord_id: recordId,\r\n\t\t\t\t\t\tmemo: memoContent,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => resolve(res),\r\n\t\t\t\t\tfail: (err) => reject(err)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\tconst data = response.data\r\n\t\t\t\tif (data.success) {\r\n\t\t\t\t\t// 更新前端的提交状态\r\n\t\t\t\t\titem.submitted = true\r\n\r\n\t\t\t\t\t// 更新memo字段\r\n\t\t\t\t\titem.memo = memoContent\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// 重新加载数据以确保状态同步\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tfetchTizidanData()\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(data.message || '提交失败')\r\n\t\t\t\t}\r\n\t\t\t} else if (response.statusCode === 422) {\r\n\t\t\t\t// 处理422错误\r\n\t\t\t\tconst errorData = response.data || {}\r\n\t\t\t\tlet errorMsg = '提交失败: 数据格式错误'\r\n\t\t\t\tif (errorData.detail) {\r\n\t\t\t\t\t// FastAPI返回的422错误详情\r\n\t\t\t\t\tif (Array.isArray(errorData.detail)) {\r\n\t\t\t\t\t\terrorMsg = errorData.detail.map(d => d.msg).join('; ')\r\n\t\t\t\t\t} else if (typeof errorData.detail === 'string') {\r\n\t\t\t\t\t\terrorMsg = errorData.detail\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthrow new Error(errorMsg)\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(`服务器错误: ${response.statusCode}`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('提交失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `提交失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t// 提资单数据\r\n\tconst downloadUrls = ref({\r\n\t\tTiZiDan_Doc: '',\r\n\t\tcomparison_list: ''\r\n\t})\r\n\r\n\r\n\t// 检查所有文件是否为空\r\n\tfunction areAllFilesEmpty(item) {\r\n\t\t// 检查主文件列表\r\n\t\tif (item.files && item.files.length > 0) return false\r\n\r\n\t\t// 检查各个子文件列表\r\n\t\tconst subFileKeys = ['files1_1', 'files1_2', 'files3_1', 'files3_2', 'files3_3']\r\n\t\tfor (const key of subFileKeys) {\r\n\t\t\tif (item[key] && item[key].length > 0) return false\r\n\t\t}\r\n\r\n\t\treturn true\r\n\t}\r\n\r\n\r\n\r\n\t// 生成并下载验收报告提资单\r\n\tasync function downloadTizidanFile() {\r\n\t\tif (!selectedProjectId.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请先选择项目',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\r\n\t\t// 显示下载中提示\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '正在生成文档…',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\r\n\t\ttry {\r\n\t\t\t// 调用后端下载接口\r\n\t\t\tconst url =\r\n\t\t\t\teco_baseUrl +\r\n\t\t\t\t`/api/v1/completion/tzdDetail/download_tzd_doc?user_id=${user_id}&project_id=${project_id}`\r\n\r\n\t\t\t// #ifdef H5\r\n\t\t\t// H5环境：直接打开链接\r\n\t\t\twindow.open(url, '_blank')\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序环境：使用uni.downloadFile\r\n\t\t\tconst downloadTask = uni.downloadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\tconst filePath = res.tempFilePath\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: filePath,\r\n\t\t\t\t\t\t\tsuccess: (saveRes) => {\r\n\t\t\t\t\t\t\t\tconsole.log('文件保存成功:', saveRes.savedFilePath)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '文件已保存',\r\n\t\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: (saveErr) => {\r\n\t\t\t\t\t\t\t\tconsole.error('保存文件失败:', saveErr)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(`下载失败，状态码: ${res.statusCode}`)\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tthrow new Error('下载请求失败: ' + (err.errMsg || '未知错误'))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t// App环境：使用plus.downloader\r\n\t\t\tconst dtask = plus.downloader.createDownload(url, {}, (d, status) => {\r\n\t\t\t\tif (status == 200) {\r\n\t\t\t\t\tconsole.log('下载成功：' + d.filename)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '下载成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('下载失败：' + status)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '下载失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tdtask.start()\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '开始下载',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('下载失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载失败: ' + (error.message || '未知错误'),\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t// 添加URL格式化函数，确保URL格式正确\r\n\tfunction formatDownloadUrl(url) {\r\n\t\tif (!url) return ''\r\n\r\n\t\t// 如果URL是相对路径，添加基础URL\r\n\t\tif (url.startsWith('/')) {\r\n\t\t\treturn `{eco_baseUrl}${url}`\r\n\t\t}\r\n\r\n\t\t// 如果URL已经是完整路径，直接返回\r\n\t\tif (url.startsWith('http://') || url.startsWith('https://')) {\r\n\t\t\treturn url\r\n\t\t}\r\n\t\treturn url\r\n\t}\r\n\r\n\r\n\t// 修改下载文件函数，适配不同平台\r\n\tasync function downloadFile(url, filename) {\r\n\t\tif (!url) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载链接不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 显示下载中提示\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '下载中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\t// #ifdef H5\r\n\t\t\t// H5环境：使用a标签下载\r\n\t\t\tawait downloadFileH5(url, filename)\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序环境\r\n\t\t\tawait downloadFileWechat(url, filename)\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t// App环境\r\n\t\t\tawait downloadFileApp(url, filename)\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载成功',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('下载失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载失败: ' + (error.message || '未知错误'),\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// H5环境下载\r\n\tfunction downloadFileH5(url, filename) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst a = document.createElement('a')\r\n\t\t\t\ta.href = url\r\n\t\t\t\ta.download = filename || 'download'\r\n\t\t\t\ta.style.display = 'none'\r\n\r\n\t\t\t\tdocument.body.appendChild(a)\r\n\t\t\t\ta.click()\r\n\t\t\t\tdocument.body.removeChild(a)\r\n\r\n\t\t\t\t// H5下载无法准确判断是否成功，延迟一下再resolve\r\n\t\t\t\tsetTimeout(resolve, 1000)\r\n\t\t\t} catch (error) {\r\n\t\t\t\treject(error)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 微信小程序环境下载\r\n\tfunction downloadFileWechat(url, filename) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tuni.downloadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t// 下载成功，保存到本地\r\n\t\t\t\t\t\tconst filePath = res.tempFilePath\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: filePath,\r\n\t\t\t\t\t\t\tsuccess: (saveRes) => {\r\n\t\t\t\t\t\t\t\tconsole.log('文件保存成功:', saveRes.savedFilePath)\r\n\t\t\t\t\t\t\t\tresolve(saveRes)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: (saveErr) => {\r\n\t\t\t\t\t\t\t\treject(new Error('保存文件失败: ' + (saveErr.errMsg || '未知错误')))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error(`下载失败，状态码: ${res.statusCode}`))\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\treject(new Error('下载请求失败: ' + (err.errMsg || '未知错误')))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t// App环境下载\r\n\tfunction downloadFileApp(url, filename) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tuni.downloadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t// 在App中，下载的文件会保存到系统下载目录\r\n\t\t\t\t\t\t// 可以提示用户查看下载目录\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error(`下载失败，状态码: ${res.statusCode}`))\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\treject(new Error('下载请求失败: ' + (err.errMsg || '未知错误')))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\r\n\t// 监听步骤变化\r\n\twatch(currentStep, (newVal) => {\r\n\t\tif (newVal === 2) {\r\n\t\t\t// 进入提资单比对步骤时获取数据\r\n\t\t\tfetchTizidanData()\r\n\t\t}\r\n\t})\r\n\r\n\tconst baseTable = ref([])\r\n\tconst datasheet = ref([])\r\n\r\n\r\n\t// 选择删除模式\r\n\tconst selectMode = ref(false)\r\n\tconst selectedIds = ref([])\r\n\r\n\tfunction toggleSelectMode() {\r\n\t\tselectMode.value = !selectMode.value;\r\n\t\tif (!selectMode.value) selectedIds.value = []\r\n\t}\r\n\r\n\tfunction toggleSelected(id) {\r\n\t\tconst arr = selectedIds.value;\r\n\t\tconst i = arr.indexOf(id);\r\n\t\tif (i >= 0) arr.splice(i, 1);\r\n\t\telse arr.push(id)\r\n\t}\r\n\r\n\tfunction removeSelected() {\r\n\t\tif (!selectedIds.value.length) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '未选择',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst names = baseTable.value\r\n\t\t\t.filter(r => selectedIds.value.includes(r.id))\r\n\t\t\t.map(r => (r.label || '（未命名）').trim())\r\n\r\n\t\tconst preview =\r\n\t\t\tnames.length === 1 ?\r\n\t\t\t`确认要删除「${names[0]}」吗？` :\r\n\t\t\t(() => {\r\n\t\t\t\tconst max = 8\r\n\t\t\t\tconst head = names.slice(0, max).map(n => `• ${n}`).join('\\n')\r\n\t\t\t\tconst tail = names.length > max ? `\\n… 等 ${names.length} 项` : ''\r\n\t\t\t\treturn `确认要删除以下 ${names.length} 个信息吗？\\n${head}${tail}`\r\n\t\t\t})()\r\n\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '确认删除',\r\n\t\t\tcontent: preview,\r\n\t\t\tconfirmText: '删除',\r\n\t\t\tcancelText: '取消',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\tbaseTable.value = baseTable.value.filter(\r\n\t\t\t\t\t\tr => !selectedIds.value.includes(r.id)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tselectedIds.value = []\r\n\t\t\t\t\tselectMode.value = false\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `已删除 ${names.length} 项`,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t//by wilson 提资单代码在这里结束\r\n\t\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t/* ========== 设计令牌（统一风格） ========== */\r\n\t$brand: #166534; // 主色（深绿）\r\n\t$brand-600: #17834a;\r\n\t$brand-50: #ecfdf5;\r\n\t$ink: #0f172a; // 标题\r\n\t$muted: #5b6b7b; // 次文本\r\n\t$line: #e6eaf0; // 细线\r\n\t$bg: #f6f8fb; // 背景\r\n\t$white: #ffffff;\r\n\t$danger: #d92d20;\r\n\t$warning: #fb923c;\r\n\r\n\t$radius: 14rpx;\r\n\t$radius-lg: 18rpx;\r\n\t$shadow-sm: 0 2rpx 10rpx rgba(16, 24, 40, .06);\r\n\t$shadow-md: 0 6rpx 24rpx rgba(16, 24, 40, .08);\r\n\r\n\t/* ========== 页面框架 ========== */\r\n\t.acceptance-page {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: $bg;\r\n\t}\r\n\r\n\r\n\t/* 统一按钮体系 */\r\n\t.btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tpadding: 0 22rpx;\r\n\t\theight: 64rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: 500;\r\n\t\tbackground: $white;\r\n\t\tcolor: #374151;\r\n\t\ttransition: transform .12s ease, box-shadow .12s ease, background .12s ease, border-color .12s ease;\r\n\t}\r\n\r\n\t:deep(.uni-button.btn.btn--secondary::after) {\r\n\t\tborder-radius: $radius;\r\n\t}\r\n\r\n\t.btn:active {\r\n\t\ttransform: translateY(1rpx);\r\n\t}\r\n\r\n\t.btn[disabled] {\r\n\t\topacity: .6;\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.btn--primary {\r\n\t\tbackground: $brand;\r\n\t\tcolor: $white;\r\n\t\tborder-color: $brand;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(22, 101, 52, .22);\r\n\t}\r\n\r\n\t.btn--secondary {\r\n\t\tbackground: #f8fafc;\r\n\t\tcolor: #155e3b;\r\n\t\tborder-color: #dbe3ea;\r\n\t}\r\n\r\n\t.btn--ghost {\r\n\t\tbackground: $white;\r\n\t\tcolor: $muted;\r\n\t\tborder-color: #e9edf2;\r\n\t}\r\n\r\n\t/* 步骤导航 */\r\n\t.acceptance-steps {\r\n\t\tbackground: $white;\r\n\t\tborder-bottom: 1rpx solid #f2f4f7;\r\n\t\tpadding: 18rpx 24rpx;\r\n\t}\r\n\r\n\t.steps-container {\r\n\t\tmax-width: 1200rpx;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t.mobile-step-select {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.desktop-steps {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.step-item {\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 14rpx 18rpx;\r\n\t\tborder-radius: $radius;\r\n\t\tborder: 1rpx solid transparent;\r\n\t\ttransition: background .2s ease, border-color .2s ease;\r\n\t}\r\n\r\n\t.step-item--active {\r\n\t\tbackground: #f3faf6;\r\n\t\tborder-color: #def7ec;\r\n\t}\r\n\r\n\t.step-item--completed .step-indicator {\r\n\t\tbackground: #10b981;\r\n\t\tcolor: $white;\r\n\t}\r\n\r\n\t.step-indicator {\r\n\t\twidth: 44rpx;\r\n\t\theight: 44rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: #eef2f6;\r\n\t\tcolor: $muted;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-size: 20rpx;\r\n\t\tfont-weight: 700;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.step-label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #344054;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.step-connector {\r\n\t\twidth: 20rpx;\r\n\t\theight: 2rpx;\r\n\t\tbackground: #e3e8ef;\r\n\t\tmargin-left: 4rpx;\r\n\t\tborder-radius: 1rpx;\r\n\t}\r\n\r\n\t/* 主体 */\r\n\t.acceptance-content {\r\n\t\tflex: 1;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tmin-height: 0;\r\n\t}\r\n\r\n\t.content-scroll {\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.content-section {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.section-card {\r\n\t\tbackground: $white;\r\n\t\tborder-radius: $radius-lg;\r\n\t\tbox-shadow: $shadow-md;\r\n\t\tborder: 1rpx solid #eef2f6;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.section-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t\tpadding: 24rpx 24rpx 0;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t\tletter-spacing: .2rpx;\r\n\t}\r\n\r\n\t.section-body {\r\n\t\tpadding: 0 24rpx 24rpx;\r\n\t}\r\n\t\r\n\t// 项目搜索框\r\n\t.placeholder {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.placeholder-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\t/* 项目选择器弹窗样式 */\r\n\t.project-picker-modal {\r\n\t\twidth: 90vw;\r\n\t\tmax-width: 700rpx;\r\n\t\tmax-height: 80vh;\r\n\t\tbackground: $white;\r\n\t\tborder-radius: 24rpx;\r\n\t\toverflow: hidden;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tbox-shadow: 0 20rpx 60rpx rgba(0, 0, 0, 0.15);\r\n\t}\r\n\r\n\t.picker-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 32rpx 32rpx 24rpx;\r\n\t\tborder-bottom: 2rpx solid #f3f4f6;\r\n\t\tbackground: linear-gradient(135deg, #f8fafb 0%, #ffffff 100%);\r\n\t}\r\n\r\n\t.picker-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.picker-close {\r\n\t\twidth: 48rpx;\r\n\t\theight: 48rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground: #f3f4f6;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.picker-close:active {\r\n\t\tbackground: #e5e7eb;\r\n\t\ttransform: scale(0.95);\r\n\t}\r\n\r\n\t.picker-search {\r\n\t\tpadding: 24rpx 32rpx;\r\n\t\tbackground: $white;\r\n\t\tborder-bottom: 2rpx solid #f3f4f6;\r\n\t}\r\n\r\n\t.picker-stats {\r\n\t\tpadding: 16rpx 32rpx;\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-bottom: 1rpx solid #e5e7eb;\r\n\t}\r\n\r\n\t.stats-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t}\r\n\r\n\t.stats-highlight {\r\n\t\tcolor: $brand;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.picker-list {\r\n\t\tflex: 1;\r\n\t\tmin-height: 0;\r\n\t\tmax-height: 60vh;\r\n\t\tpadding: 16rpx 0;\r\n\t}\r\n\r\n\t.picker-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 20rpx;\r\n\t\tpadding: 24rpx 32rpx;\r\n\t\tmargin: 0 16rpx 12rpx;\r\n\t\tbackground: $white;\r\n\t\tborder: 2rpx solid #f3f4f6;\r\n\t\tborder-radius: 16rpx;\r\n\t\ttransition: all 0.2s ease;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.picker-item:active {\r\n\t\ttransform: translateY(-2rpx);\r\n\t\tbox-shadow: 0 8rpx 20rpx rgba(22, 101, 52, 0.08);\r\n\t}\r\n\r\n\t.picker-item--active {\r\n\t\tbackground: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);\r\n\t\tborder-color: $brand;\r\n\t\tbox-shadow: 0 4rpx 16rpx rgba(22, 101, 52, 0.12);\r\n\t}\r\n\r\n\t.picker-item-icon {\r\n\t\tflex-shrink: 0;\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground: #f3f4f6;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.picker-item--active .picker-item-icon {\r\n\t\tbackground: linear-gradient(135deg, $brand 0%, $brand-600 100%);\r\n\t}\r\n\r\n\t.picker-item--active .picker-item-icon uni-icons {\r\n\t\tcolor: $white !important;\r\n\t}\r\n\r\n\t.picker-item-content {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.picker-item-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 600;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.picker-item--active .picker-item-name {\r\n\t\tcolor: $brand;\r\n\t}\r\n\r\n\t.picker-item-desc {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.picker-item-meta {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tmargin-top: 4rpx;\r\n\t}\r\n\r\n\t.meta-text {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\t.picker-item-action {\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.selected-badge {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: linear-gradient(135deg, $brand 0%, $brand-600 100%);\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(22, 101, 52, 0.3);\r\n\t}\r\n\r\n\t.picker-empty {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t\tpadding: 80rpx 32rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.picker-empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #64748b;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.picker-empty-tip {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\r\n\t\r\n\r\n\t/* 项目文件列表样式 */\r\n\t.file-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t\tmargin-top: 24rpx;\r\n\t}\r\n\r\n\t.file-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #f8fafb;\r\n\t\tborder-radius: 16rpx;\r\n\t\tborder: 2rpx solid #e5e9ed;\r\n\t\ttransition: all 0.2s;\r\n\t}\r\n\r\n\t.file-item:hover {\r\n\t\tbackground: #f3f6f9;\r\n\t\tborder-color: #d1dce5;\r\n\t}\r\n\r\n\t.file-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 20rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.file-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #1f2937;\r\n\t\tfont-weight: 500;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t/* 空状态 */\r\n\t.empty-state {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 50rpx 24rpx;\r\n\t\tcolor: #cbd5e1;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #64748b;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.empty-tip {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #9aa8b6;\r\n\t}\r\n\r\n\t/* 底部导航 */\r\n\t.acceptance-navigation {\r\n\t\tbackground: $white;\r\n\t\tborder-top: 1rpx solid $line;\r\n\t\tpadding: 18rpx 24rpx;\r\n\t\tbox-shadow: 0 -2rpx 10rpx rgba(16, 24, 40, .06);\r\n\t}\r\n\r\n\t.nav-buttons {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmax-width: 1200rpx;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t/* 弹窗 */\r\n\t.modal {\r\n\t\tbackground: $white;\r\n\t\tborder-radius: 20rpx;\r\n\t\twidth: 86vw;\r\n\t\tmax-width: 620rpx;\r\n\t\toverflow: hidden;\r\n\t\tbox-shadow: 0 18rpx 52rpx rgba(15, 23, 42, .18);\r\n\t}\r\n\r\n\t.modal-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 24rpx;\r\n\t\tborder-bottom: 1rpx solid #eff3f7;\r\n\t}\r\n\r\n\t.modal-title {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.modal-close {\r\n\t\twidth: 44rpx;\r\n\t\theight: 44rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tbackground: transparent;\r\n\t\tborder: 1rpx solid #eef2f6;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.modal-body {\r\n\t\tpadding: 24rpx;\r\n\t}\r\n\r\n\t.modal-description {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t\tmargin-bottom: 14rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\r\n\t.modal-actions {\r\n\t\tdisplay: flex;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 0 24rpx 24rpx;\r\n\t\tjustify-content: flex-end;\r\n\t}\r\n\r\n\t/* ==========wilson 提资单样式比对样式 ========== */\r\n\t/* ========== 提资单比对模块优化 ========== */\r\n\t/* 步骤2容器 */\r\n\t.tizidan-container {\r\n\t\tbackground: $white;\r\n\t\tborder-radius: $radius-lg;\r\n\t\tborder: 1rpx solid #eef2f6;\r\n\t\tpadding: 32rpx;\r\n\t\tmargin-bottom: 24rpx;\r\n\t\tbox-shadow: $shadow-sm;\r\n\t}\r\n\r\n\t/* 头部区域 */\r\n\t.tizidan-header {\r\n\t\tmargin-bottom: 32rpx;\r\n\t\ttext-align: center;\r\n\t\tpadding-bottom: 24rpx;\r\n\t\tborder-bottom: 2rpx solid #f1f5f9;\r\n\t}\r\n\r\n\t.tizidan-title {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t\tmargin-bottom: 12rpx;\r\n\t\tline-height: 1.4;\r\n\t}\r\n\r\n\t.tizidan-subtitle {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $muted;\r\n\t\tline-height: 1.5;\r\n\t}\r\n\r\n\t/* 分组容器 */\r\n\t.tizidan-section {\r\n\t\tbackground: #fafbfd;\r\n\t\tborder-radius: 16rpx;\r\n\t\tborder: 1rpx solid #e9edf2;\r\n\t\tmargin-bottom: 32rpx;\r\n\t\toverflow: hidden;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t.tizidan-section:hover {\r\n\t\tbox-shadow: 0 8rpx 32rpx rgba(22, 101, 52, 0.08);\r\n\t\tborder-color: #d1f5ea;\r\n\t}\r\n\r\n\t/* 分组头部 */\r\n\t.tizidan-section-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t\tpadding: 24rpx 32rpx;\r\n\t\tbackground: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);\r\n\t\tborder-bottom: 1rpx solid #dcfce7;\r\n\t}\r\n\r\n\t.tizidan-section-number {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: $brand;\r\n\t\tmin-width: 40rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.tizidan-section-title {\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: $ink;\r\n\t\tline-height: 1.4;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t/* 项目卡片 */\r\n\t.tizidan-item-card {\r\n\t\tbackground: $white;\r\n\t\tborder-bottom: 1rpx solid #f1f5f9;\r\n\t\tpadding: 28rpx 32rpx;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.tizidan-item-card:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.tizidan-item-card:hover {\r\n\t\tbackground: #f8fafc;\r\n\t}\r\n\r\n\t/* 项目头部 */\r\n\t.tizidan-item-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tflex-wrap: wrap;\r\n\t\tgap: 16rpx;\r\n\t}\r\n\r\n\t.tizidan-item-left {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t\tgap: 16rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.tizidan-item-number {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: $brand;\r\n\t\tmin-width: 40rpx;\r\n\t\tbackground: #f0fdf4;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 4rpx 8rpx;\r\n\t\ttext-align: center;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.tizidan-item-content {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.tizidan-item-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $ink;\r\n\t\tline-height: 1.5;\r\n\t\tmargin-bottom: 4rpx;\r\n\t}\r\n\r\n\t/* 复选框区域 */\r\n\t.tizidan-checkbox-group {\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.checkbox-label {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tcursor: pointer;\r\n\t\tpadding: 8rpx 16rpx;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-radius: 10rpx;\r\n\t\tborder: 1rpx solid #e9edf2;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.checkbox-label:active {\r\n\t\tbackground: #f1f5f9;\r\n\t\tborder-color: #d1dbe5;\r\n\t}\r\n\r\n\t.checkbox-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: $muted;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t/* 禁用状态 */\r\n\t.tizidan-item-disabled {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-radius: 12rpx;\r\n\t\tborder: 2rpx dashed #d1d5db;\r\n\t\ttext-align: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-top: 16rpx;\r\n\t}\r\n\r\n\t.disabled-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #9ca3af;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t/* 项目主体 */\r\n\t.tizidan-item-body {\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 12rpx;\r\n\t\tborder: 1rpx solid #eef2f6;\r\n\t\tpadding: 24rpx;\r\n\t\tmargin-top: 16rpx;\r\n\t}\r\n\r\n\t/* 操作区域 */\r\n\t.tizidan-item-actions {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tpadding-bottom: 20rpx;\r\n\t\tborder-bottom: 1rpx solid #f1f5f9;\r\n\t}\r\n\r\n\t.tizidan-file-count {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tpadding: 8rpx 16rpx;\r\n\t\tbackground: #ecfdf5;\r\n\t\tborder-radius: 20rpx;\r\n\t\tborder: 1rpx solid #d1fae5;\r\n\t}\r\n\r\n\t.file-count-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $brand;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t/* 文件列表 */\r\n\t.tizidan-file-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t\tmargin-top: 16rpx;\r\n\t}\r\n\r\n\t.tizidan-file-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-radius: 12rpx;\r\n\t\tborder: 1rpx solid #e9edf2;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.tizidan-file-item:hover {\r\n\t\tbackground: #f1f5f9;\r\n\t\tborder-color: #d1dbe5;\r\n\t}\r\n\r\n\t.tizidan-file-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.tizidan-file-name {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 500;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.tizidan-file-size {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t\tflex-shrink: 0;\r\n\t\tmargin-left: 8rpx;\r\n\t}\r\n\r\n\t/* 其他资料输入 */\r\n\t.tizidan-other-input {\r\n\t\tmargin-bottom: 24rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-radius: 12rpx;\r\n\t\tborder: 1rpx solid #e9edf2;\r\n\t}\r\n\r\n\t.custom-textarea {\r\n\t\twidth: 100%;\r\n\t\tmargin-bottom: 16rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tborder: 1rpx solid #e2e8f0;\r\n\t}\r\n\r\n\t/* 底部区域 */\r\n\t.tizidan-footer {\r\n\t\tmargin-top: 40rpx;\r\n\t\tpadding-top: 32rpx;\r\n\t\tborder-top: 2rpx solid #eef2f6;\r\n\t}\r\n\r\n\t.footer-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t}\r\n\r\n\t/* 资料接收者信息*/\r\n\t.contact-info-section {\r\n\t\tbackground: #f0fdf4;\r\n\t\tborder-radius: 16rpx;\r\n\t\tborder: 1rpx solid #dcfce7;\r\n\t\tpadding: 28rpx 32rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.contact-info-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tmargin-bottom: 24rpx;\r\n\t}\r\n\r\n\t.contact-info-title {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: $brand;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.contact-info-form {\r\n\t\tdisplay: grid;\r\n\t\tgap: 20rpx;\r\n\t}\r\n\r\n\t.contact-info-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.contact-info-label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.contact-info-input {\r\n\t\twidth: 100%;\r\n\t\tborder-radius: 10rpx;\r\n\t\tborder: 1rpx solid #e2e8f0;\r\n\t\tbackground: $white;\r\n\t}\r\n\r\n\t.footer-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: $muted;\r\n\t\ttext-align: center;\r\n\t\tline-height: 1.6;\r\n\t\tpadding: 16rpx 0;\r\n\t}\r\n\r\n\t/* 小按钮样式 */\r\n\t.btn.btn--small {\r\n\t\theight: 60rpx;\r\n\t\tpadding: 0 24rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tgap: 8rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t}\r\n\r\n\t.btn.btn--icon {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tpadding: 0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tborder-radius: 10rpx;\r\n\t\tbackground: #fef2f2;\r\n\t\tborder: 1rpx solid #fee2e2;\r\n\t}\r\n\r\n\t.btn.btn--icon:active {\r\n\t\tbackground: #fee2e2;\r\n\t\ttransform: scale(0.95);\r\n\t}\r\n\r\n\t/* ========== 响应式设计 ========== */\r\n\t/* 移动端适配 */\r\n\t@media (max-width: 768px) {\r\n\t\t.tizidan-container {\r\n\t\t\tpadding: 24rpx 20rpx;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-title {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-subtitle {\r\n\t\t\tfont-size: 26rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-header {\r\n\t\t\tpadding: 20rpx 24rpx;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 12rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-number {\r\n\t\t\tfont-size: 30rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-title {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-card {\r\n\t\t\tpadding: 24rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-header {\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 16rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-checkbox-group {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\t.checkbox-label {\r\n\t\t\twidth: 100%;\r\n\t\t\tjustify-content: center;\r\n\t\t}\r\n\r\n\t\t.contact-info-form {\r\n\t\t\tgap: 16rpx;\r\n\t\t}\r\n\r\n\t\t.contact-info-section {\r\n\t\t\tpadding: 24rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-item {\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 16rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-info {\r\n\t\t\twidth: 100%;\r\n\t\t\tflex-wrap: wrap;\r\n\t\t}\r\n\t}\r\n\r\n\t/* PC端适配 */\r\n\t@media (min-width: 769px) {\r\n\t\t.tizidan-container {\r\n\t\t\tmax-width: 1200rpx;\r\n\t\t\tmargin: 0 auto 32rpx;\r\n\t\t}\r\n\r\n\t\t.contact-info-form {\r\n\t\t\tgrid-template-columns: repeat(3, 1fr);\r\n\t\t\tgap: 24rpx;\r\n\t\t}\r\n\r\n\t\t.contact-info-item {\r\n\t\t\tmargin-bottom: 0;\r\n\t\t}\r\n\r\n\t\t.footer-content {\r\n\t\t\tflex-direction: row;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\r\n\t\t.footer-text {\r\n\t\t\tflex: 1;\r\n\t\t\ttext-align: left;\r\n\t\t\tpadding-right: 32rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-item {\r\n\t\t\tflex-direction: row;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 超大屏幕适配 */\r\n\t@media (min-width: 1200px) {\r\n\t\t.tizidan-container {\r\n\t\t\tpadding: 48rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section {\r\n\t\t\tmargin-bottom: 40rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-header {\r\n\t\t\tpadding: 32rpx 40rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-title {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-card {\r\n\t\t\tpadding: 32rpx 40rpx;\r\n\t\t}\r\n\r\n\t\t.contact-info-section {\r\n\t\t\tpadding: 32rpx 40rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 加载失败提示 */\r\n\t.tizidan-container .empty-state {\r\n\t\tpadding: 60rpx 32rpx;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-radius: 16rpx;\r\n\t\tborder: 2rpx dashed #e2e8f0;\r\n\t\tmargin: 20rpx 0;\r\n\t}\r\n\r\n\t.tizidan-container .empty-state uni-icons {\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.tizidan-container .empty-state .empty-text {\r\n\t\tfont-size: 30rpx;\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\r\n\t.tizidan-container .empty-state .empty-tip {\r\n\t\tfont-size: 26rpx;\r\n\t\tmargin-bottom: 24rpx;\r\n\t}\r\n\r\n\t/* 悬停效果优化 */\r\n\t.tizidan-item-card,\r\n\t.tizidan-file-item,\r\n\t.tizidan-section {\r\n\t\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\t}\r\n\r\n\t.tizidan-item-card:hover {\r\n\t\ttransform: translateY(-2rpx);\r\n\t}\r\n\r\n\t/* 边框和阴影优化 */\r\n\t.tizidan-container,\r\n\t.tizidan-section,\r\n\t.tizidan-item-body,\r\n\t.tizidan-other-input,\r\n\t.contact-info-section {\r\n\t\tbox-shadow: 0 2rpx 12rpx rgba(22, 101, 52, 0.05);\r\n\t}\r\n\r\n\t.tizidan-container:active,\r\n\t.tizidan-section:active,\r\n\t.tizidan-item-body:active {\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(22, 101, 52, 0.08);\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/97247/Desktop/uni-ecoful/pages/reports/acceptance/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["navTitleStore","onShow","usePlatformInfo","ref","computed","useProjectInfo","onLoad","onUnmounted","useMonitorPlan","useFieldSurveyData","useAcceptanceReport","uni","item","res","watch"],"mappings":"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"}