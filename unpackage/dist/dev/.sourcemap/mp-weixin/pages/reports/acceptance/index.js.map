{"version":3,"file":"index.js","sources":["pages/reports/acceptance/index.vue","../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVwb3J0cy9hY2NlcHRhbmNlL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<app-layout current=\"pages/reports/acceptance/index\">\r\n\t\t<view class=\"acceptance-page\">\r\n\t\t\t<!-- 步骤导航 -->\r\n\t\t\t<view class=\"acceptance-steps\">\r\n\t\t\t\t<view class=\"steps-container\">\r\n\t\t\t\t\t<template v-if=\"isMobile\">\r\n\t\t\t\t\t\t<uni-data-select v-model=\"currentStep\" :localdata=\"stepSelectOptions\" placeholder=\"选择步骤\"\r\n\t\t\t\t\t\t\tclass=\"mobile-step-select\" />\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t<view class=\"desktop-steps\" role=\"tablist\">\r\n\t\t\t\t\t\t\t<view v-for=\"(step, index) in stepNames\" :key=\"index\" class=\"step-item\" :class=\"{\r\n                  'step-item--active': currentStep === index,\r\n                  'step-item--completed': stepDone(index)\r\n                }\" role=\"tab\" :aria-selected=\"currentStep === index\" @tap=\"currentStep = index\">\r\n\t\t\t\t\t\t\t\t<view class=\"step-indicator\">\r\n\t\t\t\t\t\t\t\t\t<text v-if=\"stepDone(index)\" class=\"step-check\">✓</text>\r\n\t\t\t\t\t\t\t\t\t<text v-else class=\"step-number\">{{ index + 1 }}</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<text class=\"step-label\">{{ step }}</text>\r\n\t\t\t\t\t\t\t\t<view v-if=\"index < stepNames.length - 1\" class=\"step-connector\" />\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 主要内容区域 -->\r\n\t\t\t<view class=\"acceptance-content\">\r\n\t\t\t\t<scroll-view class=\"content-scroll\" scroll-y>\r\n\t\t\t\t\t<!-- 步骤1: 选择项目 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 0\" class=\"content-section\">\r\n\t\t\t\t\t\t<view class=\"section-card\">\r\n\t\t\t\t\t\t\t<view class=\"section-header\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"folder-add\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t<text class=\"section-title\">选择项目</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"section-body\">\r\n\t\t\t\t\t\t\t\t<!-- 项目选择 -->\r\n\t\t\t\t\t\t\t\t<view class=\"form-group\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"form-label\">请选择要进行竣工验收的项目</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"form-tip\">项目文件已在项目管理模块上传并自动处理</text>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 自定义项目选择器触发按钮 -->\r\n\t\t\t\t\t\t\t\t\t<view class=\"project-selector\" @tap=\"openProjectPicker\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"selector-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"selectedProject\" class=\"selected-project\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"folder\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"project-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"project-name\">{{ selectedProject.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"selectedProject.description\" class=\"project-desc\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ selectedProject.description }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"placeholder\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"folder-add\" size=\"20\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"placeholder-text\">请选择项目</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"down\" size=\"16\" color=\"#6b7280\" />\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<!-- 项目文件列表（只读） -->\r\n\t\t\t\t\t\t\t\t<view v-if=\"selectedProjectId && projectFiles.length > 0\" class=\"subsection\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"subsection-head\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"18\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"subsection-title\">项目文件列表（{{ projectFiles.length }} 个文件）</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<view class=\"file-list\">\r\n\t\t\t\t\t\t\t\t\t\t<view v-for=\"file in projectFiles\" :key=\"file.document_id\" class=\"file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons :type=\"getFileIcon(file.file_extension)\" size=\"20\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"file-details\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"file-name\">{{ file.filename }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"file-meta\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ formatFileSize(file.size_bytes) }} ·\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ formatFileStatus(file.status) }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"file-status\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"status-badge\" :class=\"getStatusClass(file.status)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{ getStatusText(file.status) }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<!-- 空状态提示 -->\r\n\t\t\t\t\t\t\t\t<view v-else-if=\"selectedProjectId && projectFiles.length === 0\" class=\"empty-state\">\r\n\t\t\t\t\t\t\t\t\t<uni-icons type=\"folder-add\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t\t\t\t\t<text class=\"empty-text\">该项目暂无文件</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"empty-tip\">请先在项目管理模块上传文件</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<view class=\"action-row\">\r\n\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"simulateExtract\"\r\n\t\t\t\t\t\t\t\t\t\t:disabled=\"!selectedProjectId || projectFiles.length === 0\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"search\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t<text>提取项目基本信息</text>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 清除缓存按钮（只在有缓存数据时显示） -->\r\n\t\t\t\t\t\t\t\t\t<button v-if=\"baseTable.length > 0\" class=\"btn btn--ghost\" @tap=\"clearProjectCache\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t<text>清除缓存</text>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<!-- 项目信息表和标识牌信息 -->\r\n\t\t\t\t\t\t\t\t<view v-if=\"baseTable.length\" class=\"subsection\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"subsection-head\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"list\" size=\"18\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"subsection-title\">项目信息表</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<view class=\"section-actions\">\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--ghost\" @tap=\"openAddBase\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"plus\" size=\"16\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>新增</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button v-if=\"selectMode\" class=\"btn btn--danger\"\r\n\t\t\t\t\t\t\t\t\t\t\t:disabled=\"!selectedIds.length\" @tap=\"removeSelected\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>删除选中（{{ selectedIds.length }}）</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--secondary\" @tap=\"toggleSelectMode\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons :type=\"selectMode ? 'clear' : 'checkbox'\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#155e3b\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>{{ selectMode ? '取消' : '选择删除' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 项目信息表 -->\r\n\t\t\t\t\t\t\t\t\t<view class=\"form-grid form-grid--base\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"form-item\" v-for=\"(item, idx) in baseTable\" :key=\"item.id\">\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 污染物表格特殊渲染 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.id === 'pollutants_emission' && item.type === 'table'\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"pollutants-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants_baseinfo_row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"form-item__label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ item.label }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"item.source === 'extracted'\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"extract-tag\">已提取</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 污染物表格 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-table\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 表格头部 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">污染物类型</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">产生时间</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">污染物名称</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">污染因子</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">污染治理措施\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">排放去向\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--standard\">执行标准\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 表格内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 水污染物 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.value.水污染物 && item.value.水污染物.length\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"(water, index) in item.value.水污染物\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'water-' + index\" class=\"pollutants-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">水污染物\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ water.产生环节 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ water.污染物名称 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ water.污染因子 || '未提取到污染因子' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ water.污染治理措施 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ water.排放去向 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--standard\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ water.执行标准 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 大气污染物 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.value.大气污染物 && item.value.大气污染物.length\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"(air, index) in item.value.大气污染物\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'air-' + index\" class=\"pollutants-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">大气污染物\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ air.产生环节 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ air.污染物名称 || '未提取到污染物名称' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ air.污染因子 || '未提取到污染因子' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ air.污染治理措施 || '未提取到污染治理措施' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ air.排放去向 || '大气环境' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--standard\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ air.执行标准 || '未提取到执行标准' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 噪声 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.value.噪声 && item.value.噪声.length\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"(noise, index) in item.value.噪声\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'noise-' + index\" class=\"pollutants-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">噪声</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ noise.产生环节 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ noise.污染物名称 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ noise.污染因子 || '未提取到污染因子' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ noise.污染治理措施 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ noise.排放去向 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--standard\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ noise.执行标准 || '未提取到相关信息' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 选择模式下的复选框 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"selectMode\" class=\"pollutants-select\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"selectedIds.includes(item.id)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"() => toggleSelected(item.id)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 废物表格（固废 + 危废）-->\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.id === 'pollutants_emission' && item.type === 'table'\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"pollutants-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants_baseinfo_row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"form-item__label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t固体废物产生情况\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"item.source === 'extracted'\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"extract-tag\">已提取</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 危废污染物表格 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-table\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 表格头部 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">废物类型</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">产生时间</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--link\">废物来源</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">废物名称</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">危险特性\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">危险废物类别\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">污染治理措施\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 表格内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 固体废物 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.value.固体废物 && item.value.固体废物.length\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"(solid, index) in item.value.固体废物\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'solid-' + index\" class=\"pollutants-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">固体废物\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.产生环节 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.废物来源 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.废物名称 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.危险特性 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.危险废物类别 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.污染治理措施 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 危险废物 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.value.危险废物 && item.value.危险废物.length\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"(solid, index) in item.value.危险废物\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'hazard-' + index\" class=\"pollutants-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--type\">危险废物\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- <view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ item.value.危险废物.产生环节 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--link\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.废物来源 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--name\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.废物名称 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--measure\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.危险特性 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.危险废物类别 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"pollutants-col pollutants-col--direction\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ solid.污染治理措施 || '无' }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 选择模式下的复选框 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"selectMode\" class=\"pollutants-select\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"selectedIds.includes(item.id)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"() => toggleSelected(item.id)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 除污染物外基本信息 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"baseinfo__row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"form-item__label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{ item.label }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!--  如果是提取的数据，显示绿色小标签 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"item.source === 'extracted'\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"extract-tag\">已提取</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput class=\"form-item__input\" v-model=\"item.value\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"请输入具体的值\" :clearable=\"true\" />\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"selectMode\" class=\"form-item__select\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"selectedIds.includes(item.id)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"() => toggleSelected(item.id)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 标识牌信息生成 -->\r\n\t\t\t\t\t\t\t\t\t<view class=\"subsection\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"subsection-head\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"list\" size=\"18\" color=\"#fb923c\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"subsection-title\">排污标识牌（下载与业主确认排污口信息）</text>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"section-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"() => { generateSignboard(); showSignboard = true }\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"eye-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text>标识牌信息</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<button v-if=\"showSignboard\" class=\"btn btn--primary\" @tap=\"downBiaoShi\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"download-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text>下载</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<button v-if=\"showSignboard\" class=\"btn btn--primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"currentStep = 1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"redo-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text>生成监测方案</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 标识牌信息列表 -->\r\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"showSignboard\" class=\"data-table\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"table-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"(sec, si) in signboard.sections\" :key=\"'s'+si\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"table-row table-row--simple\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"table-td table-td--section\">{{ sec.block }}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 只有噪声才可以新增 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button v-if=\"sec.block == '噪声'\" class=\"pw-ico icon-btn\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"() => addSignItem(si)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"plus\" size=\"16\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>新增</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"form-grid form-grid--base\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 按组渲染，每组 3 条，除了危废以外 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<template\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-for=\"(group, gi) in groupItems(sec.items, sec.block)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'g'+si+'-'+gi\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 普通 3 条 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"form-item\" v-for=\"(it, ii) in group\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"'r'+si+'-'+gi+'-'+ii\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"form-item__row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"it.title\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"内容标题\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"it.content\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"请输入具体的值\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 删除按钮：只有「非危险废物」才显示 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"sec.block !== '危险废物'\" class=\"form-item\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"margin-bottom:12px;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"form-item__row\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"justify-content:flex-end;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"icon-btn icon-btn--danger\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@tap=\"() => removeGroup(sec, gi)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#d92d20\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 步骤1: 监测方案 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 1\" class=\"content-section\">\r\n\t\t\t\t\t\t<view class=\"section-card\">\r\n\t\t\t\t\t\t\t<view class=\"section-header\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"eye\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t<text class=\"section-title\">监测方案</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"section-body\">\r\n\t\t\t\t\t\t\t\t<view class=\"empty-state\">\r\n\t\t\t\t\t\t\t\t\t<uni-icons type=\"eye\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t\t\t\t\t<text class=\"empty-text\">AI帮您制定监测方案</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"empty-tip\">请点击下方按钮为您生成智能检测方案</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<view class=\"action-row\">\r\n\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"saveMonitorPlan\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"refresh-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t<text>生成监测方案</text>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<!-- 生成后可点 -->\r\n\t\t\t\t\t\t\t\t\t<button v-if=\"canDownload\" class=\"btn btn--primary\" @tap=\"downloadPlan\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-download-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t<text>下载监测方案</text>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<view v-if=\"plan\" class=\"paln-preview\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"preview-header\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"checkmark-circle\" size=\"18\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"preview-title\">环保验收监测方案已为您已生成，请点击下载！</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t<view class=\"preview-content\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"preview-text\">环保验收监测方案已生成，包含以下内容：</text>\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"preview-sections\">\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 项目基本情况</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 环保设施建设情况</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 污染物详细情况</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 方案已生成，请点击下载</text>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\r\n\r\n\t\t\t\t\t<!-- 步骤2: 提资单比对 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 2\" class=\"content-section\">\r\n\t\t\t\t\t\t<view class=\"section-card\">\r\n\t\t\t\t\t\t\t<view class=\"section-header\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"list\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t<text class=\"section-title\">提资单比对</text>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<view class=\"section-body\">\r\n\t\t\t\t\t\t\t\t<!-- 环保资料提交管理系统界面 -->\r\n\t\t\t\t\t\t\t\t<view class=\"tizidan-container\">\r\n\t\t\t\t\t\t\t\t\t<!-- 顶部描述 -->\r\n\t\t\t\t\t\t\t\t\t<view class=\"tizidan-header\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-title\">环保资料提交管理系统</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-subtitle\">请按要求提交相关环保资料</text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 加载失败提示 -->\r\n\t\t\t\t\t\t\t\t\t<view v-if=\"tizidanItems.length === 0\" class=\"empty-state\">\r\n\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"refresh\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"empty-text\">加载失败，请重新刷新！</text>\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"fetchTizidanData\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"refresh\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>重新加载</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- 正常内容 -->\r\n\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-content\">\r\n\t\t\t\t\t\t\t\t\t\t<!-- 将提资单项分组显示 -->\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 1、项目历史以来环评报告及批复 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">1.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">项目历史以来环评报告及批复</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('项目历史以来环评报告及批复')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"getItemFiles(item).length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ getItemFiles(item).length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, getFileKey(item))\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '重新上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"getItemFiles(item).length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in getItemFiles(item)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, getFileKey(item), fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 2、项目相关环保验收资料 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">2.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">项目相关环保验收资料</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('项目相关环保验收资料')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.files && item.files.length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ item.files.length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, null)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '重新上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.files && item.files.length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in item.files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, null, fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 3、（房地产项目提供）房地产相关证件 -->\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">3.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">（房地产项目提供）房地产相关证件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('（房地产项目提供）房地产相关证件')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"getItemFiles(item).length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ getItemFiles(item).length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, getFileKey(item))\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ getSubmittedStatus(item) ? '重新上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"getItemFiles(item).length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in getItemFiles(item)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, getFileKey(item), fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 4-9项 - 统一布局的普通项 -->\r\n\t\t\t\t\t\t\t\t\t\t<template v-for=\"level1Name in ['污染治理设施设计方案', '厂区总平面图及各层平面图（CAD版本）', \r\n\t\t\t\t\t                          '厂区排水设计图（CAD版本）', '排污许可证', '排水许可证', '危废处置协议及相应处置资质']\" :key=\"level1Name\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"hasItemsByLevel1(level1Name)\" class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-section-number\">{{ getSectionNumber(level1Name) }}.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">{{ level1Name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1(level1Name)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目需要时显示内容 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.files && item.files.length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ item.files.length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, null)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '重新上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.files && item.files.length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in item.files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, null, fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 当项目不需要时显示禁用状态 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<!-- 10、其他需要提供的资料 -->\r\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"hasItemsByLevel1('其他需要提供的资料')\" class=\"tizidan-section\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-section-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-number\">10.</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"tizidan-section-title\">其他需要提供的资料</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 找到这个组的所有项目 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-for=\"item in getItemsByLevel1('其他需要提供的资料')\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:key=\"item.record_id\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-card\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-number\">{{ getItemNumber(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-item-title\">{{ getItemTitle(item) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 复选框：本项目是否需要 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-checkbox-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox-group @change=\"() => toggleRequired(item)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"checkbox-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<checkbox :checked=\"item.required\" color=\"#166534\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"transform:scale(0.9)\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"checkbox-text\">本项目是否需要</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.required\" class=\"tizidan-item-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 输入框 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-other-input\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-easyinput v-model=\"item.customText\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"请输入其他需要提供的资料（以防万一以上资料不满足特殊项目要求）\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"textarea\" :maxlength=\"500\" :clearable=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:autoHeight=\"true\" class=\"custom-textarea\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"submitOtherMaterials(item.record_id)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t提交\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-item-actions\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-count\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.files && item.files.length > 0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"14\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"file-count-text\">{{ item.files.length }}个文件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--small\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"uploadTizidanFile(item.record_id, null)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-upload\" size=\"14\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text>{{ item.submitted ? '重新上传' : '上传' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- 已上传文件列表 -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.files && item.files.length > 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-list\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-for=\"(file, fileIndex) in item.files\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:key=\"fileIndex\" class=\"tizidan-file-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<view class=\"tizidan-file-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"paperclip\" size=\"16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-name\">{{ file.name }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"tizidan-file-size\">{{ formatFileSize(file.size) }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--icon\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"deleteTizidanFile(item.record_id, null, fileIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"16\" color=\"#dc2626\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<view v-else class=\"tizidan-item-disabled\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"minus-circle\" size=\"18\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"disabled-text\">此项目无需提交</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t<!-- 底部按钮 -->\r\n\t\t\t\t\t\t\t\t<view class=\"tizidan-footer\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"footer-content\">\r\n\t\t\t\t\t\t\t\t\t\t<text class=\"footer-text\">请确保所有需要的资料完整准确提交</text>\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"downloadTizidanFile\"\r\n\t\t\t\t\t\t\t\t\t\t\t:disabled=\"!selectedProjectId\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"download-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>下载验收报告提资单</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\r\n\t\t\t\t\t<!-- 步骤3: 现场踏勘比对 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 3\" class=\"content-section\">\r\n\t\t\t\t\t\t<FieldSurveyContainer :userId=\"user_id\" :projectId=\"project_id\" :signboard=\"signboard\"\r\n\t\t\t\t\t\t\t:baseTable=\"baseTable\" :datasheet=\"datasheet\" @generate-signboard=\"generateSignboard\" />\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- 步骤4: 竣工验收报告 -->\r\n\t\t\t\t\t<view v-show=\"currentStep === 4\" class=\"content-section\">\r\n\t\t\t\t\t\t<view class=\"section-card\">\r\n\t\t\t\t\t\t\t<view class=\"section-header\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"calendar\" size=\"20\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t<text class=\"section-title\">竣工验收报告</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"section-body\">\r\n\t\t\t\t\t\t\t\t<view class=\"report-generation\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"generation-options\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"option-group\">\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"option-label\">请选择要生成的报告类型</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<radio-group class=\"radio-group\" @change=\"onReportTypeChange\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"radio-item\" v-for=\"type in reportTypes\" :key=\"type.value\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<radio :value=\"type.value\" :checked=\"reportType === type.value\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"radio-text\">{{ type.text }}</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t</radio-group>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"option-group\" v-if=\"reportType === 'withData'\">\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"option-label\"> 上传监测报告</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-file-picker v-model=\"testReportFiles\" fileMediatype=\"all\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t:auto-upload=\"false\" :limit=\"3\">\r\n\t\t\t\t\t\t\t\t\t\t\t</uni-file-picker>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<view class=\"generation-actions\">\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn--primary\" @tap=\"generateAcceptanceReport\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"refresh-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>生成验收报告</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t<!-- 生成后可点 -->\r\n\t\t\t\t\t\t\t\t\t\t<button v-if=\"canDownloadReport\" class=\"btn btn--primary\"\r\n\t\t\t\t\t\t\t\t\t\t\t@tap=\"downAcceptanceReport\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"cloud-download-filled\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text>下载竣工验收报告</text>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t\t\t<view v-if=\"reportGenerated\" class=\"report-preview\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"preview-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t<uni-icons type=\"checkmarkempty\" size=\"18\" color=\"#166534\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"preview-title\">{{previewTitle}}</text>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"preview-content\">\r\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"preview-text\">竣工验收报告已生成，包含以下内容：</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<view class=\"preview-sections\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 项目基本情况</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 环保设施建设情况</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 监测结果分析</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text class=\"section-item\">• 验收结论</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<text v-if=\"reportType === 'withData'\" class=\"section-item\">•\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t检测数据附件</text>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 底部导航 -->\r\n\t\t\t<view class=\"acceptance-navigation\">\r\n\t\t\t\t<view class=\"nav-buttons\">\r\n\t\t\t\t\t<button class=\"btn btn--ghost\" :disabled=\"currentStep === 0\" @tap=\"prevStep\">\r\n\t\t\t\t\t\t<uni-icons type=\"left\" size=\"16\" color=\"#5b6b7b\" />\r\n\t\t\t\t\t\t<text>上一步</text>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button class=\"btn btn--primary\" :disabled=\"currentStep === stepNames.length - 1\" @tap=\"nextStep\">\r\n\t\t\t\t\t\t<text>下一步</text>\r\n\t\t\t\t\t\t<uni-icons type=\"right\" size=\"16\" color=\"#ffffff\" />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</app-layout>\r\n\r\n\t<!-- 新增项目基本信息弹窗 -->\r\n\t<uni-popup ref=\"newBaseInfoPopup\" type=\"center\">\r\n\t\t<view class=\"modal\">\r\n\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t<text class=\"modal-title\">新增项目基本信息</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"modal-body\">\r\n\t\t\t\t<text class=\"modal-description\">请在下方输入信息名称</text>\r\n\t\t\t\t<uni-easyinput v-model=\"newBaseInfoLabel\" placeholder=\"如：项目名称/单位名称\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"modal-actions\">\r\n\t\t\t\t<button class=\"btn btn--ghost\" @tap=\"closeBaseInfo\">取消</button>\r\n\t\t\t\t<button class=\"btn btn--primary\" @tap=\"confirmAddBaseInfo\">确定</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</uni-popup>\r\n\r\n\t<!-- 任务进度弹窗 -->\r\n\t<TaskProgressModal ref=\"taskProgressModal\" :title=\"taskProgressTitle\" :progress=\"taskProgress\"\r\n\t\t:statusText=\"taskStatusText\" :state=\"taskState\" :cancelable=\"false\" />\r\n\r\n\t<!-- 项目选择弹窗 -->\r\n\t<uni-popup ref=\"projectPickerPopup\" type=\"center\" :mask-click=\"true\">\r\n\t\t<view class=\"project-picker-modal\">\r\n\t\t\t<view class=\"picker-header\">\r\n\t\t\t\t<text class=\"picker-title\">选择项目</text>\r\n\t\t\t\t<view class=\"picker-close\" @tap=\"closeProjectPicker\">\r\n\t\t\t\t\t<uni-icons type=\"close\" size=\"20\" color=\"#6b7280\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 搜索框 -->\r\n\t\t\t<view class=\"picker-search\">\r\n\t\t\t\t<uni-easyinput v-model=\"projectSearchKeyword\" placeholder=\"搜索项目名称...\" prefixIcon=\"search\"\r\n\t\t\t\t\t:clearable=\"true\" @input=\"onSearchInput\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 项目统计 -->\r\n\t\t\t<view class=\"picker-stats\">\r\n\t\t\t\t<text class=\"stats-text\">\r\n\t\t\t\t\t共 {{ filteredProjects.length }} 个项目\r\n\t\t\t\t\t<text v-if=\"projectSearchKeyword\" class=\"stats-highlight\">\r\n\t\t\t\t\t\t（搜索结果）\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 项目列表 -->\r\n\t\t\t<scroll-view class=\"picker-list\" scroll-y>\r\n\t\t\t\t<view v-for=\"project in filteredProjects\" :key=\"project.id\" class=\"picker-item\"\r\n\t\t\t\t\t:class=\"{ 'picker-item--active': selectedProjectId === project.id }\" @tap=\"selectProject(project)\">\r\n\t\t\t\t\t<view class=\"picker-item-icon\">\r\n\t\t\t\t\t\t<uni-icons type=\"folder\" size=\"22\"\r\n\t\t\t\t\t\t\t:color=\"selectedProjectId === project.id ? '#166534' : '#6b7280'\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"picker-item-content\">\r\n\t\t\t\t\t\t<text class=\"picker-item-name\">{{ project.name }}</text>\r\n\t\t\t\t\t\t<text v-if=\"project.description\" class=\"picker-item-desc\">\r\n\t\t\t\t\t\t\t{{ project.description }}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t<view v-if=\"project.folder_name\" class=\"picker-item-meta\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"calendar\" size=\"14\" color=\"#9ca3af\" />\r\n\t\t\t\t\t\t\t<text class=\"meta-text\">{{ project.folder_name }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"picker-item-action\">\r\n\t\t\t\t\t\t<view v-if=\"selectedProjectId === project.id\" class=\"selected-badge\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"checkmarkempty\" size=\"18\" color=\"#ffffff\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<uni-icons v-else type=\"right\" size=\"16\" color=\"#d1d5db\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 空状态 -->\r\n\t\t\t\t<view v-if=\"filteredProjects.length === 0\" class=\"picker-empty\">\r\n\t\t\t\t\t<uni-icons type=\"search\" size=\"48\" color=\"#cbd5e1\" />\r\n\t\t\t\t\t<text class=\"picker-empty-text\">\r\n\t\t\t\t\t\t{{ projectSearchKeyword ? '未找到匹配的项目' : '暂无项目' }}\r\n\t\t\t\t\t</text>\r\n\t\t\t\t\t<text v-if=\"projectSearchKeyword\" class=\"picker-empty-tip\">\r\n\t\t\t\t\t\t试试其他关键词或清空搜索\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t</uni-popup>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\treactive,\r\n\t\tcomputed,\r\n\t\tnextTick,\r\n\t\twatch,\r\n\t\tonUnmounted\r\n\t} from 'vue'\r\n\timport {\r\n\t\tusePlatformInfo\r\n\t} from '@/utils/platform'\r\n\timport AppLayout from '@/components/layout/AppLayout.vue'\r\n\timport {\r\n\t\tonShow,\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\timport TaskProgressModal from '@/components/message-pop-up/TaskProgressModal.vue'\r\n\timport FieldSurveyContainer from '@/components/field-survey/FieldSurveyContainer.vue'\r\n\timport {\r\n\t\tuseFieldSurveyData\r\n\t} from '@/composables/useFieldSurveyData.js'\r\n\timport {\r\n\t\tnavTitleStore\r\n\t} from '@/stores/navTitle.js'\r\n\timport {\r\n\t\trunTask,\r\n\t\ttransformExtractResult,\r\n\t\tdownloadSignboardWord,\r\n\t\tgenerateMonitorPlan,\r\n\t\tdownloadMonitorPlan,\r\n\t\tgenerateReport,\r\n\t\tdownloadReport\r\n\t} from '@/api/acceptance.js'\r\n\r\n\t//手机端头部页面标题\r\n\tconst navTitle = navTitleStore()\r\n\tonShow(() => navTitle.setTitle('环评项目竣工验收'))\r\n\r\n\t//手机页面规定\r\n\tconst {\r\n\t\tisMobile\r\n\t} = usePlatformInfo()\r\n\r\n\t// 任务进度弹窗相关状态\r\n\tconst taskProgressModal = ref(null)\r\n\tconst taskProgressTitle = ref('信息提取中')\r\n\tconst taskProgress = ref(0)\r\n\tconst taskStatusText = ref('正在初始化...')\r\n\tconst taskState = ref('running')\r\n\r\n\r\n\t// 每个步骤定义--------------------------\r\n\t// 步骤标题\r\n\tconst stepNames = ['资料上传与基本信息', '监测方案', '提资单比对', '现场踏勘比对', '竣工验收报告']\r\n\r\n\t// 默认从第一步开始(0)\r\n\tconst currentStep = ref(0)\r\n\r\n\t// 手机端步骤选择\r\n\tconst stepNamesDisplay = computed(() => stepNames.map((n, i) => stepDone(i) ? (n + ' ✓') : n))\r\n\tconst stepSelectOptions = computed(() => stepNames.map((n, i) => ({\r\n\t\ttext: stepDone(i) ? (n + ' ✓') : n,\r\n\t\tvalue: i\r\n\t})))\r\n\r\n\t// 步骤更改时\r\n\tfunction onStepChange(e) {\r\n\t\tconst idx = Number(e?.currentIndex ?? e?.detail?.currentIndex ?? 0);\r\n\t\tif (!Number.isNaN(idx)) currentStep.value = idx\r\n\t}\r\n\r\n\t// 上一步按钮\r\n\tfunction prevStep() {\r\n\t\tif (currentStep.value > 0) currentStep.value -= 1\r\n\t}\r\n\t// 下一步按钮\r\n\tfunction nextStep() {\r\n\t\tif (currentStep.value < stepNames.length - 1) currentStep.value += 1\r\n\t}\r\n\r\n\t// 步骤完成值\r\n\tconst extractionOk = ref(false)\r\n\r\n\t// 所有步骤的完成度\r\n\tfunction stepDone(i) {\r\n\t\tswitch (i) {\r\n\t\t\tcase 0:\r\n\t\t\t\treturn extractionOk.value;\r\n\t\t\tcase 1:\r\n\t\t\t\treturn datasheet.value.length > 0;\r\n\t\t\tcase 2:\r\n\t\t\t\treturn tizidanItems.value.some(item => item.submitted);\r\n\t\t\tcase 3:\r\n\t\t\t\treturn fieldSurveyData.fieldworkComparison.value.length > 0;\r\n\t\t\tcase 4:\r\n\t\t\t\treturn reportGenerated.value;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\t// 以下提取项目基本信息模块的方法-------------------------\r\n\r\n\t// 项目选择相关\r\n\tconst selectedProjectId = ref(null) // 选中的项目ID\r\n\tconst selectedProject = ref(null) // 选中的项目对象\r\n\tconst projectList = ref([]) // 完整项目列表\r\n\tconst projectFiles = ref([]) // 项目文件列表\r\n\tconst projectSearchKeyword = ref('') // 搜索关键词\r\n\tconst projectPickerPopup = ref(null) // 弹窗引用\r\n\r\n\t// 文件状态轮询相关\r\n\tconst pollingTimer = ref(null) // 轮询定时器\r\n\tconst isPolling = ref(false) // 是否正在轮询\r\n\tconst pollingCount = ref(0) // 轮询次数\r\n\tconst MAX_POLLING_COUNT = 100 // 最多轮询100次（约5分钟）\r\n\tconst POLLING_INTERVAL = 3000 // 轮询间隔（3秒）\r\n\r\n\t// 过滤后的项目列表（根据搜索关键词）\r\n\tconst filteredProjects = computed(() => {\r\n\t\tif (!projectSearchKeyword.value) {\r\n\t\t\treturn projectList.value\r\n\t\t}\r\n\t\tconst keyword = projectSearchKeyword.value.toLowerCase().trim()\r\n\t\treturn projectList.value.filter(project => {\r\n\t\t\tconst name = (project.name || '').toLowerCase()\r\n\t\t\tconst desc = (project.description || '').toLowerCase()\r\n\t\t\tconst folder = (project.folder_name || '').toLowerCase()\r\n\t\t\treturn name.includes(keyword) || desc.includes(keyword) || folder.includes(keyword)\r\n\t\t})\r\n\t})\r\n\r\n\t// 打开项目选择器弹窗\r\n\tfunction openProjectPicker() {\r\n\t\tif (projectList.value.length === 0) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '暂无项目，请先创建项目',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tprojectSearchKeyword.value = '' // 清空搜索\r\n\t\tprojectPickerPopup.value?.open()\r\n\t}\r\n\r\n\t// 关闭项目选择器弹窗\r\n\tfunction closeProjectPicker() {\r\n\t\tprojectPickerPopup.value?.close()\r\n\t}\r\n\r\n\t// 选择项目\r\n\tasync function selectProject(project) {\r\n\t\tselectedProjectId.value = project.id\r\n\t\tselectedProject.value = project\r\n\r\n\t\t// 保存到 uni.setStorageSync，跨平台兼容\r\n\t\ttry {\r\n\t\t\tuni.setStorageSync('acceptance_project_id', project.id)\r\n\t\t\tuni.setStorageSync('acceptance_project_info', JSON.stringify({\r\n\t\t\t\tid: project.id,\r\n\t\t\t\tname: project.name,\r\n\t\t\t\tdescription: project.description,\r\n\t\t\t\tfolder_name: project.folder_name\r\n\t\t\t}))\r\n\t\t} catch (e) {\r\n\t\t\tconsole.warn('⚠️ 保存项目选择失败:', e)\r\n\t\t}\r\n\r\n\t\t// 关闭弹窗\r\n\t\tcloseProjectPicker()\r\n\r\n\t\t// 停止之前的轮询（如果有）\r\n\t\tstopPolling()\r\n\r\n\t\t// 加载项目文件列表\r\n\t\tawait loadProjectFiles(project.id)\r\n\r\n\t\t// 加载完成后，检查是否需要启动轮询\r\n\t\tstartPollingFileStatus(project.id)\r\n\r\n\t\t// 加载该项目的缓存数据\r\n\t\tloadProjectCache(project.id)\r\n\r\n\t\t// 显示成功提示\r\n\t\tuni.showToast({\r\n\t\t\ttitle: `已选择：${project.name}`,\r\n\t\t\ticon: 'success',\r\n\t\t\tduration: 1500\r\n\t\t})\r\n\t}\r\n\r\n\t// 搜索输入处理\r\n\tfunction onSearchInput(e) {\r\n\t\t// 实时搜索，无需额外处理\r\n\t\tconsole.log('搜索关键词:', projectSearchKeyword.value)\r\n\t}\r\n\r\n\t// ========== 文件状态轮询功能 ==========\r\n\r\n\t// 检查是否有文件正在处理\r\n\tfunction hasProcessingFiles() {\r\n\t\treturn projectFiles.value.some(file =>\r\n\t\t\t!['indexed', 'failed'].includes(file.status)\r\n\t\t)\r\n\t}\r\n\r\n\t// 开始轮询文件状态\r\n\tfunction startPollingFileStatus(projectId) {\r\n\t\t// 如果没有文件在处理，不需要轮询\r\n\t\tif (!hasProcessingFiles()) {\r\n\t\t\t// console.log('✅ 所有文件已处理完成，无需轮询')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 防止重复轮询\r\n\t\tif (isPolling.value) {\r\n\t\t\tconsole.log('⚠️ 已在轮询中，跳过')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tisPolling.value = true\r\n\t\tpollingCount.value = 0\r\n\r\n\t\tconst processingCount = projectFiles.value.filter(f =>\r\n\t\t\t!['indexed', 'failed'].includes(f.status)\r\n\t\t).length\r\n\r\n\t\t// console.log(`🔄 开始轮询项目 ${projectId} 的文件状态...`)\r\n\t\t// console.log(`   还有 ${processingCount} 个文件正在处理`)\r\n\r\n\t\tpollingTimer.value = setInterval(async () => {\r\n\t\t\tpollingCount.value++\r\n\r\n\t\t\t// 超过最大次数，停止轮询\r\n\t\t\tif (pollingCount.value > MAX_POLLING_COUNT) {\r\n\t\t\t\tconsole.log('⏰ 达到最大轮询次数，停止轮询')\r\n\t\t\t\tstopPolling()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '文件处理超时，请手动刷新',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// 静默重新加载文件列表（不显示 loading）\r\n\t\t\t\tawait loadProjectFiles(projectId, true)\r\n\r\n\t\t\t\t// 检查是否所有文件都处理完成\r\n\t\t\t\tif (!hasProcessingFiles()) {\r\n\t\t\t\t\tconsole.log('✅ 所有文件处理完成，停止轮询')\r\n\t\t\t\t\tstopPolling()\r\n\r\n\t\t\t\t\t// 显示成功提示\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '文件处理完成',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 统计处理中的文件\r\n\t\t\t\t\tconst processing = projectFiles.value.filter(f =>\r\n\t\t\t\t\t\t!['indexed', 'failed'].includes(f.status)\r\n\t\t\t\t\t)\r\n\t\t\t\t\t// console.log(`🔄 [轮询 ${pollingCount.value}] 还有 ${processing.length} 个文件正在处理...`)\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('❌ 轮询文件状态失败:', error)\r\n\t\t\t\t// 不停止轮询，继续尝试\r\n\t\t\t}\r\n\t\t}, POLLING_INTERVAL)\r\n\t}\r\n\r\n\t// 停止轮询\r\n\tfunction stopPolling() {\r\n\t\tif (pollingTimer.value) {\r\n\t\t\tclearInterval(pollingTimer.value)\r\n\t\t\tpollingTimer.value = null\r\n\t\t}\r\n\t\tisPolling.value = false\r\n\t\tpollingCount.value = 0\r\n\t\t// console.log('⏹️ 轮询已停止')\r\n\t}\r\n\r\n\t// 加载项目列表\r\n\tasync function loadProjects() {\r\n\t\ttry {\r\n\t\t\tconst {\r\n\t\t\t\tgetProjects\r\n\t\t\t} = await import('@/api/project.js')\r\n\t\t\tconst response = await getProjects()\r\n\r\n\t\t\tprojectList.value = response || []\r\n\r\n\t\t\t// console.log('项目列表加载成功:', projectList.value.length, '个项目')\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('加载项目列表失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载项目列表失败',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t// 加载项目文件列表\r\n\tasync function loadProjectFiles(projectId, silent = false) {\r\n\t\ttry {\r\n\t\t\t// 非静默模式显示 loading\r\n\t\t\tif (!silent) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载文件列表...',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tconst {\r\n\t\t\t\tgetProjectDocuments\r\n\t\t\t} = await import('@/api/project.js')\r\n\t\t\tconst response = await getProjectDocuments(projectId)\r\n\r\n\t\t\t// 确保 projectFiles 始终是数组\r\n\t\t\t// 后端可能返回 { documents: [...], total: 10 } 或直接返回数组\r\n\t\t\tif (Array.isArray(response)) {\r\n\t\t\t\tprojectFiles.value = response\r\n\t\t\t} else if (response && Array.isArray(response.documents)) {\r\n\t\t\t\tprojectFiles.value = response.documents\r\n\t\t\t} else {\r\n\t\t\t\tprojectFiles.value = []\r\n\t\t\t}\r\n\r\n\t\t\t// console.log('项目文件列表:', projectFiles.value)\r\n\r\n\t\t\tif (!silent) {\r\n\t\t\t\tuni.hideLoading()\r\n\r\n\t\t\t\tif (projectFiles.value.length === 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '该项目暂无文件',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('加载项目文件失败:', error)\r\n\t\t\tif (!silent) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载文件列表失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tprojectFiles.value = [] // 确保出错时也是数组\r\n\t\t}\r\n\t}\r\n\r\n\t// 文件图标映射\r\n\tfunction getFileIcon(extension) {\r\n\t\tconst ext = (extension || '').toLowerCase().replace('.', '')\r\n\t\tconst iconMap = {\r\n\t\t\t'pdf': 'paperplane',\r\n\t\t\t'doc': 'compose',\r\n\t\t\t'docx': 'compose',\r\n\t\t\t'xls': 'bars',\r\n\t\t\t'xlsx': 'bars',\r\n\t\t\t'ppt': 'image',\r\n\t\t\t'pptx': 'image',\r\n\t\t\t'md': 'compose',\r\n\t\t\t'txt': 'compose',\r\n\t\t\t'jpg': 'image',\r\n\t\t\t'jpeg': 'image',\r\n\t\t\t'png': 'image',\r\n\t\t\t'gif': 'image'\r\n\t\t}\r\n\t\treturn iconMap[ext] || 'paperclip'\r\n\t}\r\n\r\n\t// 格式化文件大小\r\n\tfunction formatFileSize(bytes) {\r\n\t\tif (!bytes) return '0 B'\r\n\t\tconst k = 1024\r\n\t\tconst sizes = ['B', 'KB', 'MB', 'GB']\r\n\t\tconst i = Math.floor(Math.log(bytes) / Math.log(k))\r\n\t\treturn Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i]\r\n\t}\r\n\r\n\t// 格式化文件状态\r\n\tfunction formatFileStatus(status) {\r\n\t\tconst statusMap = {\r\n\t\t\t'uploaded': '已上传',\r\n\t\t\t'converting': '转换中',\r\n\t\t\t'converted': '已转换',\r\n\t\t\t'vectorizing': '向量化中',\r\n\t\t\t'indexed': '已索引',\r\n\t\t\t'failed': '处理失败'\r\n\t\t}\r\n\t\treturn statusMap[status] || status\r\n\t}\r\n\r\n\t// 获取状态文本\r\n\tfunction getStatusText(status) {\r\n\t\tconst statusMap = {\r\n\t\t\t'uploaded': '已上传',\r\n\t\t\t'converting': '转换中',\r\n\t\t\t'converted': '已转换',\r\n\t\t\t'vectorizing': '处理中',\r\n\t\t\t'indexed': '✓ 已就绪',\r\n\t\t\t'failed': '失败'\r\n\t\t}\r\n\t\treturn statusMap[status] || status\r\n\t}\r\n\r\n\t// 获取状态样式类\r\n\tfunction getStatusClass(status) {\r\n\t\tconst classMap = {\r\n\t\t\t'uploaded': 'status-uploaded',\r\n\t\t\t'converting': 'status-processing',\r\n\t\t\t'converted': 'status-processing',\r\n\t\t\t'vectorizing': 'status-processing',\r\n\t\t\t'indexed': 'status-success',\r\n\t\t\t'failed': 'status-error'\r\n\t\t}\r\n\t\treturn classMap[status] || ''\r\n\t}\r\n\r\n\t// 加载项目缓存数据\r\n\tfunction loadProjectCache(projectId) {\r\n\t\tif (!projectId) return\r\n\r\n\t\tconst cacheKey = `project_base_info_${projectId}`\r\n\t\tconst cachedData = uni.getStorageSync(cacheKey)\r\n\r\n\t\tif (cachedData) {\r\n\t\t\ttry {\r\n\t\t\t\tbaseTable.value = JSON.parse(cachedData)\r\n\t\t\t\textractionOk.value = true\r\n\t\t\t\tconsole.log(`✅ 已加载项目 ${projectId} 的缓存数据`)\r\n\r\n\t\t\t\t// 自动提取污染治理设施到现场踏勘（从baseTable提取并保存）\r\n\t\t\t\tfieldSurveyData.extractFacilitiesFromBaseTable(projectId, baseTable.value)\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '已加载缓存数据',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('解析缓存数据失败:', error)\r\n\t\t\t\tbaseTable.value = []\r\n\t\t\t\textractionOk.value = false\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// 没有缓存，清空数据\r\n\t\t\tbaseTable.value = []\r\n\t\t\textractionOk.value = false\r\n\t\t\tconsole.log(`ℹ️ 项目 ${projectId} 暂无缓存数据`)\r\n\t\t}\r\n\t}\r\n\r\n\t// 清除当前项目的缓存\r\n\tfunction clearProjectCache() {\r\n\t\tif (!selectedProjectId.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请先选择项目',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '清除缓存',\r\n\t\t\tcontent: '确定要清除当前项目的所有缓存数据吗？清除后需要重新提取信息。',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t// 清除项目数据缓存\r\n\t\t\t\t\tconst cacheKey = `project_base_info_${selectedProjectId.value}`\r\n\t\t\t\t\tuni.removeStorageSync(cacheKey)\r\n\r\n\t\t\t\t\t// 清除项目选择缓存\r\n\t\t\t\t\tuni.removeStorageSync('acceptance_project_id')\r\n\t\t\t\t\tuni.removeStorageSync('acceptance_project_info')\r\n\r\n\t\t\t\t\t// 清空当前显示的数据\r\n\t\t\t\t\tbaseTable.value = []\r\n\t\t\t\t\tsignboard.value = {\r\n\t\t\t\t\t\tsections: []\r\n\t\t\t\t\t}\r\n\t\t\t\t\tshowSignboard.value = false\r\n\t\t\t\t\textractionOk.value = false\r\n\r\n\t\t\t\t\t// 清除项目选择\r\n\t\t\t\t\tselectedProjectId.value = null\r\n\t\t\t\t\tselectedProject.value = null\r\n\t\t\t\t\tprojectFiles.value = []\r\n\r\n\t\t\t\t\tconsole.log(`🗑️ 已清除项目缓存和选择`)\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '缓存已清除',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 页面加载时获取项目列表\r\n\tonLoad(async () => {\r\n\t\tawait loadProjects()\r\n\r\n\t\t// 尝试恢复上次选择的项目\r\n\t\ttry {\r\n\t\t\tconst savedProjectId = uni.getStorageSync('acceptance_project_id')\r\n\r\n\t\t\tif (savedProjectId) {\r\n\t\t\t\tconst project = projectList.value.find(p => p.id === savedProjectId)\r\n\r\n\t\t\t\tif (project) {\r\n\t\t\t\t\tconsole.log('🔄 恢复上次选择的项目:', project.name)\r\n\t\t\t\t\t// 自动选择该项目（不显示提示，静默恢复）\r\n\t\t\t\t\tselectedProjectId.value = project.id\r\n\t\t\t\t\tselectedProject.value = project\r\n\r\n\t\t\t\t\t// 加载项目文件列表\r\n\t\t\t\t\tawait loadProjectFiles(project.id)\r\n\r\n\t\t\t\t\t// 启动轮询\r\n\t\t\t\t\tstartPollingFileStatus(project.id)\r\n\r\n\t\t\t\t\t// 加载缓存\r\n\t\t\t\t\tloadProjectCache(project.id)\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 项目不存在，清除保存的ID\r\n\t\t\t\t\tconsole.log('⚠️ 上次选择的项目已不存在，清除缓存')\r\n\t\t\t\t\tuni.removeStorageSync('acceptance_project_id')\r\n\t\t\t\t\tuni.removeStorageSync('acceptance_project_info')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.warn('⚠️ 恢复项目选择失败:', e)\r\n\t\t}\r\n\t})\r\n\r\n\t// 页面卸载时停止轮询\r\n\tonUnmounted(() => {\r\n\t\tstopPolling()\r\n\t\tconsole.log('📄 页面卸载，清理轮询定时器')\r\n\t})\r\n\r\n\t// 监听项目切换，停止旧项目的轮询\r\n\twatch(selectedProjectId, (newId, oldId) => {\r\n\t\tif (oldId && newId !== oldId) {\r\n\t\t\tstopPolling()\r\n\t\t\tconsole.log('🔄 切换项目，停止旧项目的轮询')\r\n\t\t}\r\n\t})\r\n\r\n\tconst extracting = ref(false) // 提取状态\r\n\tconst extractError = ref('') // 提取错误状态\r\n\r\n\r\n\r\n\t/* 提取信息的进度条 - 智能平滑进度版本（使用自定义弹窗）*/\r\n\t// 进度平滑处理\r\n\tlet smoothProgressTimer = null\r\n\tlet currentDisplayProgress = 0 // 当前显示的进度\r\n\tlet targetProgress = 0 // 目标进度（后端返回的真实进度）\r\n\tlet lastTargetProgress = 0 // 上一次的目标进度（用于检测是否真的更新了）\r\n\tlet lastUpdateTime = 0 // 上次后端真正更新进度的时间\r\n\r\n\t// 平滑更新进度条（智能版 - 更新响应式变量）\r\n\tfunction updateProgressSmooth(newProgress, statusText, state = 'running') {\r\n\t\t// 检查进度是否真的变化了\r\n\t\tconst progressChanged = newProgress !== lastTargetProgress\r\n\r\n\t\t// 更新目标进度和状态\r\n\t\ttargetProgress = newProgress\r\n\t\ttaskStatusText.value = statusText\r\n\t\ttaskState.value = state\r\n\r\n\t\t// 只有进度真的变化了，才更新时间戳\r\n\t\tif (progressChanged) {\r\n\t\t\tlastUpdateTime = Date.now()\r\n\t\t\tlastTargetProgress = newProgress\r\n\t\t\tconsole.log(`[进度真实更新] ${newProgress}% - ${statusText}`)\r\n\t\t}\r\n\r\n\t\t// 如果没有平滑计时器，启动一个\r\n\t\tif (!smoothProgressTimer) {\r\n\t\t\tsmoothProgressTimer = setInterval(() => {\r\n\t\t\t\tconst now = Date.now()\r\n\t\t\t\tconst timeSinceLastUpdate = now - lastUpdateTime // 距离上次真实更新的时间（毫秒）\r\n\r\n\t\t\t\t// 🎯 核心逻辑：智能增长\r\n\t\t\t\tif (currentDisplayProgress < targetProgress) {\r\n\t\t\t\t\t// 情况1：当前进度小于目标进度，快速追赶\r\n\t\t\t\t\tconst diff = targetProgress - currentDisplayProgress\r\n\t\t\t\t\tconst step = Math.max(0.5, diff / 10) // 最小0.5%，最大差值的1/10\r\n\r\n\t\t\t\t\tcurrentDisplayProgress = Math.min(\r\n\t\t\t\t\t\tcurrentDisplayProgress + step,\r\n\t\t\t\t\t\ttargetProgress\r\n\t\t\t\t\t)\r\n\t\t\t\t} else if (currentDisplayProgress >= targetProgress && targetProgress < 100) {\r\n\t\t\t\t\t// 情况2：已经追上目标进度，但任务未完成\r\n\r\n\t\t\t\t\t// 如果后端超过5秒没更新（可能卡住了），缓慢增长给用户反馈\r\n\t\t\t\t\tif (timeSinceLastUpdate > 5000) {\r\n\t\t\t\t\t\t// 缓慢增长，但不超过目标进度+5%\r\n\t\t\t\t\t\tconst maxAllowedProgress = Math.min(targetProgress + 5, 99)\r\n\r\n\t\t\t\t\t\tif (currentDisplayProgress < maxAllowedProgress) {\r\n\t\t\t\t\t\t\t// 每次增长0.1%，非常缓慢\r\n\t\t\t\t\t\t\tcurrentDisplayProgress += 0.1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 更新弹窗显示的进度\r\n\t\t\t\ttaskProgress.value = Math.floor(currentDisplayProgress)\r\n\r\n\t\t\t\t// 如果已经达到目标且目标是100%，停止计时器\r\n\t\t\t\tif (currentDisplayProgress >= 99.9 && targetProgress >= 100) {\r\n\t\t\t\t\tclearInterval(smoothProgressTimer)\r\n\t\t\t\t\tsmoothProgressTimer = null\r\n\t\t\t\t\tcurrentDisplayProgress = 100\r\n\t\t\t\t\ttaskProgress.value = 100\r\n\t\t\t\t\ttaskState.value = 'success'\r\n\t\t\t\t\ttaskStatusText.value = '信息提取完成'\r\n\r\n\t\t\t\t\t// 1秒后关闭弹窗并显示成功提示\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\ttaskProgressModal.value?.close()\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '信息提取完成',\r\n\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\t\t\t}, 50) // 每50ms更新一次，保证平滑\r\n\t\t}\r\n\t}\r\n\r\n\t// 清理进度计时器\r\n\tfunction clearProgressTimer() {\r\n\t\tif (smoothProgressTimer) {\r\n\t\t\tclearInterval(smoothProgressTimer)\r\n\t\t\tsmoothProgressTimer = null\r\n\t\t}\r\n\t\tcurrentDisplayProgress = 0\r\n\t\ttargetProgress = 0\r\n\t\tlastTargetProgress = 0\r\n\t\tlastUpdateTime = 0\r\n\t\ttaskProgress.value = 0\r\n\t\ttaskStatusText.value = '正在初始化...'\r\n\t\ttaskState.value = 'running'\r\n\t}\r\n\r\n\t// 提取信息到项目基本表（使用自定义进度弹窗）\r\n\tasync function simulateExtract() {\r\n\t\t// 1. 前置检查：是否选择了项目\r\n\t\tif (!selectedProjectId.value) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '提示',\r\n\t\t\t\tcontent: '请先选择一个项目',\r\n\t\t\t\tshowCancel: false,\r\n\t\t\t\tconfirmText: '知道了'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 2. 检查项目是否有文件\r\n\t\tif (projectFiles.value.length === 0) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '提示',\r\n\t\t\t\tcontent: '该项目暂无文件，请先在项目管理模块上传文件',\r\n\t\t\t\tshowCancel: false,\r\n\t\t\t\tconfirmText: '知道了'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 3. 检查文件是否已索引（至少有一个文件状态为 indexed）\r\n\t\tconst hasIndexedFiles = projectFiles.value.some(file => file.status === 'indexed')\r\n\t\tif (!hasIndexedFiles) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '提示',\r\n\t\t\t\tcontent: '项目文件正在处理中，请稍后再试',\r\n\t\t\t\tshowCancel: false,\r\n\t\t\t\tconfirmText: '知道了'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\textracting.value = true // 开始提取，按钮显示loading\r\n\r\n\t\t// 2. 清理之前的进度状态\r\n\t\tclearProgressTimer()\r\n\r\n\t\t// 3. 初始化弹窗状态并打开\r\n\t\ttaskProgressTitle.value = '信息提取中'\r\n\t\ttaskProgress.value = 0\r\n\t\ttaskStatusText.value = '正在提交任务...'\r\n\t\ttaskState.value = 'pending'\r\n\t\ttaskProgressModal.value?.open()\r\n\r\n\t\ttry {\r\n\t\t\tconst result = await runTask({\r\n\t\t\t\tprojectId: selectedProjectId.value,\r\n\t\t\t\tprojectFolder: selectedProject.value.folder_name,\r\n\t\t\t\t// 进度回调函数：每次后端更新进度时调用\r\n\t\t\t\tonProgress: (progress, statusText, state) => {\r\n\t\t\t\t\t// 使用平滑进度更新（会自动更新响应式变量）\r\n\t\t\t\t\tupdateProgressSmooth(progress, statusText, state)\r\n\t\t\t\t},\r\n\t\t\t\tpollInterval: 3000, // 每3秒轮询一次\r\n\t\t\t\ttimeout: 1800000 // 30分钟超时\r\n\t\t\t})\r\n\r\n\t\t\t// 5. 任务完成，确保进度到100%\r\n\t\t\tupdateProgressSmooth(100, '任务完成', 'success')\r\n\r\n\t\t\t// 6. 数据校验：确保后端真的返回了数据\r\n\t\t\tif (result?.status !== 'success' || !result.result) {\r\n\t\t\t\tthrow new Error(result?.message || '提取失败：后端未返回有效数据')\r\n\t\t\t}\r\n\r\n\t\t\t// 7. 转换数据并填充表格（核心操作）\r\n\t\t\tbaseTable.value = transformExtractResult(result.result)\r\n\r\n\t\t\t// 8. 缓存到本地（关键！使用项目ID作为key，每个项目独立缓存）\r\n\t\t\tconst cacheKey = `project_base_info_${selectedProjectId.value}`\r\n\t\t\tuni.setStorageSync(cacheKey, JSON.stringify(baseTable.value))\r\n\t\t\tconsole.log(`✅ 项目 ${selectedProjectId.value} 的数据已缓存`)\r\n\r\n\t\t\t// 9. 自动提取污染治理设施到现场踏勘（静默填充）\r\n\t\t\tfieldSurveyData.extractFacilitiesFromPollutants(baseTable.value)\r\n\r\n\t\t\t// 10. 标记提取完成\r\n\t\t\textractionOk.value = true\r\n\r\n\t\t} catch (error) {\r\n\t\t\t// 错误时清除进度计时器并关闭弹窗\r\n\t\t\tclearProgressTimer()\r\n\t\t\ttaskProgressModal.value?.close()\r\n\r\n\t\t\t// 10. 错误分类处理，给用户看得懂的提示\r\n\t\t\tconsole.error('[Extract] 提取失败:', error)\r\n\r\n\t\t\tif (error.message.includes('超时') || error.message.includes('timeout')) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提取超时了！',\r\n\t\t\t\t\tcontent: '任务执行时间过长，可能原因：\\n1. 文档过大（建议<50MB）\\n2. 网络不稳定\\n3. 服务器繁忙\\n\\n建议稍后重试或联系管理员',\r\n\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\tconfirmText: '知道了'\r\n\t\t\t\t})\r\n\t\t\t} else if (error.message.includes('未提取到')) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提取失败',\r\n\t\t\t\t\tcontent: '文档中未找到项目信息，请检查：\\n1. 文件是否为完整的环评报告\\n2. 文件内容是否清晰可读\\n3. 文件格式是否正确',\r\n\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\tconfirmText: '知道了'\r\n\t\t\t\t})\r\n\t\t\t} else if (error.message.includes('已有任务在运行')) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '任务进行中',\r\n\t\t\t\t\tcontent: '您已有一个信息提取任务正在运行，请等待完成后再提交新任务',\r\n\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\tconfirmText: '知道了'\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提取失败',\r\n\t\t\t\t\tcontent: error.message || '无法从文档中提取项目信息，请稍后重试',\r\n\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\tconfirmText: '知道了'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\textracting.value = false // 无论成功失败，都要结束loading状态\r\n\t\t}\r\n\t}\r\n\r\n\t// 新增项目基本信息弹窗\r\n\tconst newBaseInfoPopup = ref(null)\r\n\r\n\t// 新增项目基本信息的标题\r\n\tconst newBaseInfoLabel = ref('')\r\n\r\n\t// 新增项目基本信息\r\n\tfunction openAddBase() {\r\n\t\tnewBaseInfoLabel.value = '';\r\n\t\tnewBaseInfoPopup.value?.open?.()\r\n\t}\r\n\r\n\t// 确认新增项目基本信息\r\n\tfunction confirmAddBaseInfo() {\r\n\t\tconst label = (newBaseInfoLabel.value || '').trim();\r\n\t\tif (!label) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入字段名称',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn\r\n\t\t}\r\n\t\tbaseTable.value.push({\r\n\t\t\tid: Date.now() + Math.random(),\r\n\t\t\tsection: '',\r\n\t\t\tlabel,\r\n\t\t\tvalue: '',\r\n\t\t\tsource: 'manual',\r\n\t\t\trequired: false,\r\n\t\t});\r\n\t\tnewBaseInfoPopup.value?.close?.()\r\n\t}\r\n\r\n\t// 关闭新增项目基本信息弹窗\r\n\tfunction closeBaseInfo() {\r\n\t\tnewBaseInfoPopup.value?.close?.()\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\t// 以下标识牌模块的方法-------------------------\r\n\t//展示标识牌列表\r\n\tconst showSignboard = ref(false)\r\n\r\n\t// 标识牌模块名称以及列表信息\r\n\tconst signboard = reactive({\r\n\t\tsections: [{\r\n\t\t\t\tblock: '废水',\r\n\t\t\t\titems: [{\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: ''\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tblock: '废气',\r\n\t\t\t\titems: [{\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: ''\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tblock: '噪声',\r\n\t\t\t\titems: [{\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: ''\r\n\t\t\t\t}]\r\n\t\t\t}, {\r\n\t\t\t\tblock: '危险废物',\r\n\t\t\t\titems: [{\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: ''\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t]\r\n\t})\r\n\r\n\t// 生成标识牌信息(从项目基本信息提取)\r\n\tfunction generateSignboard() {\r\n\t\tconst unitName = findBaseValue('建设单位名称') || findBaseValue('单位名称') || '';\r\n\t\tconst wfName = findBaseValue('危废名称') || findBaseValue('危废') || '';\r\n\t\tconst emissionData = baseTable.value.find(x => x.id === 'pollutants_emission')?.value;\r\n\r\n\t\tif (!emissionData || typeof emissionData !== 'object') {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '未提取到污染物信息',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 清空旧数据\r\n\t\tsignboard.sections.forEach(sec => (sec.items = []));\r\n\r\n\t\t// 辅助函数：拆分排污口编号（处理\"DA001、DA002、DA003\"这种情况）\r\n\t\tfunction splitOutletCodes(codeStr) {\r\n\t\t\tif (!codeStr) return [];\r\n\r\n\t\t\t// 无效的排污口编号列表\r\n\t\t\tconst invalidCodes = ['/', '信息待补充', ''];\r\n\r\n\t\t\treturn codeStr\r\n\t\t\t\t.split(/[、,，]/) // 按顿号、逗号分隔\r\n\t\t\t\t.map(c => c.trim()) // 去除空格\r\n\t\t\t\t.filter(c => c && !invalidCodes.includes(c)); // 过滤无效编号\r\n\t\t}\r\n\r\n\t\t// 辅助函数：按排污口编号分组并合并污染物\r\n\t\tfunction groupByOutletCode(list, blockType) {\r\n\t\t\tconst outletMap = new Map(); // key: 排污口编号, value: { pollutants: [], ...otherInfo }\r\n\r\n\t\t\tlist.forEach(item => {\r\n\t\t\t\tconst codes = splitOutletCodes(item['排污口编号']);\r\n\t\t\t\tconst pollutantName = item['污染物名称'] || '';\r\n\t\t\t\tconst wryz = item['污染因子'] || '';\r\n\r\n\t\t\t\tcodes.forEach(code => {\r\n\t\t\t\t\tif (!outletMap.has(code)) {\r\n\t\t\t\t\t\toutletMap.set(code, {\r\n\t\t\t\t\t\t\tpollutants: [],\r\n\t\t\t\t\t\t\twryz: [],\r\n\t\t\t\t\t\t\totherInfo: item // 保存其他信息（如执行标准、排放去向等）\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 合并污染物名称\r\n\t\t\t\t\tif (wryz) {\r\n\t\t\t\t\t\toutletMap.get(code).wryz.push(wryz);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\treturn outletMap;\r\n\t\t}\r\n\r\n\t\t// 废水\r\n\t\tconst waterList = emissionData['水污染物'] || [];\r\n\t\tconst waterOutlets = groupByOutletCode(waterList, '废水');\r\n\t\twaterOutlets.forEach((data, code) => {\r\n\t\t\tconst wryz = [...new Set(data.wryz)].join('、'); // 去重并合并\r\n\t\t\tsignboard.sections.find(s => s.block === '废水').items.push({\r\n\t\t\t\ttitle: '单位名称',\r\n\t\t\t\tcontent: unitName\r\n\t\t\t}, {\r\n\t\t\t\ttitle: '排放口编号',\r\n\t\t\t\tcontent: code\r\n\t\t\t}, {\r\n\t\t\t\ttitle: '污染因子',\r\n\t\t\t\tcontent: wryz\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// 废气\r\n\t\tconst gasList = emissionData['大气污染物'] || [];\r\n\t\tconst gasOutlets = groupByOutletCode(gasList, '废气');\r\n\t\tgasOutlets.forEach((data, code) => {\r\n\t\t\tconst wryz = [...new Set(data.wryz)].join('、'); // 去重并合并\r\n\t\t\tsignboard.sections.find(s => s.block === '废气').items.push({\r\n\t\t\t\ttitle: '单位名称',\r\n\t\t\t\tcontent: unitName\r\n\t\t\t}, {\r\n\t\t\t\ttitle: '排放口编号',\r\n\t\t\t\tcontent: code\r\n\t\t\t}, {\r\n\t\t\t\ttitle: '污染因子',\r\n\t\t\t\tcontent: wryz\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// 噪声\r\n\t\tconst noiseList = emissionData['噪声'] || [];\r\n\t\tconst noiseOutlets = groupByOutletCode(noiseList, '噪声');\r\n\t\tnoiseOutlets.forEach((data, code) => {\r\n\t\t\tconst wryz = [...new Set(data.wryz)].join('、'); // 去重并合并\r\n\t\t\tsignboard.sections.find(s => s.block === '噪声').items.push({\r\n\t\t\t\ttitle: '单位名称',\r\n\t\t\t\tcontent: unitName\r\n\t\t\t}, {\r\n\t\t\t\ttitle: '排放口编号',\r\n\t\t\t\tcontent: code\r\n\t\t\t}, {\r\n\t\t\t\ttitle: '污染因子',\r\n\t\t\t\tcontent: '设备噪声'\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// 英文代码 → 中文\r\n\t\tconst HAZ_MAP = {\r\n\t\t\t// 只要和原始字段里出现过的英文括号写法完全一致，都要写进去\r\n\t\t\t\"T（毒性）\": \"毒性\",\r\n\t\t\t\"T\": \"毒性\",\r\n\t\t\t\"毒性\": \"毒性\",\r\n\r\n\t\t\t\"In（感染性）\": \"感染性\",\r\n\t\t\t\"In\": \"感染性\",\r\n\t\t\t\"感染性\": \"感染性\",\r\n\r\n\t\t\t\"C（腐蚀性）\": \"腐蚀性\",\r\n\t\t\t\"C\": \"腐蚀性\",\r\n\t\t\t\"腐蚀性\": \"腐蚀性\",\r\n\r\n\t\t\t\"I（易燃性）\": \"易燃性\",\r\n\t\t\t\"I\": \"易燃性\",\r\n\t\t\t\"易燃性\": \"易燃性\",\r\n\r\n\t\t\t\"R（反应性）\": \"反应性\",\r\n\t\t\t\"R\": \"反应性\",\r\n\t\t\t\"反应性\": \"反应性\"\r\n\t\t};\r\n\t\t/**\r\n\t\t * 提取并清洗危险废物类别：只保留 HWxx\r\n\t\t * @param {string} str\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\tfunction extractHazardCodes(str) {\r\n\t\t\tif (!str) return '';\r\n\t\t\tconst set = new Set((str.match(/HW\\d+/g) || []).map(s => s.trim()));\r\n\t\t\treturn [...set].join('、');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * 提取并清洗危险特性：去英文、去重、只留中文\r\n\t\t * @param {string} str\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\tfunction extractHazardProperties(str) {\r\n\t\t\tif (!str) return '';\r\n\t\t\tconst set = new Set();\r\n\t\t\t// 统一分隔符\r\n\t\t\tconst norm = str.replace(/[、,，]/g, '/');\r\n\t\t\tnorm.split('/').forEach(s => {\r\n\t\t\t\tconst key = s.trim();\r\n\t\t\t\tif (HAZ_MAP[key]) set.add(HAZ_MAP[key]);\r\n\t\t\t});\r\n\t\t\t// 按指定顺序输出\r\n\t\t\tconst order = ['毒性', '腐蚀性', '易燃性', '反应性', '感染性'];\r\n\t\t\treturn order.filter(ch => set.has(ch)).join('、');\r\n\t\t}\r\n\r\n\t\t/* ========== 主逻辑 ========== */\r\n\t\t// 1. 拿到数组\r\n\t\tconst hwList = emissionData['危险废物'] || [];\r\n\r\n\t\t// 2. 汇总\r\n\t\tfunction collectUnique(arr, key, extractor) {\r\n\t\t\tconst set = new Set();\r\n\t\t\tarr.forEach(it => {\r\n\t\t\t\tconst raw = it[key] || '';\r\n\t\t\t\tconst cleaned = extractor ? extractor(raw) : raw.trim();\r\n\t\t\t\tif (cleaned) set.add(cleaned);\r\n\t\t\t});\r\n\t\t\treturn [...set];\r\n\t\t}\r\n\r\n\t\tconst categories = collectUnique(hwList, '危险废物类别', extractHazardCodes);\r\n\t\tconst wasteNames = collectUnique(hwList, '废物名称', s => s.trim());\r\n\t\tconst hazards = collectUnique(hwList, '危险特性', extractHazardProperties);\r\n\r\n\t\t// 3. 拼成 8 行模板\r\n\t\tconst WFItems = [{\r\n\t\t\t\ttitle: '主要成分',\r\n\t\t\t\tcontent: categories.join('、') || 'HW49'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '化学名称',\r\n\t\t\t\tcontent: wasteNames.join('、') || '实验室废弃物、实验室废水污泥、医疗废物、废活性炭'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '危险情况',\r\n\t\t\t\tcontent: hazards.join('、') || '毒性、腐蚀性'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '安全措施',\r\n\t\t\t\tcontent: '接触时佩戴个人防护用品（全面罩/丁晴手套）'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '废物产生单位',\r\n\t\t\t\tcontent: unitName\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '地址',\r\n\t\t\t\tcontent: findBaseValue('建设地点')\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '电话',\r\n\t\t\t\tcontent: findBaseValue('联系方式')\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '联系人',\r\n\t\t\t\tcontent: findBaseValue('单位联系人')\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\t// 4. 写入看板\r\n\t\tsignboard.sections.find(s => s.block === '危险废物').items = WFItems;\r\n\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '已生成标识牌',\r\n\t\t\ticon: 'success'\r\n\t\t});\r\n\t}\r\n\r\n\t// 添加一组（3 项）排污标识牌（只允许噪声新增）\r\n\tfunction addSignItem(sectionIdx) {\r\n\t\tconst sec = signboard.sections[sectionIdx];\r\n\t\tconst block = sec.block; // 废水 / 废气 / 噪声\r\n\t\tconst unitName = findBaseValue('建设单位名称') || findBaseValue('单位名称') || '';\r\n\r\n\t\t// 只允许噪声新增\r\n\t\tif (block !== '噪声') {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '只有噪声可以手动新增',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t/* 计算下一个排放口编号：找到现有编号的最大值 + 1 */\r\n\t\tlet maxNum = 0;\r\n\t\t// 每3项为一组，提取所有排放口编号\r\n\t\tfor (let i = 0; i < sec.items.length; i += 3) {\r\n\t\t\tconst codeItem = sec.items[i + 1]; // 第2项是排放口编号\r\n\t\t\tif (codeItem && codeItem.title === '排放口编号') {\r\n\t\t\t\tconst code = codeItem.content || '';\r\n\t\t\t\t// 提取编号中的数字部分（如 ZS-01 -> 1, DW001 -> 1）\r\n\t\t\t\tconst match = code.match(/\\d+/);\r\n\t\t\t\tif (match) {\r\n\t\t\t\t\tconst num = parseInt(match[0], 10);\r\n\t\t\t\t\tif (num > maxNum) maxNum = num;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 生成新编号\r\n\t\tlet code = '';\r\n\t\tif (block === '废水') code = `DW${String(maxNum + 1).padStart(3,'0')}`;\r\n\t\telse if (block === '废气') code = `DA${String(maxNum + 1).padStart(3,'0')}`;\r\n\t\telse if (block === '噪声') code = `ZS-${String(maxNum + 1).padStart(2,'0')}`;\r\n\r\n\t\t/* 组装一组 */\r\n\t\tconst group = [{\r\n\t\t\t\ttitle: '单位名称',\r\n\t\t\t\tcontent: unitName\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '排放口编号',\r\n\t\t\t\tcontent: code\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: '污染因子',\r\n\t\t\t\tcontent: '设备噪声'\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\t/* 追加到当前块 */\r\n\t\tsec.items.push(...group);\r\n\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '已添加新排污口',\r\n\t\t\ticon: 'success'\r\n\t\t});\r\n\t}\r\n\r\n\t// 按块决定是否 3 条一组\r\n\tfunction groupItems(items, block) {\r\n\t\tif (block === '危险废物') return [items]; // 整包\r\n\t\tconst groups = [];\r\n\t\tfor (let i = 0; i < items.length; i += 3) {\r\n\t\t\tgroups.push(items.slice(i, i + 3));\r\n\t\t}\r\n\t\treturn groups;\r\n\t}\r\n\r\n\t// 删除指定组标识牌信息（3 条）\r\n\tfunction removeGroup(section, groupIndex) {\r\n\t\t// 取本组排放口编号用于提示\r\n\t\tconst start = groupIndex * 3;\r\n\t\tconst codeItem = section.items.slice(start, start + 3)\r\n\t\t\t.find(it => it.title === '排放口编号');\r\n\t\tconst code = codeItem?.content || '未知编号';\r\n\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '永久删除',\r\n\t\t\tcontent: `确定删除排污口  ${code}  所有信息吗？`,\r\n\t\t\tconfirmText: '确定',\r\n\t\t\tcancelText: '取消',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\tsection.items.splice(start, 3);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// 从baseTable中提取基本信息\r\n\tfunction findBaseValue(label) {\r\n\t\tconst r = baseTable.value.find(x => x.label === label);\r\n\t\treturn r ? (r.value || '') : ''\r\n\t\tconsole.log(\"baseinfo\", baseTable.value)\r\n\t}\r\n\r\n\t// 标识牌下载(数据json交给后端)\r\n\tfunction downBiaoShi() {\r\n\t\t// 检查是否选择了项目\r\n\t\tif (!selectedProjectId.value) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '提示',\r\n\t\t\t\tcontent: '请先选择一个项目',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '正在生成文档…'\r\n\t\t});\r\n\t\tdownloadSignboardWord(signboard, selectedProjectId.value)\r\n\t\t\t.then(buf => {\r\n\t\t\t\tconst fileName = '排污标识牌.docx';\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tconst blob = new Blob([buf], {\r\n\t\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n\t\t\t\t});\r\n\t\t\t\tconst url = URL.createObjectURL(blob);\r\n\t\t\t\tconst a = document.createElement('a');\r\n\t\t\t\ta.href = url;\r\n\t\t\t\ta.download = '排污标识牌.docx';\r\n\t\t\t\tdocument.body.appendChild(a);\r\n\t\t\t\ta.click();\r\n\t\t\t\tdocument.body.removeChild(a);\r\n\t\t\t\tURL.revokeObjectURL(url);\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t// 微信小程序：先写临时文件再打开预览\r\n\t\t\t\tconst filePath = `${wx.env.USER_DATA_PATH}/${fileName}`;\r\n\t\t\t\twx.getFileSystemManager().writeFile({\r\n\t\t\t\t\tfilePath,\r\n\t\t\t\t\tdata: buf,\r\n\t\t\t\t\tencoding: 'binary',\r\n\t\t\t\t\tsuccess: () => wx.openDocument({\r\n\t\t\t\t\t\tfilePath,\r\n\t\t\t\t\t\tfileType: 'docx'\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tfail: e => uni.showToast({\r\n\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t// App 端：保存到 downloads 目录\r\n\t\t\t\tplus.io.requestFileSystem(plus.io.PUBLIC_DOWNLOADS, fs => {\r\n\t\t\t\t\tconst fileEntry = fs.root.getFile(fileName, {\r\n\t\t\t\t\t\tcreate: true\r\n\t\t\t\t\t}, entry => {\r\n\t\t\t\t\t\tentry.createWriter(writer => {\r\n\t\t\t\t\t\t\twriter.write(buf);\r\n\t\t\t\t\t\t\twriter.onwrite = () => uni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '已保存到下载目录'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\tcontent: err.message || '生成失败',\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.finally(() => uni.hideLoading());\r\n\t}\r\n\r\n\r\n\t// 以下监测方案模块的方法-------------------------\r\n\tconst plan = ref(false)\r\n\tconst canDownload = ref(false) // 是否已生成监测方案\r\n\r\n\t// 生成监测方案\r\n\tasync function saveMonitorPlan() {\r\n\t\tif (!selectedProjectId.value) return uni.showModal({\r\n\t\t\ttitle: '提示',\r\n\t\t\tcontent: '请先选择项目',\r\n\t\t\tshowCancel: false\r\n\t\t})\r\n\t\tif (!extractionOk.value) return uni.showModal({\r\n\t\t\ttitle: '提示',\r\n\t\t\tcontent: '请先提取项目信息',\r\n\t\t\tshowCancel: false\r\n\t\t})\r\n\r\n\t\tclearProgressTimer()\r\n\t\ttaskProgressTitle.value = '监测方案生成中'\r\n\t\ttaskProgress.value = 0\r\n\t\ttaskState.value = 'pending'\r\n\t\ttaskProgressModal.value?.open()\r\n\r\n\t\ttry {\r\n\t\t\tawait generateMonitorPlan({\r\n\t\t\t\tprojectId: selectedProjectId.value,\r\n\t\t\t\tonProgress: (p, txt) => updateProgressSmooth(p, txt)\r\n\t\t\t})\r\n\t\t\t// 生成完只开下载权限\r\n\t\t\tcanDownload.value = true\r\n\t\t\ttaskProgressModal.value?.close()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '生成成功，可下载报告',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t\tplan.value = true\r\n\t\t} catch (e) {\r\n\t\t\tclearProgressTimer()\r\n\t\t\ttaskProgressModal.value?.close()\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '生成失败',\r\n\t\t\t\tcontent: e.message || '请稍后重试',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 下载监测方案\r\n\tasync function downloadPlan() {\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '正在下载监测方案…',\r\n\t\t\tmask: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tconst {\r\n\t\t\t\tab,\r\n\t\t\t\tfilename\r\n\t\t\t} = await downloadMonitorPlan(selectedProjectId.value)\r\n\t\t\tawait saveArrayBuffer(ab, filename) // 各端统一保存\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '已保存：' + filename,\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t} catch (e) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '下载失败',\r\n\t\t\t\tcontent: e.message,\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 各端保存逻辑\r\n\tasync function saveArrayBuffer(arrayBuffer, filename) {\r\n\t\t// #ifdef H5\r\n\t\tconst blob = new Blob([arrayBuffer], {\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n\t\t})\r\n\t\tconst url = URL.createObjectURL(blob)\r\n\t\tconst a = document.createElement('a')\r\n\t\ta.href = url;\r\n\t\ta.download = filename\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\tdocument.body.removeChild(a)\r\n\t\tURL.revokeObjectURL(url)\r\n\t\t// #endif\r\n\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tconst fs = wx.getFileSystemManager()\r\n\t\tconst filePath = `${wx.env.USER_DATA_PATH}/${filename}`\r\n\t\tfs.writeFile({\r\n\t\t\tfilePath,\r\n\t\t\tdata: arrayBuffer,\r\n\t\t\tencoding: 'binary',\r\n\t\t\tsuccess: () => wx.openDocument({\r\n\t\t\t\tfilePath,\r\n\t\t\t\tfileType: 'docx'\r\n\t\t\t}),\r\n\t\t\tfail: () => uni.showToast({\r\n\t\t\t\ttitle: '保存失败',\r\n\t\t\t\ticon: 'error'\r\n\t\t\t})\r\n\t\t})\r\n\t\t// #endif\r\n\r\n\t\t// #ifdef APP-PLUS\r\n\t\tplus.io.requestFileSystem(plus.io.PUBLIC_DOWNLOADS, fs => {\r\n\t\t\tfs.root.getFile(filename, {\r\n\t\t\t\tcreate: true\r\n\t\t\t}, entry => {\r\n\t\t\t\tentry.createWriter(writer => {\r\n\t\t\t\t\twriter.write(arrayBuffer)\r\n\t\t\t\t\twriter.onwrite = () => uni.showToast({\r\n\t\t\t\t\t\ttitle: '已保存到下载目录'\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t\t// #endif\r\n\t}\r\n\r\n\t// 以下提资单比对的方法-------------------------\r\n\t//bywilson 获取user_id和project_id从本地缓存uni.getStorageSync\r\n\t// 获取项目ID\r\n\tconst project_id = uni.getStorageSync('acceptance_project_id')\r\n\tconst userInfoStr = uni.getStorageSync('userInfo')\r\n\tconst userInfo = userInfoStr ? JSON.parse(userInfoStr) : null\r\n\t// 获取user_id \r\n\tconst user_id = userInfo?.id || userInfo?.user_id\r\n\tconsole.log(\"test userid\", user_id)\r\n\tconsole.log(\"test project_id\", project_id)\r\n\t// 上传提资单文件\r\n\tconst eco_baseUrl = \"http://172.16.1.61:8000\"\r\n\r\n\t// 提资单数据\r\n\tconst tizidanItems = ref([])\r\n\tconst tizidanRecordMap = ref({}) // 用于存储 record_id 到前端索引的映射\r\n\r\n\r\n\t// 重置提交状态\r\n\tfunction resetSubmissionStatus(item) {\r\n\t\t// 重置主提交状态\r\n\t\titem.submitted = false\r\n\r\n\t\t// 重置各个子提交状态\r\n\t\tconst subStatusKeys = ['submitted1_1', 'submitted1_2', 'submitted3_1', 'submitted3_2', 'submitted3_3']\r\n\t\tsubStatusKeys.forEach(key => {\r\n\t\t\tif (item[key] !== undefined) {\r\n\t\t\t\titem[key] = false\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 切换\"本项目是否需要\"复选框\r\n\tasync function toggleRequired(item) {\r\n\t\tif (!item || !item.record_id) {\r\n\t\t\tconsole.error('切换复选框失败：item或record_id不存在')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// 切换状态\r\n\t\t\tconst newRequired = !item.required\r\n\t\t\titem.required = newRequired\r\n\r\n\t\t\t// 显示加载中\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '保存中...',\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\t// 调用后端接口更新数据库\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/update_require',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecord_id: item.record_id,\r\n\t\t\t\t\t\tis_require: newRequired ? 1 : 0,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('更新is_require成功:', res)\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('更新is_require失败:', err)\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200 && response.data.success) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: newRequired ? '已标记为需要' : '已标记为不需要',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 如果取消勾选，不需要清空文件，但要隐藏文件上传区域\r\n\t\t\t\t// 文件数据保留，只是隐藏显示\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.data?.message || '更新失败')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('切换复选框失败:', error)\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\t// 恢复原来的状态\r\n\t\t\titem.required = !item.required\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `保存失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t// 辅助函数：获取特定子项的 required 状态\r\n\tfunction getRequiredStatus(items, mainIndex, subType) {\r\n\t\tif (!items[mainIndex]) return false\r\n\r\n\t\tconst item = items[mainIndex]\r\n\t\tconst statusKey = `submitted${subType}`\r\n\t\treturn item[statusKey] !== undefined ? item.required : false\r\n\t}\r\n\r\n\t// 辅助函数：获取特定子项的 files\r\n\tfunction getFiles(items, mainIndex, subType) {\r\n\t\tif (!items[mainIndex]) return []\r\n\r\n\t\tconst item = items[mainIndex]\r\n\t\tconst fileKey = `files${subType}`\r\n\t\treturn item[fileKey] || []\r\n\t}\r\n\r\n\r\n\t// 辅助函数：获取特定子项的 record_id\r\n\tfunction getRecordId(items, mainIndex, subType) {\r\n\t\tif (!items[mainIndex]) return null\r\n\r\n\t\tconst item = items[mainIndex]\r\n\t\t// 对于子项，我们使用主项的 record_id\r\n\t\treturn item.record_id\r\n\t}\r\n\r\n\t// 切换\"本项目是否需要\"复选框（针对子项）\r\n\tasync function toggleRequiredForItem(items, mainIndex, subType) {\r\n\t\tconst item = items[mainIndex]\r\n\t\tif (!item || !item.record_id) {\r\n\t\t\tconsole.error('切换复选框失败：item或record_id不存在')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// 切换状态\r\n\t\t\tconst newRequired = !getRequiredStatus(items, mainIndex, subType)\r\n\r\n\t\t\t// 更新本地状态\r\n\t\t\tconst statusKey = `submitted${subType}`\r\n\t\t\tif (item[statusKey] !== undefined) {\r\n\t\t\t\t// 如果有子项状态，保持原有的 submitted 状态\r\n\t\t\t\t// 这里我们只更新 required 状态\r\n\t\t\t\tconsole.log(`切换子项 ${mainIndex}-${subType} 的required状态为:`, newRequired)\r\n\t\t\t}\r\n\r\n\t\t\t// 显示加载中\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '保存中...',\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\t// 调用后端接口更新数据库\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/update_require',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecord_id: item.record_id,\r\n\t\t\t\t\t\tis_require: newRequired ? 1 : 0,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('更新is_require成功:', res)\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('更新is_require失败:', err)\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200 && response.data.success) {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: newRequired ? '已标记为需要' : '已标记为不需要',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// 更新本地状态\r\n\t\t\t\t// 由于子项的 required 状态存储在同一个记录中，我们需要重新获取数据\r\n\t\t\t\tawait fetchTizidanData()\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.data?.message || '更新失败')\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('切换复选框失败:', error)\r\n\t\t\tuni.hideLoading()\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `保存失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 2000\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// 辅助函数：根据level1_name获取所有项目\r\n\tfunction getItemsByLevel1(level1Name) {\r\n\t\treturn tizidanItems.value.filter(item => item.level1_name === level1Name)\r\n\t}\r\n\r\n\t// 辅助函数：检查是否有指定level1_name的项目\r\n\tfunction hasItemsByLevel1(level1Name) {\r\n\t\treturn tizidanItems.value.some(item => item.level1_name === level1Name)\r\n\t}\r\n\r\n\t// 辅助函数：获取分组编号\r\n\tfunction getSectionNumber(level1Name) {\r\n\t\tconst level1Names = [\r\n\t\t\t'项目历史以来环评报告及批复',\r\n\t\t\t'项目相关环保验收资料',\r\n\t\t\t'（房地产项目提供）房地产相关证件',\r\n\t\t\t'污染治理设施设计方案',\r\n\t\t\t'厂区总平面图及各层平面图（CAD版本）',\r\n\t\t\t'厂区排水设计图（CAD版本）',\r\n\t\t\t'排污许可证',\r\n\t\t\t'排水许可证',\r\n\t\t\t'危废处置协议及相应处置资质',\r\n\t\t\t'其他需要提供的资料'\r\n\t\t]\r\n\t\treturn level1Names.indexOf(level1Name) + 1\r\n\t}\r\n\r\n\t// 辅助函数：获取项目编号\r\n\tfunction getItemNumber(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) return '1-1'\r\n\t\t\tif (level2Name.includes('批复')) return '1-2'\r\n\t\t} else if (level1Name === '项目相关环保验收资料') {\r\n\t\t\treturn '2'\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) return '3-1'\r\n\t\t\tif (level2Name.includes('规划许可证')) return '3-2'\r\n\t\t\tif (level2Name.includes('规划验收合格证')) return '3-3'\r\n\t\t} else {\r\n\t\t\treturn getSectionNumber(level1Name)\r\n\t\t}\r\n\r\n\t\treturn getSectionNumber(level1Name)\r\n\t}\r\n\r\n\t// 辅助函数：获取项目标题\r\n\tfunction getItemTitle(item) {\r\n\t\tif (item.level2_name && item.level2_name.trim()) {\r\n\t\t\treturn item.level2_name\r\n\t\t}\r\n\t\treturn item.level1_name\r\n\t}\r\n\r\n\t// 辅助函数：获取项目文件\r\n\tfunction getItemFiles(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\t// 处理特殊子项的文件\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) {\r\n\t\t\t\treturn item.files1_1 || []\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('批复')) {\r\n\t\t\t\treturn item.files1_2 || []\r\n\t\t\t}\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) {\r\n\t\t\t\treturn item.files3_1 || []\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划许可证')) {\r\n\t\t\t\treturn item.files3_2 || []\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划验收合格证')) {\r\n\t\t\t\treturn item.files3_3 || []\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 默认返回主文件列表\r\n\t\treturn item.files || []\r\n\t}\r\n\r\n\t// 辅助函数：获取文件键名\r\n\tfunction getFileKey(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) return '1_1'\r\n\t\t\tif (level2Name.includes('批复')) return '1_2'\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) return '3_1'\r\n\t\t\tif (level2Name.includes('规划许可证')) return '3_2'\r\n\t\t\tif (level2Name.includes('规划验收合格证')) return '3_3'\r\n\t\t}\r\n\r\n\t\treturn null\r\n\t}\r\n\r\n\t// 辅助函数：获取提交状态\r\n\tfunction getSubmittedStatus(item) {\r\n\t\tconst level1Name = item.level1_name\r\n\t\tconst level2Name = item.level2_name || ''\r\n\r\n\t\tif (level1Name === '项目历史以来环评报告及批复') {\r\n\t\t\tif (level2Name.includes('环评报告')) {\r\n\t\t\t\treturn item.submitted1_1 || false\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('批复')) {\r\n\t\t\t\treturn item.submitted1_2 || false\r\n\t\t\t}\r\n\t\t} else if (level1Name === '（房地产项目提供）房地产相关证件') {\r\n\t\t\tif (level2Name.includes('施工证')) {\r\n\t\t\t\treturn item.submitted3_1 || false\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划许可证')) {\r\n\t\t\t\treturn item.submitted3_2 || false\r\n\t\t\t}\r\n\t\t\tif (level2Name.includes('规划验收合格证')) {\r\n\t\t\t\treturn item.submitted3_3 || false\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn item.submitted || false\r\n\t}\r\n\r\n\t// 修改上传文件函数，支持子项类型\r\n\tasync function uploadTizidanFile(recordId, subType = null) {\r\n\t\tif (!recordId) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '记录ID不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 选择多个文件\r\n\t\tuni.chooseFile({\r\n\t\t\tcount: 9,\r\n\t\t\textension: ['.doc', '.docx', '.pdf', '.xls', '.xlsx', '.png', '.jpg', '.jpeg', '.zip', '.rar',\r\n\t\t\t\t'.dwg', '.dxf'\r\n\t\t\t],\r\n\t\t\tsuccess: async (chooseRes) => {\r\n\t\t\t\tconst tempFiles = chooseRes.tempFiles\r\n\r\n\t\t\t\t// 逐个上传文件\r\n\t\t\t\tfor (let i = 0; i < tempFiles.length; i++) {\r\n\t\t\t\t\tawait uploadSingleFile(recordId, subType, tempFiles[i])\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 重新加载数据\r\n\t\t\t\tawait fetchTizidanData()\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: `已成功上传${tempFiles.length}个文件`,\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 3000\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tfail: (err) => {\r\n\t\t\t\tconsole.error('选择文件失败:', err)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '选择文件失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 修改删除文件函数，支持子项类型\r\n\tasync function deleteTizidanFile(recordId, subType, fileIndex) {\r\n\t\t// 从当前数据中查找项目\r\n\t\tconst item = tizidanItems.value.find(item => item.record_id === recordId)\r\n\t\tif (!item) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '记录不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 获取文件列表\r\n\t\tconst files = getItemFiles(item)\r\n\t\tif (fileIndex >= files.length) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '文件不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst fileName = files[fileIndex].name\r\n\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '确认删除',\r\n\t\t\tcontent: `确定要删除文件 \"${fileName}\" 吗？删除后不可恢复。`,\r\n\t\t\tsuccess: async (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t// 调用后端删除接口\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle: '删除中...'\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\turl: eco_baseUrl +\r\n\t\t\t\t\t\t\t\t\t'/api/v1/completion/tzdDetail/delete_file_by_id',\r\n\t\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\trecord_id: recordId,\r\n\t\t\t\t\t\t\t\t\tfile_name: fileName,\r\n\t\t\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tsuccess: (res) => resolve(res),\r\n\t\t\t\t\t\t\t\tfail: (err) => reject(err)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tif (response.statusCode === 200 && response.data.success) {\r\n\t\t\t\t\t\t\t// 重新加载数据\r\n\t\t\t\t\t\t\tawait fetchTizidanData()\r\n\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '文件删除成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthrow new Error(response.data?.message || '删除失败')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.error('删除文件失败:', error)\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: `删除失败: ${error.message}`,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} finally {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 获取提资单数据时，确保正确处理子项数据\r\n\tasync function fetchTizidanData() {\r\n\t\ttry {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '加载中...'\r\n\t\t\t})\r\n\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/datasheet',\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log('请求成功:', res)\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log('请求失败:', err)\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response && response.statusCode === 200) {\r\n\t\t\t\tconst data = response.data\r\n\r\n\t\t\t\tif (!data.items || !Array.isArray(data.items)) {\r\n\t\t\t\t\tthrow new Error('数据格式不正确: items 不存在或不是数组')\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 直接使用后端返回的数据\r\n\t\t\t\ttizidanItems.value = data.items\r\n\r\n\t\t\t\tconsole.log('提资单数据加载完成:', tizidanItems.value)\r\n\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '数据加载成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(`请求失败，状态码：${response?.statusCode || '未知'}`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('获取提资单数据失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载失败，请重新刷新！',\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t\ttizidanItems.value = []\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t// 上传单个文件\r\n\tasync function uploadSingleFile(recordId, subType, file) {\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '上传文件中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\t// 使用 record_id 进行上传\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/upload_file_by_id',\r\n\t\t\t\t\tfilePath: file.path,\r\n\t\t\t\t\tname: 'file',\r\n\t\t\t\t\tformData: {\r\n\t\t\t\t\t\trecord_id: recordId,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (uploadRes) => {\r\n\t\t\t\t\t\tif (uploadRes.statusCode === 200) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tconst data = JSON.parse(uploadRes.data)\r\n\t\t\t\t\t\t\t\tresolve(data)\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\treject(new Error('解析响应失败'))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject(new Error(`上传失败，状态码：${uploadRes.statusCode}`))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\treject(new Error('网络请求失败'))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (!response.success) {\r\n\t\t\t\tthrow new Error(response.message || '文件上传失败')\r\n\t\t\t}\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`文件上传失败:`, error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `文件上传失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t// 提交其他需要提供的资料\r\n\tasync function submitOtherMaterials(recordId) {\r\n\t\t// 找到对应的项目\r\n\t\tconst itemIndex = tizidanItems.value.findIndex(item => item.record_id === recordId)\r\n\t\tif (itemIndex === -1) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '项目不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst item = tizidanItems.value[itemIndex]\r\n\t\tconst memoContent = item.customText || ''\r\n\r\n\t\tif (!memoContent.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入其他需要提供的资料',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '提交中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await new Promise((resolve, reject) => {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: eco_baseUrl + '/api/v1/completion/tzdDetail/update_memo',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trecord_id: recordId,\r\n\t\t\t\t\t\tmemo: memoContent,\r\n\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\tproject_id: project_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => resolve(res),\r\n\t\t\t\t\tfail: (err) => reject(err)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\tconst data = response.data\r\n\t\t\t\tif (data.success) {\r\n\t\t\t\t\t// 更新前端的提交状态\r\n\t\t\t\t\titem.submitted = true\r\n\r\n\t\t\t\t\t// 更新memo字段\r\n\t\t\t\t\titem.memo = memoContent\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// 重新加载数据以确保状态同步\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tfetchTizidanData()\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(data.message || '提交失败')\r\n\t\t\t\t}\r\n\t\t\t} else if (response.statusCode === 422) {\r\n\t\t\t\t// 处理422错误\r\n\t\t\t\tconst errorData = response.data || {}\r\n\t\t\t\tlet errorMsg = '提交失败: 数据格式错误'\r\n\t\t\t\tif (errorData.detail) {\r\n\t\t\t\t\t// FastAPI返回的422错误详情\r\n\t\t\t\t\tif (Array.isArray(errorData.detail)) {\r\n\t\t\t\t\t\terrorMsg = errorData.detail.map(d => d.msg).join('; ')\r\n\t\t\t\t\t} else if (typeof errorData.detail === 'string') {\r\n\t\t\t\t\t\terrorMsg = errorData.detail\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthrow new Error(errorMsg)\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(`服务器错误: ${response.statusCode}`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('提交失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: `提交失败: ${error.message}`,\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t// 提资单数据\r\n\tconst downloadUrls = ref({\r\n\t\tTiZiDan_Doc: '',\r\n\t\tcomparison_list: ''\r\n\t})\r\n\r\n\r\n\t// 检查所有文件是否为空\r\n\tfunction areAllFilesEmpty(item) {\r\n\t\t// 检查主文件列表\r\n\t\tif (item.files && item.files.length > 0) return false\r\n\r\n\t\t// 检查各个子文件列表\r\n\t\tconst subFileKeys = ['files1_1', 'files1_2', 'files3_1', 'files3_2', 'files3_3']\r\n\t\tfor (const key of subFileKeys) {\r\n\t\t\tif (item[key] && item[key].length > 0) return false\r\n\t\t}\r\n\r\n\t\treturn true\r\n\t}\r\n\r\n\r\n\r\n\t// 下载验收报告提资单\r\n\tasync function downloadTizidanFile() {\r\n\t\tif (!selectedProjectId.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请先选择项目',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\r\n\t\t// 显示下载中提示\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '正在生成文档…',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\r\n\t\ttry {\r\n\t\t\t// 调用后端下载接口\r\n\t\t\tconst url =\r\n\t\t\t\teco_baseUrl +\r\n\t\t\t\t`/api/v1/completion/tzdDetail/download_tzd_doc?user_id=${user_id}&project_id=${project_id}`\r\n\r\n\t\t\t// #ifdef H5\r\n\t\t\t// H5环境：直接打开链接\r\n\t\t\twindow.open(url, '_blank')\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序环境：使用uni.downloadFile\r\n\t\t\tconst downloadTask = uni.downloadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\tconst filePath = res.tempFilePath\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: filePath,\r\n\t\t\t\t\t\t\tsuccess: (saveRes) => {\r\n\t\t\t\t\t\t\t\tconsole.log('文件保存成功:', saveRes.savedFilePath)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '文件已保存',\r\n\t\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: (saveErr) => {\r\n\t\t\t\t\t\t\t\tconsole.error('保存文件失败:', saveErr)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(`下载失败，状态码: ${res.statusCode}`)\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tthrow new Error('下载请求失败: ' + (err.errMsg || '未知错误'))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t// App环境：使用plus.downloader\r\n\t\t\tconst dtask = plus.downloader.createDownload(url, {}, (d, status) => {\r\n\t\t\t\tif (status == 200) {\r\n\t\t\t\t\tconsole.log('下载成功：' + d.filename)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '下载成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('下载失败：' + status)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '下载失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tdtask.start()\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '开始下载',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('下载失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载失败: ' + (error.message || '未知错误'),\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tuni.hideLoading()\r\n\t\t}\r\n\t}\r\n\r\n\t//by wilson 提资单代码在这里结束\r\n\r\n\t// 添加URL格式化函数，确保URL格式正确\r\n\tfunction formatDownloadUrl(url) {\r\n\t\tif (!url) return ''\r\n\r\n\t\t// 如果URL是相对路径，添加基础URL\r\n\t\tif (url.startsWith('/')) {\r\n\t\t\treturn `{eco_baseUrl}${url}`\r\n\t\t}\r\n\r\n\t\t// 如果URL已经是完整路径，直接返回\r\n\t\tif (url.startsWith('http://') || url.startsWith('https://')) {\r\n\t\t\treturn url\r\n\t\t}\r\n\t\treturn url\r\n\t}\r\n\r\n\r\n\t// 修改下载文件函数，适配不同平台\r\n\tasync function downloadFile(url, filename) {\r\n\t\tif (!url) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载链接不存在',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// 显示下载中提示\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '下载中...',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\t// #ifdef H5\r\n\t\t\t// H5环境：使用a标签下载\r\n\t\t\tawait downloadFileH5(url, filename)\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序环境\r\n\t\t\tawait downloadFileWechat(url, filename)\r\n\t\t\t// #endif\r\n\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t// App环境\r\n\t\t\tawait downloadFileApp(url, filename)\r\n\t\t\t// #endif\r\n\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载成功',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tconsole.error('下载失败:', error)\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '下载失败: ' + (error.message || '未知错误'),\r\n\t\t\t\ticon: 'none',\r\n\t\t\t\tduration: 3000\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// H5环境下载\r\n\tfunction downloadFileH5(url, filename) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst a = document.createElement('a')\r\n\t\t\t\ta.href = url\r\n\t\t\t\ta.download = filename || 'download'\r\n\t\t\t\ta.style.display = 'none'\r\n\r\n\t\t\t\tdocument.body.appendChild(a)\r\n\t\t\t\ta.click()\r\n\t\t\t\tdocument.body.removeChild(a)\r\n\r\n\t\t\t\t// H5下载无法准确判断是否成功，延迟一下再resolve\r\n\t\t\t\tsetTimeout(resolve, 1000)\r\n\t\t\t} catch (error) {\r\n\t\t\t\treject(error)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// 微信小程序环境下载\r\n\tfunction downloadFileWechat(url, filename) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tuni.downloadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t// 下载成功，保存到本地\r\n\t\t\t\t\t\tconst filePath = res.tempFilePath\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: filePath,\r\n\t\t\t\t\t\t\tsuccess: (saveRes) => {\r\n\t\t\t\t\t\t\t\tconsole.log('文件保存成功:', saveRes.savedFilePath)\r\n\t\t\t\t\t\t\t\tresolve(saveRes)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: (saveErr) => {\r\n\t\t\t\t\t\t\t\treject(new Error('保存文件失败: ' + (saveErr.errMsg || '未知错误')))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error(`下载失败，状态码: ${res.statusCode}`))\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\treject(new Error('下载请求失败: ' + (err.errMsg || '未知错误')))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\t// App环境下载\r\n\tfunction downloadFileApp(url, filename) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tuni.downloadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t// 在App中，下载的文件会保存到系统下载目录\r\n\t\t\t\t\t\t// 可以提示用户查看下载目录\r\n\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error(`下载失败，状态码: ${res.statusCode}`))\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\treject(new Error('下载请求失败: ' + (err.errMsg || '未知错误')))\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\r\n\t// 监听步骤变化\r\n\twatch(currentStep, (newVal) => {\r\n\t\tif (newVal === 2) {\r\n\t\t\t// 进入提资单比对步骤时获取数据\r\n\t\t\tfetchTizidanData()\r\n\t\t}\r\n\t})\r\n\r\n\tconst baseTable = ref([])\r\n\tconst datasheet = ref([])\r\n\r\n\r\n\t// 选择删除模式\r\n\tconst selectMode = ref(false)\r\n\tconst selectedIds = ref([])\r\n\r\n\tfunction toggleSelectMode() {\r\n\t\tselectMode.value = !selectMode.value;\r\n\t\tif (!selectMode.value) selectedIds.value = []\r\n\t}\r\n\r\n\tfunction toggleSelected(id) {\r\n\t\tconst arr = selectedIds.value;\r\n\t\tconst i = arr.indexOf(id);\r\n\t\tif (i >= 0) arr.splice(i, 1);\r\n\t\telse arr.push(id)\r\n\t}\r\n\r\n\tfunction removeSelected() {\r\n\t\tif (!selectedIds.value.length) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '未选择',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst names = baseTable.value\r\n\t\t\t.filter(r => selectedIds.value.includes(r.id))\r\n\t\t\t.map(r => (r.label || '（未命名）').trim())\r\n\r\n\t\tconst preview =\r\n\t\t\tnames.length === 1 ?\r\n\t\t\t`确认要删除「${names[0]}」吗？` :\r\n\t\t\t(() => {\r\n\t\t\t\tconst max = 8\r\n\t\t\t\tconst head = names.slice(0, max).map(n => `• ${n}`).join('\\n')\r\n\t\t\t\tconst tail = names.length > max ? `\\n… 等 ${names.length} 项` : ''\r\n\t\t\t\treturn `确认要删除以下 ${names.length} 个信息吗？\\n${head}${tail}`\r\n\t\t\t})()\r\n\r\n\t\tuni.showModal({\r\n\t\t\ttitle: '确认删除',\r\n\t\t\tcontent: preview,\r\n\t\t\tconfirmText: '删除',\r\n\t\t\tcancelText: '取消',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\tbaseTable.value = baseTable.value.filter(\r\n\t\t\t\t\t\tr => !selectedIds.value.includes(r.id)\r\n\t\t\t\t\t)\r\n\t\t\t\t\tselectedIds.value = []\r\n\t\t\t\t\tselectMode.value = false\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `已删除 ${names.length} 项`,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\r\n\t// 以下现场踏勘比对的方法-------------------------\r\n\t// 现场踏勘模块已拆分到独立组件，使用 useFieldSurveyData composable 管理状态\r\n\tconst fieldSurveyData = useFieldSurveyData()\r\n\r\n\r\n\t// 以下是竣工验收报告的方法-------------------------\r\n\tconst reportType = ref('withoutData')\r\n\tconst testReportFiles = ref([])\r\n\tconst canDownloadReport = ref(false) // 是否已生成竣工验收报告\r\n\tconst previewTitle = ref(\"\")\r\n\r\n\t//选择有无监测方案报告\r\n\tconst reportGenerated = ref(false)\r\n\tconst reportTypes = [{\r\n\t\t\tvalue: 'withoutData',\r\n\t\t\ttext: '无检测数据报告'\r\n\t\t},\r\n\t\t{\r\n\t\t\tvalue: 'withData',\r\n\t\t\ttext: '有检测数据报告'\r\n\t\t}\r\n\t]\r\n\r\n\t// 切换报告类型\r\n\tfunction onReportTypeChange(e) {\r\n\t\treportType.value = e.detail.value\r\n\t}\r\n\r\n\t// 生成竣工验收报告\r\n\tasync function generateAcceptanceReport() {\r\n\t\tif (!selectedProjectId.value) return uni.showModal({\r\n\t\t\ttitle: '提示',\r\n\t\t\tcontent: '请先选择项目',\r\n\t\t\tshowCancel: false\r\n\t\t})\r\n\t\tif (!extractionOk.value) return uni.showModal({\r\n\t\t\ttitle: '提示',\r\n\t\t\tcontent: '请先提取项目信息',\r\n\t\t\tshowCancel: false\r\n\t\t})\r\n\t\tif (reportType.value === 'withData' && !testReportFiles.value.length) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '有监测数据报告，必须要先上传监测报告',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tclearProgressTimer()\r\n\t\ttaskProgressTitle.value = '竣工验收报告生成中'\r\n\t\ttaskProgress.value = 0\r\n\t\ttaskState.value = 'pending'\r\n\t\ttaskProgressModal.value?.open()\r\n\r\n\t\ttry {\r\n\t\t\tawait generateReport({\r\n\t\t\t\tprojectId: selectedProjectId.value,\r\n\t\t\t\tonProgress: (p, txt) => updateProgressSmooth(p, txt)\r\n\t\t\t})\r\n\t\t\t// 生成完只开下载权限\r\n\t\t\tcanDownloadReport.value = true\r\n\t\t\ttaskProgressModal.value?.close()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '生成成功，可下载报告',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t\tpreviewTitle.value = '无监测数据的竣工验收报告已生成，请点击下载！'\r\n\t\t\treportGenerated.value = true\r\n\t\t} catch (e) {\r\n\t\t\tclearProgressTimer()\r\n\t\t\ttaskProgressModal.value?.close()\r\n\r\n\t\t\t// 先把后端返回的完整错误打印出来\r\n\t\t\tconsole.error('生成报告失败', e, e.response?.data)\r\n\r\n\t\t\t// 只取人类可读部分\r\n\t\t\tlet msg = e.message || '请稍后重试'\r\n\t\t\tif (Array.isArray(e.response?.data?.detail)) {\r\n\t\t\t\t// FastAPI 422 默认返回 {detail:[{loc:[],msg:'xxx',type:''},...]}\r\n\t\t\t\tmsg = e.response.data.detail.map(d => d.msg).join('；')\r\n\t\t\t} else if (typeof e.response?.data === 'string') {\r\n\t\t\t\tmsg = e.response.data\r\n\t\t\t}\r\n\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '生成失败',\r\n\t\t\t\tcontent: msg,\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t// 下载监测方案\r\n\tasync function downAcceptanceReport() {\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: '正在竣工验收报告…',\r\n\t\t\tmask: true\r\n\t\t})\r\n\t\ttry {\r\n\t\t\tconst {\r\n\t\t\t\tab,\r\n\t\t\t\tfilename\r\n\t\t\t} = await downloadReport(selectedProjectId.value)\r\n\t\t\tawait saveArrayBuffer(ab, filename) // 各端统一保存\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '已保存：' + filename,\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t} catch (e) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '下载失败',\r\n\t\t\t\tcontent: e.message,\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t/* ========== 设计令牌（统一风格） ========== */\r\n\t$brand: #166534; // 主色（深绿）\r\n\t$brand-600: #17834a;\r\n\t$brand-50: #ecfdf5;\r\n\t$ink: #0f172a; // 标题\r\n\t$muted: #5b6b7b; // 次文本\r\n\t$line: #e6eaf0; // 细线\r\n\t$bg: #f6f8fb; // 背景\r\n\t$white: #ffffff;\r\n\t$danger: #d92d20;\r\n\t$warning: #fb923c;\r\n\r\n\t$radius: 14rpx;\r\n\t$radius-lg: 18rpx;\r\n\t$shadow-sm: 0 2rpx 10rpx rgba(16, 24, 40, .06);\r\n\t$shadow-md: 0 6rpx 24rpx rgba(16, 24, 40, .08);\r\n\r\n\t/* ========== 页面框架 ========== */\r\n\t.acceptance-page {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: $bg;\r\n\t}\r\n\r\n\r\n\t/* 统一按钮体系 */\r\n\t.btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tpadding: 0 22rpx;\r\n\t\theight: 64rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: 500;\r\n\t\tbackground: $white;\r\n\t\tcolor: #374151;\r\n\t\ttransition: transform .12s ease, box-shadow .12s ease, background .12s ease, border-color .12s ease;\r\n\t}\r\n\r\n\t:deep(.uni-button.btn.btn--secondary::after) {\r\n\t\tborder-radius: $radius;\r\n\t}\r\n\r\n\t.btn:active {\r\n\t\ttransform: translateY(1rpx);\r\n\t}\r\n\r\n\t.btn[disabled] {\r\n\t\topacity: .6;\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.btn--primary {\r\n\t\tbackground: $brand;\r\n\t\tcolor: $white;\r\n\t\tborder-color: $brand;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(22, 101, 52, .22);\r\n\t}\r\n\r\n\t.btn--secondary {\r\n\t\tbackground: #f8fafc;\r\n\t\tcolor: #155e3b;\r\n\t\tborder-color: #dbe3ea;\r\n\t}\r\n\r\n\t.btn--ghost {\r\n\t\tbackground: $white;\r\n\t\tcolor: $muted;\r\n\t\tborder-color: #e9edf2;\r\n\t}\r\n\r\n\t.btn--danger {\r\n\t\tbackground: $danger;\r\n\t\tcolor: $white;\r\n\t\tborder-color: $danger;\r\n\t}\r\n\r\n\t.btn--danger-ghost {\r\n\t\tbackground: #fef3f2;\r\n\t\tcolor: $danger;\r\n\t\tborder-color: #fde2e1;\r\n\t}\r\n\r\n\t/* 步骤导航 */\r\n\t.acceptance-steps {\r\n\t\tbackground: $white;\r\n\t\tborder-bottom: 1rpx solid #f2f4f7;\r\n\t\tpadding: 18rpx 24rpx;\r\n\t}\r\n\r\n\t.steps-container {\r\n\t\tmax-width: 1200rpx;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t.mobile-step-select {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.desktop-steps {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.step-item {\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 14rpx 18rpx;\r\n\t\tborder-radius: $radius;\r\n\t\tborder: 1rpx solid transparent;\r\n\t\ttransition: background .2s ease, border-color .2s ease;\r\n\t}\r\n\r\n\t.step-item--active {\r\n\t\tbackground: #f3faf6;\r\n\t\tborder-color: #def7ec;\r\n\t}\r\n\r\n\t.step-item--completed .step-indicator {\r\n\t\tbackground: #10b981;\r\n\t\tcolor: $white;\r\n\t}\r\n\r\n\t.step-indicator {\r\n\t\twidth: 44rpx;\r\n\t\theight: 44rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: #eef2f6;\r\n\t\tcolor: $muted;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-size: 20rpx;\r\n\t\tfont-weight: 700;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.step-label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #344054;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.step-connector {\r\n\t\twidth: 20rpx;\r\n\t\theight: 2rpx;\r\n\t\tbackground: #e3e8ef;\r\n\t\tmargin-left: 4rpx;\r\n\t\tborder-radius: 1rpx;\r\n\t}\r\n\r\n\t/* 主体 */\r\n\t.acceptance-content {\r\n\t\tflex: 1;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tmin-height: 0;\r\n\t}\r\n\r\n\t.content-scroll {\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.content-section {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.section-card {\r\n\t\tbackground: $white;\r\n\t\tborder-radius: $radius-lg;\r\n\t\tbox-shadow: $shadow-md;\r\n\t\tborder: 1rpx solid #eef2f6;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.section-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t\tpadding: 24rpx 24rpx 0;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t\tletter-spacing: .2rpx;\r\n\t}\r\n\r\n\t.section-body {\r\n\t\tpadding: 0 24rpx 24rpx;\r\n\t}\r\n\r\n\t/* 自定义项目选择器触发按钮 */\r\n\t.project-selector {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: $white;\r\n\t\tborder: 2rpx solid #e5e7eb;\r\n\t\tborder-radius: $radius;\r\n\t\tcursor: pointer;\r\n\t\ttransition: all 0.2s ease;\r\n\t\tmin-height: 100rpx;\r\n\t}\r\n\r\n\t.project-selector:active {\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-color: $brand;\r\n\t}\r\n\r\n\t.selector-content {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.selected-project {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t}\r\n\r\n\t.project-info {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 6rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.project-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 600;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.project-desc {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.placeholder {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.placeholder-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\t/* 项目选择器弹窗样式 */\r\n\t.project-picker-modal {\r\n\t\twidth: 90vw;\r\n\t\tmax-width: 700rpx;\r\n\t\tmax-height: 80vh;\r\n\t\tbackground: $white;\r\n\t\tborder-radius: 24rpx;\r\n\t\toverflow: hidden;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tbox-shadow: 0 20rpx 60rpx rgba(0, 0, 0, 0.15);\r\n\t}\r\n\r\n\t.picker-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 32rpx 32rpx 24rpx;\r\n\t\tborder-bottom: 2rpx solid #f3f4f6;\r\n\t\tbackground: linear-gradient(135deg, #f8fafb 0%, #ffffff 100%);\r\n\t}\r\n\r\n\t.picker-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.picker-close {\r\n\t\twidth: 48rpx;\r\n\t\theight: 48rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground: #f3f4f6;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.picker-close:active {\r\n\t\tbackground: #e5e7eb;\r\n\t\ttransform: scale(0.95);\r\n\t}\r\n\r\n\t.picker-search {\r\n\t\tpadding: 24rpx 32rpx;\r\n\t\tbackground: $white;\r\n\t\tborder-bottom: 2rpx solid #f3f4f6;\r\n\t}\r\n\r\n\t.picker-stats {\r\n\t\tpadding: 16rpx 32rpx;\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-bottom: 1rpx solid #e5e7eb;\r\n\t}\r\n\r\n\t.stats-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t}\r\n\r\n\t.stats-highlight {\r\n\t\tcolor: $brand;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.picker-list {\r\n\t\tflex: 1;\r\n\t\tmin-height: 0;\r\n\t\tmax-height: 60vh;\r\n\t\tpadding: 16rpx 0;\r\n\t}\r\n\r\n\t.picker-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 20rpx;\r\n\t\tpadding: 24rpx 32rpx;\r\n\t\tmargin: 0 16rpx 12rpx;\r\n\t\tbackground: $white;\r\n\t\tborder: 2rpx solid #f3f4f6;\r\n\t\tborder-radius: 16rpx;\r\n\t\ttransition: all 0.2s ease;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.picker-item:active {\r\n\t\ttransform: translateY(-2rpx);\r\n\t\tbox-shadow: 0 8rpx 20rpx rgba(22, 101, 52, 0.08);\r\n\t}\r\n\r\n\t.picker-item--active {\r\n\t\tbackground: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);\r\n\t\tborder-color: $brand;\r\n\t\tbox-shadow: 0 4rpx 16rpx rgba(22, 101, 52, 0.12);\r\n\t}\r\n\r\n\t.picker-item-icon {\r\n\t\tflex-shrink: 0;\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground: #f3f4f6;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.picker-item--active .picker-item-icon {\r\n\t\tbackground: linear-gradient(135deg, $brand 0%, $brand-600 100%);\r\n\t}\r\n\r\n\t.picker-item--active .picker-item-icon uni-icons {\r\n\t\tcolor: $white !important;\r\n\t}\r\n\r\n\t.picker-item-content {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.picker-item-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 600;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.picker-item--active .picker-item-name {\r\n\t\tcolor: $brand;\r\n\t}\r\n\r\n\t.picker-item-desc {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.picker-item-meta {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tmargin-top: 4rpx;\r\n\t}\r\n\r\n\t.meta-text {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\t.picker-item-action {\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.selected-badge {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground: linear-gradient(135deg, $brand 0%, $brand-600 100%);\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(22, 101, 52, 0.3);\r\n\t}\r\n\r\n\t.picker-empty {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t\tpadding: 80rpx 32rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.picker-empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #64748b;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.picker-empty-tip {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\r\n\t/* 表单 */\r\n\t.form-group {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t\tmargin-bottom: 24rpx;\r\n\t}\r\n\r\n\t.form-label {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.form-tip {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t}\r\n\r\n\t.action-row {\r\n\t\tdisplay: flex;\r\n\t\tgap: 12rpx;\r\n\t\tmargin-top: 16rpx;\r\n\t}\r\n\r\n\t.section-actions {\r\n\t\tdisplay: flex;\r\n\t\tgap: 12rpx;\r\n\t\tmargin: 12rpx 0 18rpx;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\r\n\t/* 子块标题 */\r\n\t.subsection {\r\n\t\tmargin-top: 24rpx;\r\n\t\tpadding-top: 24rpx;\r\n\t\tborder-top: 1rpx solid #f1f5f9;\r\n\t}\r\n\r\n\t.subsection-head {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t\tmargin-bottom: 14rpx;\r\n\t}\r\n\r\n\t.subsection-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t/* 表格（桌面网格、移动卡片化） */\r\n\t.data-table {\r\n\t\tborder: 1rpx solid #e6ebf1;\r\n\t\tborder-radius: $radius;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.table-header {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: 120rpx 1fr 120rpx 80rpx;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-bottom: 1rpx solid #e6ebf1;\r\n\t}\r\n\r\n\t.table-header--dense {\r\n\t\tgrid-template-columns: 160rpx 1fr 140rpx 120rpx 100rpx;\r\n\t}\r\n\r\n\t.table-th {\r\n\t\tpadding: 18rpx 14rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #475569;\r\n\t\tfont-weight: 700;\r\n\t\tborder-right: 1rpx solid #e6ebf1;\r\n\t}\r\n\r\n\t.table-th:last-child {\r\n\t\tborder-right: none;\r\n\t}\r\n\r\n\t.table-body {\r\n\t\tbackground: $white;\r\n\t}\r\n\r\n\t.table-row {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: 120rpx 1fr 120rpx 80rpx;\r\n\t\tborder-bottom: 1rpx solid #f2f4f7;\r\n\t}\r\n\r\n\t.table-row:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.table-row--simple {\r\n\t\tgrid-template-columns: 1fr 100rpx;\r\n\t}\r\n\r\n\t.table-td {\r\n\t\tpadding: 16rpx 14rpx;\r\n\t\tborder-right: 1rpx solid #f7f8fa;\r\n\t\tmin-height: 76rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.table-td:last-child {\r\n\t\tborder-right: none;\r\n\t}\r\n\r\n\t.table-td--section {\r\n\t\tfont-weight: 700;\r\n\t\tcolor: #0f172a;\r\n\t}\r\n\r\n\t/* 图标按钮（表格内） */\r\n\t.icon-btn {\r\n\t\twidth: 44rpx;\r\n\t\theight: 44rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tborder: 1rpx solid #edf1f5;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground: $white;\r\n\t}\r\n\r\n\t.icon-btn:active {\r\n\t\tbackground: #f3f6fa;\r\n\t}\r\n\r\n\t/* 项目文件列表样式 */\r\n\t.file-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t\tmargin-top: 24rpx;\r\n\t}\r\n\r\n\t.file-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #f8fafb;\r\n\t\tborder-radius: 16rpx;\r\n\t\tborder: 2rpx solid #e5e9ed;\r\n\t\ttransition: all 0.2s;\r\n\t}\r\n\r\n\t.file-item:hover {\r\n\t\tbackground: #f3f6f9;\r\n\t\tborder-color: #d1dce5;\r\n\t}\r\n\r\n\t.file-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 20rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.file-details {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.file-name {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #1f2937;\r\n\t\tfont-weight: 500;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.file-meta {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #6b7280;\r\n\t}\r\n\r\n\t.file-status {\r\n\t\tflex-shrink: 0;\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\r\n\t.status-badge {\r\n\t\tdisplay: inline-block;\r\n\t\tpadding: 8rpx 20rpx;\r\n\t\tborder-radius: 24rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: 500;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t.status-uploaded {\r\n\t\tbackground: #e0f2fe;\r\n\t\tcolor: #0369a1;\r\n\t}\r\n\r\n\t.status-processing {\r\n\t\tbackground: #fef3c7;\r\n\t\tcolor: #d97706;\r\n\t}\r\n\r\n\t.status-success {\r\n\t\tbackground: #d1fae5;\r\n\t\tcolor: #065f46;\r\n\t}\r\n\r\n\t.status-error {\r\n\t\tbackground: #fee2e2;\r\n\t\tcolor: #dc2626;\r\n\t}\r\n\r\n\t/* 设施卡片列表样式 */\r\n\t.facility-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t\tmargin-top: 24rpx;\r\n\t}\r\n\r\n\t.facility-card {\r\n\t\tbackground: #ffffff;\r\n\t\tborder: 2rpx solid #e5e7eb;\r\n\t\tborder-radius: 16rpx;\r\n\t\toverflow: hidden;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t.facility-card:hover {\r\n\t\tborder-color: #16a34a;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(22, 163, 74, 0.1);\r\n\t}\r\n\r\n\t.facility-card__header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tbackground: #f0fdf4 0%;\r\n\t\tborder-bottom: 2rpx solid #bbf7d0;\r\n\t}\r\n\r\n\t.facility-card__number {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbox-shadow: 0 2rpx 8rpx rgba(22, 101, 52, 0.1);\r\n\t}\r\n\r\n\t.facility-card__number-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: #166534;\r\n\t}\r\n\r\n\t.facility-card__delete {\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder: none;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.facility-card__delete:active {\r\n\t\tbackground: #fee2e2;\r\n\t\ttransform: scale(0.95);\r\n\t}\r\n\r\n\t.facility-card__body {\r\n\t\tpadding: 32rpx 24rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 28rpx;\r\n\t}\r\n\r\n\t.facility-field {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.facility-field--half {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.facility-field-row {\r\n\t\tdisplay: flex;\r\n\t\tgap: 20rpx;\r\n\t}\r\n\r\n\t.facility-field__label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #475569;\r\n\t\tfont-weight: 600;\r\n\t\tline-height: 1.4;\r\n\t}\r\n\r\n\t.facility-field__label::before {\r\n\t\tcontent: '•';\r\n\t\tcolor: #16a34a;\r\n\t\tmargin-right: 8rpx;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.facility-field__input {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.facility-field__picker {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t/* 响应式优化 */\r\n\t@media (max-width: 768px) {\r\n\t\t.facility-field-row {\r\n\t\t\tflex-direction: column;\r\n\t\t\tgap: 28rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field--half {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\t.facility-card__body {\r\n\t\t\tpadding: 24rpx 20rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 桌面端优化 */\r\n\t@media (min-width: 768px) {\r\n\t\t.facility-list {\r\n\t\t\tdisplay: grid;\r\n\t\t\tgrid-template-columns: repeat(auto-fill, minmax(600rpx, 1fr));\r\n\t\t\tgap: 32rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card:hover {\r\n\t\t\ttransform: translateY(-4rpx);\r\n\t\t}\r\n\t}\r\n\r\n\t/* 基本信息表：响应式行 */\r\n\r\n\t.form-grid--base {\r\n\t\tdisplay: grid;\r\n\t\t// grid-template-columns: 1fr 1fr;\r\n\t\tgap: 12rpx 16rpx;\r\n\t}\r\n\r\n\t.pollutants_baseinfo_row {\r\n\t\tpadding: 14rpx;\r\n\t\tborder-bottom: 1rpx solid #e7ecf2;\r\n\t}\r\n\r\n\t.baseinfo__row {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t\tbackground: $white;\r\n\t\tborder: 1rpx solid #e7ecf2;\r\n\t\tborder-radius: $radius;\r\n\t\tpadding: 14rpx;\r\n\t}\r\n\r\n\t.form-item__row {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t\tbackground: $white;\r\n\t\tborder: 1rpx solid #e7ecf2;\r\n\t\tborder-radius: $radius;\r\n\t\tpadding: 14rpx;\r\n\t}\r\n\r\n\t.form-item__label {\r\n\t\tmin-width: 180rpx;\r\n\t\tcolor: #334155;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t/* 污染物表格样式 */\r\n\t.pollutants-container {\r\n\t\twidth: 100%;\r\n\t\tmargin-bottom: 24rpx;\r\n\t\tborder: 1rpx solid #e7ecf2;\r\n\t\tborder-radius: $radius;\r\n\t\toverflow: hidden;\r\n\t\tgrid-column: 1 / -1;\r\n\t\t/* 让表格占据整行 */\r\n\t}\r\n\r\n\t.pollutants-table {\r\n\t\twidth: 100%;\r\n\t\tbackground: #fff;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t/* 表格头部 */\r\n\t.pollutants-header {\r\n\t\tdisplay: flex;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-bottom: 1px solid #e5e7eb;\r\n\t\tfont-weight: 600;\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #374151;\r\n\t}\r\n\r\n\t/* 表格行 */\r\n\t.pollutants-row {\r\n\t\tdisplay: flex;\r\n\t\tborder-bottom: 1px solid #f3f4f6;\r\n\t}\r\n\r\n\t.pollutants-row:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t/* 表格列 */\r\n\t.pollutants-col {\r\n\t\tpadding: 20rpx 12rpx;\r\n\t\tword-break: break-word;\r\n\t\tline-height: 1.5;\r\n\t\tfont-size: 26rpx;\r\n\t\tborder-right: 1px solid #f3f4f6;\r\n\t}\r\n\r\n\t.pollutants-col:last-child {\r\n\t\tborder-right: none;\r\n\t}\r\n\r\n\t/* 列宽度分配 */\r\n\t.pollutants-col--type {\r\n\t\tflex: 0.8;\r\n\t\tmin-width: 120rpx;\r\n\t\tbackground: #f0f9ff;\r\n\t\tcolor: #0369a1;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.pollutants-col--link {\r\n\t\tflex: 1.2;\r\n\t\tmin-width: 150rpx;\r\n\t}\r\n\r\n\t.pollutants-col--name {\r\n\t\tflex: 1;\r\n\t\tmin-width: 140rpx;\r\n\t}\r\n\r\n\t.pollutants-col--measure {\r\n\t\tflex: 1.5;\r\n\t\tmin-width: 180rpx;\r\n\t}\r\n\r\n\t.pollutants-col--direction {\r\n\t\tflex: 1;\r\n\t\tmin-width: 140rpx;\r\n\t}\r\n\r\n\t.pollutants-col--standard {\r\n\t\tflex: 1.2;\r\n\t\tmin-width: 160rpx;\r\n\t}\r\n\r\n\t/* 表格选择框 */\r\n\t.pollutants-select {\r\n\t\tpadding: 20rpx;\r\n\t\tborder-top: 1px solid #e5e7eb;\r\n\t\tbackground: #fafafa;\r\n\t}\r\n\r\n\r\n\t/* 小标签的样式 */\r\n\t.extract-tag {\r\n\t\tdisplay: inline-block;\r\n\t\tmargin-left: 8px;\r\n\t\tpadding: 2px 6px;\r\n\t\tbackground-color: #52c41a;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 10px;\r\n\t\tborder-radius: 3px;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\r\n\t/* 标识牌：左侧标题输入，固定宽度以避免与值重叠 */\r\n\t.pw-ico {\r\n\t\twidth: 140rpx;\r\n\t\theight: 64rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tborder: 1rpx solid #edf1f5;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground: $white;\r\n\t\tmargin-left: -100rpx;\r\n\t\tmargin-top: 24rpx;\r\n\t}\r\n\r\n\t.pw-ico text {\r\n\t\tfont-size: 22rpx;\r\n\t}\r\n\r\n\r\n\t.form-item__title {\r\n\t\twidth: 180rpx;\r\n\t}\r\n\r\n\t.form-item__input {\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.form-item__select {\r\n\t\twidth: 56rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t/* 空状态 */\r\n\t.empty-state {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 50rpx 24rpx;\r\n\t\tcolor: #cbd5e1;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #64748b;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.empty-tip {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #9aa8b6;\r\n\t}\r\n\r\n\t/* 底部导航 */\r\n\t.acceptance-navigation {\r\n\t\tbackground: $white;\r\n\t\tborder-top: 1rpx solid $line;\r\n\t\tpadding: 18rpx 24rpx;\r\n\t\tbox-shadow: 0 -2rpx 10rpx rgba(16, 24, 40, .06);\r\n\t}\r\n\r\n\t.nav-buttons {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmax-width: 1200rpx;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t/* 弹窗 */\r\n\t.modal {\r\n\t\tbackground: $white;\r\n\t\tborder-radius: 20rpx;\r\n\t\twidth: 86vw;\r\n\t\tmax-width: 620rpx;\r\n\t\toverflow: hidden;\r\n\t\tbox-shadow: 0 18rpx 52rpx rgba(15, 23, 42, .18);\r\n\t}\r\n\r\n\t.modal-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 24rpx;\r\n\t\tborder-bottom: 1rpx solid #eff3f7;\r\n\t}\r\n\r\n\t.modal-title {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.modal-close {\r\n\t\twidth: 44rpx;\r\n\t\theight: 44rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tbackground: transparent;\r\n\t\tborder: 1rpx solid #eef2f6;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.modal-body {\r\n\t\tpadding: 24rpx;\r\n\t}\r\n\r\n\t.modal-description {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t\tmargin-bottom: 14rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\r\n\t.draft-textarea {\r\n\t\twidth: 100%;\r\n\t\tmin-height: 360rpx;\r\n\t\tpadding: 16rpx;\r\n\t\tborder: 1rpx solid #e6ebf1;\r\n\t\tborder-radius: $radius;\r\n\t\tfont-size: 26rpx;\r\n\t\tline-height: 1.5;\r\n\t\tbackground: #fafafa;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.modal-actions {\r\n\t\tdisplay: flex;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 0 24rpx 24rpx;\r\n\t\tjustify-content: flex-end;\r\n\t}\r\n\r\n\t.fieldwork-textarea {\r\n\t\twidth: 100%;\r\n\t\tmin-height: 200rpx;\r\n\t\tpadding: 16rpx;\r\n\t\tborder: 1rpx solid #e6ebf1;\r\n\t\tborder-radius: $radius;\r\n\t\tfont-size: 26rpx;\r\n\t\tline-height: 1.5;\r\n\t\tbackground: $white;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.update-confirm {\r\n\t\tpadding: 20rpx;\r\n\t\tbackground: #f8fafc;\r\n\t\tborder-radius: $radius;\r\n\t\tborder: 1rpx solid #e9edf2;\r\n\t}\r\n\r\n\t.update-label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 600;\r\n\t\tmargin-bottom: 16rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\r\n\t.update-actions {\r\n\t\tdisplay: flex;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.action-buttons {\r\n\t\tdisplay: flex;\r\n\t\tgap: 8rpx;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.report-generation {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t}\r\n\r\n\t.generation-options {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 20rpx;\r\n\t}\r\n\r\n\t.option-group {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.option-label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: $ink;\r\n\t\tfont-weight: 600;\r\n\t}\r\n\r\n\t.radio-group {\r\n\t\tdisplay: flex;\r\n\t\tgap: 24rpx;\r\n\t}\r\n\r\n\t.radio-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.radio-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $muted;\r\n\t}\r\n\r\n\t.generation-actions {\r\n\t\tdisplay: flex;\r\n\t\tgap: 12rpx;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\r\n\t.report-preview {\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #f0fdf4;\r\n\t\tborder-radius: $radius;\r\n\t\tborder: 1rpx solid #dcfce7;\r\n\t}\r\n\r\n\t.paln-preview {\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #f0fdf4;\r\n\t\tborder-radius: $radius;\r\n\t\tborder: 1rpx solid #dcfce7;\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.preview-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.preview-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: $brand;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.preview-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.preview-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #374151;\r\n\t}\r\n\r\n\t.preview-sections {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t\tpadding-left: 20rpx;\r\n\t}\r\n\r\n\t.section-item {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #475569;\r\n\t}\r\n\r\n\t/* ========== 搜索框样式 ========== */\r\n\t.search-box {\r\n\t\tmargin-bottom: 24rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground: #f8faf9;\r\n\t\tborder-radius: 12rpx;\r\n\t}\r\n\r\n\t.search-input {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.search-result-text {\r\n\t\tdisplay: block;\r\n\t\tmargin-top: 12rpx;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #166534;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t/* ========== 设施/设备卡片样式 ========== */\r\n\t.facility-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t\tmargin-top: 24rpx;\r\n\t}\r\n\r\n\t.facility-card {\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 16rpx;\r\n\t\toverflow: hidden;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t.facility-card:hover {\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(22, 101, 52, 0.12);\r\n\t\ttransform: translateY(-2rpx);\r\n\t}\r\n\r\n\t.facility-card__header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tbackground: #15803d;\r\n\t}\r\n\r\n\t.facility-card__number {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tbackground: rgba(255, 255, 255, 0.2);\r\n\t\tborder-radius: 50%;\r\n\t\tbackdrop-filter: blur(10rpx);\r\n\t}\r\n\r\n\t.facility-card__number-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #ffffff;\r\n\t}\r\n\r\n\t.facility-card__delete {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tbackground: rgba(239, 68, 68, 0.1);\r\n\t\tborder-radius: 50%;\r\n\t\tborder: none;\r\n\t\tcursor: pointer;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.facility-card__delete:hover {\r\n\t\tbackground: rgba(239, 68, 68, 0.2);\r\n\t\ttransform: scale(1.1);\r\n\t}\r\n\r\n\t.facility-card__body {\r\n\t\tpadding: 32rpx 24rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t}\r\n\r\n\t.facility-field {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.facility-field__label {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #374151;\r\n\t\tmargin-bottom: 4rpx;\r\n\t}\r\n\r\n\t.facility-field__input {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.facility-field__picker {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.facility-field-row {\r\n\t\tdisplay: flex;\r\n\t\tgap: 16rpx;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.facility-field--half {\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t/* 移动端适配 */\r\n\t@media (max-width: 768px) {\r\n\t\t.facility-list {\r\n\t\t\tgap: 20rpx;\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card {\r\n\t\t\tborder-radius: 12rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__header {\r\n\t\t\tpadding: 16rpx 20rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__number {\r\n\t\t\twidth: 48rpx;\r\n\t\t\theight: 48rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__number-text {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__delete {\r\n\t\t\twidth: 48rpx;\r\n\t\t\theight: 48rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__body {\r\n\t\t\tpadding: 24rpx 20rpx;\r\n\t\t\tgap: 20rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field {\r\n\t\t\tgap: 8rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field__label {\r\n\t\t\tfont-size: 26rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field-row {\r\n\t\t\tflex-direction: column;\r\n\t\t\tgap: 20rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field--half {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 桌面端适配 */\r\n\t@media (min-width: 961px) {\r\n\t\t.facility-list {\r\n\t\t\tdisplay: grid;\r\n\t\t\tgrid-template-columns: repeat(2, 1fr);\r\n\t\t\tgap: 32rpx;\r\n\t\t\tmargin-top: 32rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card {\r\n\t\t\tborder-radius: 20rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__header {\r\n\t\t\tpadding: 24rpx 32rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__number {\r\n\t\t\twidth: 64rpx;\r\n\t\t\theight: 64rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__number-text {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__delete {\r\n\t\t\twidth: 64rpx;\r\n\t\t\theight: 64rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__body {\r\n\t\t\tpadding: 40rpx 32rpx;\r\n\t\t\tgap: 28rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field {\r\n\t\t\tgap: 14rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field__label {\r\n\t\t\tfont-size: 30rpx;\r\n\t\t}\r\n\r\n\t\t.facility-field-row {\r\n\t\t\tgap: 20rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 超大屏幕适配 */\r\n\t@media (min-width: 1200px) {\r\n\t\t.facility-list {\r\n\t\t\tgrid-template-columns: repeat(3, 1fr);\r\n\t\t\tgap: 40rpx;\r\n\t\t}\r\n\r\n\t\t.facility-card__body {\r\n\t\t\tpadding: 48rpx 40rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* ==========wilson 提资单样式比对样式 ========== */\r\n\t/* 提资单样式 */\r\n\t.tizidan-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 24rpx;\r\n\t}\r\n\r\n\t/* 头部样式 */\r\n\t.tizidan-header {\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\r\n\t.tizidan-title {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #166534;\r\n\t\tfont-weight: 700;\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\r\n\t.tizidan-subtitle {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #64748b;\r\n\t}\r\n\r\n\t/* 项目卡片样式 */\r\n\t.tizidan-item-card {\r\n\t\tbackground: #ffffff;\r\n\t\tborder: 1rpx solid #e5e7eb;\r\n\t\tborder-radius: 12rpx;\r\n\t\tpadding: 24rpx;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.tizidan-item-card:hover {\r\n\t\tborder-color: #166534;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(22, 101, 52, 0.08);\r\n\t}\r\n\r\n\t/* 项目头部样式 */\r\n\t.tizidan-item-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.tizidan-item-left {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t\tgap: 16rpx;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.tizidan-item-number {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: #166534;\r\n\t\tmin-width: 32rpx;\r\n\t}\r\n\r\n\t.tizidan-item-content {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 8rpx;\r\n\t}\r\n\r\n\t.tizidan-item-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #1f2937;\r\n\t\tline-height: 1.4;\r\n\t}\r\n\r\n\t/* 复选框组样式 */\r\n\t.tizidan-checkbox-group {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.checkbox-label {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.checkbox-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #64748b;\r\n\t}\r\n\r\n\t/* 状态徽章 */\r\n\t.tizidan-item-status {\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\r\n\t.tizidan-status-badge {\r\n\t\tdisplay: inline-block;\r\n\t\tpadding: 6rpx 16rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tfont-size: 22rpx;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.status-submitted {\r\n\t\tbackground: #d1fae5;\r\n\t\tcolor: #065f46;\r\n\t}\r\n\r\n\t.status-unsubmitted {\r\n\t\tbackground: #fee2e2;\r\n\t\tcolor: #dc2626;\r\n\t}\r\n\r\n\t/* 禁用状态 */\r\n\t.tizidan-item-disabled {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tpadding: 16rpx;\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-radius: 8rpx;\r\n\t\tborder: 1rpx dashed #d1d5db;\r\n\t}\r\n\r\n\t.disabled-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\t/* 项目主体样式 */\r\n\t.tizidan-item-body {\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.tizidan-item-actions {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t/* 文件列表样式 */\r\n\t.tizidan-file-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.tizidan-file-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 12rpx 16rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 8rpx;\r\n\t\tborder: 1rpx solid #e5e7eb;\r\n\t}\r\n\r\n\t.tizidan-file-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.tizidan-file-name {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #374151;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.tizidan-file-size {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #9ca3af;\r\n\t\tflex-shrink: 0;\r\n\t\tmargin-left: 8rpx;\r\n\t}\r\n\r\n\t/* 其他资料输入框 */\r\n\t.tizidan-other-input {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.custom-textarea {\r\n\t\twidth: 100%;\r\n\t\tmargin-bottom: 12rpx;\r\n\t}\r\n\r\n\t/* 底部样式 */\r\n\t.tizidan-footer {\r\n\t\tmargin-top: 32rpx;\r\n\t\tpadding-top: 24rpx;\r\n\t\tborder-top: 1rpx solid #e5e7eb;\r\n\t}\r\n\r\n\t.footer-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t}\r\n\r\n\t.footer-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #64748b;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t/* 小按钮样式 */\r\n\t.btn.btn--small {\r\n\t\theight: 56rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tfont-size: 22rpx;\r\n\t\tgap: 6rpx;\r\n\t}\r\n\r\n\t.btn.btn--icon {\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tpadding: 0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground: #fef2f2;\r\n\t\tborder-color: #fee2e2;\r\n\t}\r\n\r\n\t.btn.btn--icon:active {\r\n\t\tbackground: #fee2e2;\r\n\t}\r\n\r\n\t/* 响应式设计 */\r\n\t@media (max-width: 768px) {\r\n\t\t.tizidan-item-header {\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 12rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-left {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-status {\r\n\t\t\talign-self: flex-start;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-item {\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 12rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-info {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\t.btn.btn--icon {\r\n\t\t\talign-self: flex-end;\r\n\t\t}\r\n\r\n\t\t.footer-content {\r\n\t\t\tgap: 20rpx;\r\n\t\t}\r\n\r\n\t\t.footer-text {\r\n\t\t\tfont-size: 22rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t@media (min-width: 769px) {\r\n\t\t.tizidan-container {\r\n\t\t\tmax-width: 1200rpx;\r\n\t\t\tmargin: 0 auto;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-card {\r\n\t\t\tpadding: 28rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-title {\r\n\t\t\tfont-size: 30rpx;\r\n\t\t}\r\n\r\n\t\t.footer-content {\r\n\t\t\tflex-direction: row;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\r\n\t\t.footer-text {\r\n\t\t\tflex: 1;\r\n\t\t\ttext-align: left;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 超大屏幕适配 */\r\n\t@media (min-width: 1200px) {\r\n\t\t.tizidan-item-card {\r\n\t\t\tpadding: 32rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-title {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 提资单分组样式 */\r\n\t.tizidan-section {\r\n\t\tmargin-bottom: 32rpx;\r\n\t\tborder: 1rpx solid #e5e7eb;\r\n\t\tborder-radius: 12rpx;\r\n\t\toverflow: hidden;\r\n\t\tbackground: #ffffff;\r\n\t}\r\n\r\n\t.tizidan-section-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\tbackground: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);\r\n\t\tborder-bottom: 1rpx solid #dcfce7;\r\n\t}\r\n\r\n\t.tizidan-section-number {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: #166534;\r\n\t\tmin-width: 32rpx;\r\n\t}\r\n\r\n\t.tizidan-section-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #1f2937;\r\n\t\tline-height: 1.4;\r\n\t}\r\n\r\n\t/* 子项卡片样式 */\r\n\t.tizidan-item-card {\r\n\t\tborder-top: 1rpx solid #f3f4f6;\r\n\t\tpadding: 20rpx 24rpx;\r\n\t\ttransition: all 0.2s ease;\r\n\t}\r\n\r\n\t.tizidan-item-card:hover {\r\n\t\tbackground: #f9fafb;\r\n\t}\r\n\r\n\t.tizidan-item-header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.tizidan-item-left {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t\tgap: 12rpx;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.tizidan-item-number {\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #374151;\r\n\t\tmin-width: 40rpx;\r\n\t}\r\n\r\n\t.tizidan-item-content {\r\n\t\tflex: 1;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 4rpx;\r\n\t}\r\n\r\n\t.tizidan-item-title {\r\n\t\tfont-size: 26rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #4b5563;\r\n\t\tline-height: 1.4;\r\n\t}\r\n\r\n\t/* 复选框组样式 */\r\n\t.tizidan-checkbox-group {\r\n\t\tflex-shrink: 0;\r\n\t\tmargin-left: 16rpx;\r\n\t}\r\n\r\n\t.checkbox-label {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.checkbox-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #64748b;\r\n\t\twhite-space: nowrap;\r\n\t}\r\n\r\n\t/* 项目主体样式 */\r\n\t.tizidan-item-body {\r\n\t\tmargin-top: 16rpx;\r\n\t\tpadding-top: 16rpx;\r\n\t\tborder-top: 1rpx solid #f3f4f6;\r\n\t}\r\n\r\n\t/* 文件上传区域 */\r\n\t.tizidan-item-actions {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-bottom: 16rpx;\r\n\t}\r\n\r\n\t.tizidan-file-count {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 6rpx;\r\n\t\tpadding: 6rpx 12rpx;\r\n\t\tbackground: #ecfdf5;\r\n\t\tborder-radius: 6rpx;\r\n\t}\r\n\r\n\t.file-count-text {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #166534;\r\n\t}\r\n\r\n\t/* 文件列表样式 */\r\n\t.tizidan-file-list {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 12rpx;\r\n\t}\r\n\r\n\t.tizidan-file-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 12rpx 16rpx;\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-radius: 8rpx;\r\n\t\tborder: 1rpx solid #e5e7eb;\r\n\t}\r\n\r\n\t.tizidan-file-info {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 12rpx;\r\n\t\tflex: 1;\r\n\t\tmin-width: 0;\r\n\t}\r\n\r\n\t.tizidan-file-name {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #374151;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.tizidan-file-size {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #9ca3af;\r\n\t\tflex-shrink: 0;\r\n\t\tmargin-left: 8rpx;\r\n\t}\r\n\r\n\t/* 其他资料输入框 */\r\n\t.tizidan-other-input {\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.custom-textarea {\r\n\t\twidth: 100%;\r\n\t\tmargin-bottom: 12rpx;\r\n\t}\r\n\r\n\t/* 禁用状态 */\r\n\t.tizidan-item-disabled {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 8rpx;\r\n\t\tpadding: 16rpx;\r\n\t\tbackground: #f9fafb;\r\n\t\tborder-radius: 8rpx;\r\n\t\tborder: 1rpx dashed #d1d5db;\r\n\t}\r\n\r\n\t.disabled-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #9ca3af;\r\n\t}\r\n\r\n\t/* 小按钮样式 */\r\n\t.btn.btn--small {\r\n\t\theight: 56rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tfont-size: 22rpx;\r\n\t\tgap: 6rpx;\r\n\t}\r\n\r\n\t.btn.btn--icon {\r\n\t\twidth: 56rpx;\r\n\t\theight: 56rpx;\r\n\t\tpadding: 0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground: #fef2f2;\r\n\t\tborder-color: #fee2e2;\r\n\t}\r\n\r\n\t.btn.btn--icon:active {\r\n\t\tbackground: #fee2e2;\r\n\t}\r\n\r\n\t/* 底部样式 */\r\n\t.tizidan-footer {\r\n\t\tmargin-top: 32rpx;\r\n\t\tpadding-top: 24rpx;\r\n\t\tborder-top: 1rpx solid #e5e7eb;\r\n\t}\r\n\r\n\t.footer-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tgap: 16rpx;\r\n\t}\r\n\r\n\t.footer-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #64748b;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t/* 响应式设计 */\r\n\t@media (max-width: 768px) {\r\n\t\t.tizidan-item-header {\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 12rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-item-left {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\t.tizidan-checkbox-group {\r\n\t\t\talign-self: flex-start;\r\n\t\t\tmargin-left: 0;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-item {\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: flex-start;\r\n\t\t\tgap: 12rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-file-info {\r\n\t\t\twidth: 100%;\r\n\t\t}\r\n\r\n\t\t.btn.btn--icon {\r\n\t\t\talign-self: flex-end;\r\n\t\t}\r\n\r\n\t\t.footer-content {\r\n\t\t\tgap: 20rpx;\r\n\t\t}\r\n\r\n\t\t.footer-text {\r\n\t\t\tfont-size: 22rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t@media (min-width: 769px) {\r\n\t\t.tizidan-container {\r\n\t\t\tmax-width: 1200rpx;\r\n\t\t\tmargin: 0 auto;\r\n\t\t}\r\n\r\n\t\t.tizidan-section {\r\n\t\t\tpadding: 0;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-header {\r\n\t\t\tpadding: 24rpx 32rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-title {\r\n\t\t\tfont-size: 30rpx;\r\n\t\t}\r\n\r\n\t\t.footer-content {\r\n\t\t\tflex-direction: row;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\r\n\t\t.footer-text {\r\n\t\t\tflex: 1;\r\n\t\t\ttext-align: left;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 超大屏幕适配 */\r\n\t@media (min-width: 1200px) {\r\n\t\t.tizidan-section-header {\r\n\t\t\tpadding: 28rpx 36rpx;\r\n\t\t}\r\n\r\n\t\t.tizidan-section-title {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/97247/Desktop/uni-ecoful/pages/reports/acceptance/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["navTitleStore","onShow","usePlatformInfo","ref","computed","uni","onLoad","onUnmounted","watch","runTask","transformExtractResult","reactive","code","downloadSignboardWord","wx","generateMonitorPlan","downloadMonitorPlan","item","res","useFieldSurveyData","generateReport","downloadReport"],"mappings":"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"}