{"version":3,"file":"useAcceptanceReport.js","sources":["composables/useAcceptanceReport.js"],"sourcesContent":["import { ref, computed } from 'vue'\r\nimport { generateReport as apiGenerateReport, downloadReport as apiDownloadReport } from '@/api/acceptance.js'\r\n\r\n/**\r\n * Á´£Â∑•È™åÊî∂Êä•ÂëäÁÆ°ÁêÜ Composable\r\n * ÁÆ°ÁêÜÁ´£Â∑•È™åÊî∂Êä•ÂëäÁöÑÁîüÊàê„ÄÅ‰∏ãËΩΩ„ÄÅÁºìÂ≠òÁ≠âÂäüËÉΩ\r\n */\r\n\r\n// ÂàõÂª∫Âçï‰æãÁä∂ÊÄÅÔºàÁ°Æ‰øùÊâÄÊúâÁªÑ‰ª∂ÂÖ±‰∫´Âêå‰∏Ä‰ªΩÊï∞ÊçÆÔºâ\r\nlet instance = null\r\n\r\nexport function useAcceptanceReport() {\r\n\t// Â¶ÇÊûúÂ∑≤ÁªèÂàõÂª∫ËøáÂÆû‰æãÔºåÁõ¥Êé•ËøîÂõû\r\n\tif (instance) {\r\n\t\treturn instance\r\n\t}\r\n\r\n\t// Áä∂ÊÄÅÁÆ°ÁêÜ\r\n\tconst reportGenerated = ref(false)        // Êä•ÂëäÊòØÂê¶Â∑≤ÁîüÊàê\r\n\tconst reportType = ref('withoutData')     // Êä•ÂëäÁ±ªÂûãÔºöwithoutData/withData\r\n\tconst testReportFiles = ref([])           // ÁõëÊµãÊä•ÂëäÊñá‰ª∂ÂàóË°®\r\n\tconst previewTitle = ref('')              // È¢ÑËßàÊ†áÈ¢ò\r\n\tconst isGenerating = ref(false)           // ÊòØÂê¶Ê≠£Âú®ÁîüÊàê\r\n\tconst taskProgress = ref(0)               // ÁîüÊàêËøõÂ∫¶ 0-100\r\n\tconst taskStatusText = ref('')            // ÂΩìÂâçÊ≠•È™§ÊèèËø∞\r\n\tconst taskState = ref('pending')          // ‰ªªÂä°Áä∂ÊÄÅÔºöpending/running/success/failed\r\n\r\n\t// ËÆ°ÁÆóÂ±ûÊÄß\r\n\tconst canDownloadReport = computed(() => reportGenerated.value)\r\n\r\n\t// Êä•ÂëäÁ±ªÂûãÈÄâÈ°π\r\n\tconst reportTypes = [\r\n\t\t{ value: 'withoutData', text: 'Êó†Ê£ÄÊµãÊï∞ÊçÆÊä•Âëä' },\r\n\t\t{ value: 'withData', text: 'ÊúâÊ£ÄÊµãÊï∞ÊçÆÊä•Âëä' }\r\n\t]\r\n\r\n\t// ËøõÂ∫¶Âπ≥ÊªëÂ§ÑÁêÜÂèòÈáè\r\n\tlet smoothProgressTimer = null\r\n\tlet currentDisplayProgress = 0\r\n\tlet targetProgress = 0\r\n\tlet lastTargetProgress = 0\r\n\tlet lastUpdateTime = 0\r\n\r\n\t/**\r\n\t * Âπ≥ÊªëÊõ¥Êñ∞ËøõÂ∫¶Êù°\r\n\t * @param {number} newProgress - Êñ∞ËøõÂ∫¶ÂÄº\r\n\t * @param {string} statusText - Áä∂ÊÄÅÊñáÊú¨\r\n\t * @param {string} state - ‰ªªÂä°Áä∂ÊÄÅ\r\n\t */\r\n\tfunction updateProgressSmooth(newProgress, statusText, state = 'running') {\r\n\t\tconst progressChanged = newProgress !== lastTargetProgress\r\n\r\n\t\ttargetProgress = newProgress\r\n\t\ttaskStatusText.value = statusText\r\n\t\ttaskState.value = state\r\n\r\n\t\tif (progressChanged) {\r\n\t\t\tlastUpdateTime = Date.now()\r\n\t\t\tlastTargetProgress = newProgress\r\n\t\t}\r\n\r\n\t\tif (!smoothProgressTimer) {\r\n\t\t\tsmoothProgressTimer = setInterval(() => {\r\n\t\t\t\tconst now = Date.now()\r\n\t\t\t\tconst timeSinceLastUpdate = now - lastUpdateTime\r\n\r\n\t\t\t\tif (currentDisplayProgress < targetProgress) {\r\n\t\t\t\t\tconst diff = targetProgress - currentDisplayProgress\r\n\t\t\t\t\tconst step = Math.max(0.5, diff / 10)\r\n\t\t\t\t\tcurrentDisplayProgress = Math.min(currentDisplayProgress + step, targetProgress)\r\n\t\t\t\t} else if (currentDisplayProgress >= targetProgress && targetProgress < 100) {\r\n\t\t\t\t\tif (timeSinceLastUpdate > 5000) {\r\n\t\t\t\t\t\tconst maxAllowedProgress = Math.min(targetProgress + 5, 99)\r\n\t\t\t\t\t\tif (currentDisplayProgress < maxAllowedProgress) {\r\n\t\t\t\t\t\t\tcurrentDisplayProgress += 0.1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttaskProgress.value = Math.floor(currentDisplayProgress)\r\n\r\n\t\t\t\tif (currentDisplayProgress >= 99.9 && targetProgress >= 100) {\r\n\t\t\t\t\tclearInterval(smoothProgressTimer)\r\n\t\t\t\t\tsmoothProgressTimer = null\r\n\t\t\t\t\tcurrentDisplayProgress = 100\r\n\t\t\t\t\ttaskProgress.value = 100\r\n\t\t\t\t\ttaskState.value = 'success'\r\n\t\t\t\t\ttaskStatusText.value = 'Á´£Â∑•È™åÊî∂Êä•ÂëäÁîüÊàêÂÆåÊàê'\r\n\t\t\t\t}\r\n\t\t\t}, 50)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ê∏ÖÁêÜËøõÂ∫¶ËÆ°Êó∂Âô®\r\n\t */\r\n\tfunction clearProgressTimer() {\r\n\t\tif (smoothProgressTimer) {\r\n\t\t\tclearInterval(smoothProgressTimer)\r\n\t\t\tsmoothProgressTimer = null\r\n\t\t}\r\n\t\tcurrentDisplayProgress = 0\r\n\t\ttargetProgress = 0\r\n\t\tlastTargetProgress = 0\r\n\t\tlastUpdateTime = 0\r\n\t\ttaskProgress.value = 0\r\n\t\ttaskStatusText.value = 'Ê≠£Âú®ÂàùÂßãÂåñ...'\r\n\t\ttaskState.value = 'running'\r\n\t}\r\n\r\n\t/**\r\n\t * ÂàáÊç¢Êä•ÂëäÁ±ªÂûã\r\n\t * @param {string} type - Êä•ÂëäÁ±ªÂûã\r\n\t */\r\n\tfunction changeReportType(type) {\r\n\t\treportType.value = type\r\n\t}\r\n\r\n\t/**\r\n\t * ÁîüÊàêÁ´£Â∑•È™åÊî∂Êä•Âëä\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t * @param {boolean} hasExtracted - ÊòØÂê¶Â∑≤ÊèêÂèñÈ°πÁõÆ‰ø°ÊÅØ\r\n\t * @param {Object} modalRef - ËøõÂ∫¶ÂºπÁ™óÁöÑ ref\r\n\t */\r\n\tasync function generateReport(projectId, hasExtracted, modalRef) {\r\n\t\t// ÂâçÁΩÆÊ£ÄÊü•\r\n\t\tif (!projectId) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÊèêÁ§∫',\r\n\t\t\t\tcontent: 'ËØ∑ÂÖàÈÄâÊã©È°πÁõÆ',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!hasExtracted) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÊèêÁ§∫',\r\n\t\t\t\tcontent: 'ËØ∑ÂÖàÊèêÂèñÈ°πÁõÆ‰ø°ÊÅØ',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (reportType.value === 'withData' && !testReportFiles.value.length) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'ÊúâÁõëÊµãÊï∞ÊçÆÊä•ÂëäÔºåÂøÖÈ°ªË¶ÅÂÖà‰∏ä‰º†ÁõëÊµãÊä•Âëä',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tisGenerating.value = true\r\n\t\tclearProgressTimer()\r\n\r\n\t\t// ÊâìÂºÄËøõÂ∫¶ÂºπÁ™ó\r\n\t\tif (modalRef) {\r\n\t\t\tmodalRef.open()\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait apiGenerateReport({\r\n\t\t\t\tprojectId: projectId,\r\n\t\t\t\tonProgress: (progress, statusText) => {\r\n\t\t\t\t\tupdateProgressSmooth(progress, statusText)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// ÁîüÊàêÊàêÂäü\r\n\t\t\tconsole.log('üéâ Á´£Â∑•È™åÊî∂Êä•ÂëäÁîüÊàêÊàêÂäüÔºåËÆæÁΩÆ reportGenerated.value = true')\r\n\t\t\treportGenerated.value = true\r\n\t\t\tpreviewTitle.value = reportType.value === 'withoutData' \r\n\t\t\t\t? 'Êó†ÁõëÊµãÊï∞ÊçÆÁöÑÁ´£Â∑•È™åÊî∂Êä•ÂëäÂ∑≤ÁîüÊàêÔºåËØ∑ÁÇπÂáª‰∏ãËΩΩÔºÅ'\r\n\t\t\t\t: 'ÊúâÁõëÊµãÊï∞ÊçÆÁöÑÁ´£Â∑•È™åÊî∂Êä•ÂëäÂ∑≤ÁîüÊàêÔºåËØ∑ÁÇπÂáª‰∏ãËΩΩÔºÅ'\r\n\t\t\t\r\n\t\t\tconsole.log('üìä ÂΩìÂâç reportGenerated.value:', reportGenerated.value)\r\n\t\t\tconsole.log('üìä ÂΩìÂâç canDownloadReport.value:', canDownloadReport.value)\r\n\t\t\t\r\n\t\t\tsaveReportCache(projectId, {\r\n\t\t\t\tgenerated: true,\r\n\t\t\t\ttype: reportType.value,\r\n\t\t\t\tpreviewTitle: previewTitle.value\r\n\t\t\t})\r\n\r\n\t\t\t// ÂÖ≥Èó≠ÂºπÁ™ó\r\n\t\t\tif (modalRef) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tmodalRef.close()\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'ÁîüÊàêÊàêÂäüÔºåÂèØ‰∏ãËΩΩÊä•Âëä',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t} catch (error) {\r\n\t\t\tclearProgressTimer()\r\n\t\t\t\r\n\t\t\tif (modalRef) {\r\n\t\t\t\tmodalRef.close()\r\n\t\t\t}\r\n\r\n\t\t\t// ÈîôËØØÂ§ÑÁêÜ\r\n\t\t\tconsole.error('ÁîüÊàêÊä•ÂëäÂ§±Ë¥•', error, error.response?.data)\r\n\r\n\t\t\tlet msg = error.message || 'ËØ∑Á®çÂêéÈáçËØï'\r\n\t\t\tif (Array.isArray(error.response?.data?.detail)) {\r\n\t\t\t\tmsg = error.response.data.detail.map(d => d.msg).join('Ôºõ')\r\n\t\t\t} else if (typeof error.response?.data === 'string') {\r\n\t\t\t\tmsg = error.response.data\r\n\t\t\t}\r\n\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÁîüÊàêÂ§±Ë¥•',\r\n\t\t\t\tcontent: msg,\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tisGenerating.value = false\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ‰∏ãËΩΩÁ´£Â∑•È™åÊî∂Êä•Âëä\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t */\r\n\tasync function downloadReport(projectId) {\r\n\t\tif (!projectId) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'ËØ∑ÂÖàÈÄâÊã©È°πÁõÆ',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: 'Ê≠£Âú®‰∏ãËΩΩÁ´£Â∑•È™åÊî∂Êä•Âëä‚Ä¶',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\tconst { ab, filename } = await apiDownloadReport(projectId)\r\n\t\t\tawait saveArrayBuffer(ab, filename)\r\n\t\t\t\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'Â∑≤‰øùÂ≠òÔºö' + filename,\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '‰∏ãËΩΩÂ§±Ë¥•',\r\n\t\t\t\tcontent: error.message,\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ë∑®Âπ≥Âè∞‰øùÂ≠òÊñá‰ª∂\r\n\t * @param {ArrayBuffer} arrayBuffer - Êñá‰ª∂Êï∞ÊçÆ\r\n\t * @param {string} filename - Êñá‰ª∂Âêç\r\n\t */\r\n\tasync function saveArrayBuffer(arrayBuffer, filename) {\r\n\t\t// #ifdef H5\r\n\t\tconst blob = new Blob([arrayBuffer], {\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n\t\t})\r\n\t\tconst url = URL.createObjectURL(blob)\r\n\t\tconst a = document.createElement('a')\r\n\t\ta.href = url\r\n\t\ta.download = filename\r\n\t\tdocument.body.appendChild(a)\r\n\t\ta.click()\r\n\t\tdocument.body.removeChild(a)\r\n\t\tURL.revokeObjectURL(url)\r\n\t\t// #endif\r\n\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tconst fs = wx.getFileSystemManager()\r\n\t\tconst filePath = `${wx.env.USER_DATA_PATH}/${filename}`\r\n\t\tfs.writeFile({\r\n\t\t\tfilePath,\r\n\t\t\tdata: arrayBuffer,\r\n\t\t\tencoding: 'binary',\r\n\t\t\tsuccess: () => wx.openDocument({\r\n\t\t\t\tfilePath,\r\n\t\t\t\tfileType: 'docx'\r\n\t\t\t}),\r\n\t\t\tfail: () => uni.showToast({\r\n\t\t\t\ttitle: '‰øùÂ≠òÂ§±Ë¥•',\r\n\t\t\t\ticon: 'error'\r\n\t\t\t})\r\n\t\t})\r\n\t\t// #endif\r\n\r\n\t\t// #ifdef APP-PLUS\r\n\t\tplus.io.requestFileSystem(plus.io.PUBLIC_DOWNLOADS, fs => {\r\n\t\t\tfs.root.getFile(filename, {\r\n\t\t\t\tcreate: true\r\n\t\t\t}, entry => {\r\n\t\t\t\tentry.createWriter(writer => {\r\n\t\t\t\t\twriter.write(arrayBuffer)\r\n\t\t\t\t\twriter.onwrite = () => uni.showToast({\r\n\t\t\t\t\t\ttitle: 'Â∑≤‰øùÂ≠òÂà∞‰∏ãËΩΩÁõÆÂΩï'\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t\t// #endif\r\n\t}\r\n\r\n\t/**\r\n\t * ‰øùÂ≠òÊä•ÂëäÁºìÂ≠òÂà∞Êú¨Âú∞\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t * @param {Object} reportData - Êä•ÂëäÊï∞ÊçÆ\r\n\t */\r\n\tfunction saveReportCache(projectId, reportData) {\r\n\t\ttry {\r\n\t\t\tconst cacheKey = `acceptance_report_${projectId}`\r\n\t\t\tconst cacheData = {\r\n\t\t\t\t...reportData,\r\n\t\t\t\tgeneratedAt: Date.now()\r\n\t\t\t}\r\n\t\t\tuni.setStorageSync(cacheKey, JSON.stringify(cacheData))\r\n\t\t\tconsole.log(`‚úÖ È°πÁõÆ ${projectId} ÁöÑÁ´£Â∑•È™åÊî∂Êä•ÂëäÂ∑≤ÁºìÂ≠ò`)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('‰øùÂ≠òÁ´£Â∑•È™åÊî∂Êä•ÂëäÁºìÂ≠òÂ§±Ë¥•:', error)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ‰ªéÊú¨Âú∞Âä†ËΩΩÊä•ÂëäÁºìÂ≠ò\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t */\r\n\tfunction loadReportCache(projectId) {\r\n\t\ttry {\r\n\t\t\tconst cacheKey = `acceptance_report_${projectId}`\r\n\t\t\tconst cachedData = uni.getStorageSync(cacheKey)\r\n\r\n\t\t\tif (cachedData) {\r\n\t\t\t\tconst cacheData = JSON.parse(cachedData)\r\n\t\t\t\treportGenerated.value = cacheData.generated || false\r\n\t\t\t\treportType.value = cacheData.type || 'withoutData'\r\n\t\t\t\tpreviewTitle.value = cacheData.previewTitle || ''\r\n\t\t\t\tconsole.log(`‚úÖ Â∑≤Âä†ËΩΩÈ°πÁõÆ ${projectId} ÁöÑÁ´£Â∑•È™åÊî∂Êä•ÂëäÁºìÂ≠ò`)\r\n\t\t\t} else {\r\n\t\t\t\treportGenerated.value = false\r\n\t\t\t\treportType.value = 'withoutData'\r\n\t\t\t\tpreviewTitle.value = ''\r\n\t\t\t\tconsole.log(`‚ÑπÔ∏è È°πÁõÆ ${projectId} ÊöÇÊó†Á´£Â∑•È™åÊî∂Êä•ÂëäÁºìÂ≠ò`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Âä†ËΩΩÁ´£Â∑•È™åÊî∂Êä•ÂëäÁºìÂ≠òÂ§±Ë¥•:', error)\r\n\t\t\treportGenerated.value = false\r\n\t\t\treportType.value = 'withoutData'\r\n\t\t\tpreviewTitle.value = ''\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ê∏ÖÈô§Êä•ÂëäÁºìÂ≠ò\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t */\r\n\tfunction clearReportCache(projectId) {\r\n\t\ttry {\r\n\t\t\tconst cacheKey = `acceptance_report_${projectId}`\r\n\t\t\tuni.removeStorageSync(cacheKey)\r\n\t\t\treportGenerated.value = false\r\n\t\t\treportType.value = 'withoutData'\r\n\t\t\tpreviewTitle.value = ''\r\n\t\t\ttestReportFiles.value = []\r\n\t\t\tconsole.log(`‚úÖ Â∑≤Ê∏ÖÈô§È°πÁõÆ ${projectId} ÁöÑÁ´£Â∑•È™åÊî∂Êä•ÂëäÁºìÂ≠ò`)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Ê∏ÖÈô§Á´£Â∑•È™åÊî∂Êä•ÂëäÁºìÂ≠òÂ§±Ë¥•:', error)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ÈáçÁΩÆÁä∂ÊÄÅÔºàÂàáÊç¢È°πÁõÆÊó∂‰ΩøÁî®Ôºâ\r\n\t */\r\n\tfunction resetState() {\r\n\t\treportGenerated.value = false\r\n\t\treportType.value = 'withoutData'\r\n\t\tpreviewTitle.value = ''\r\n\t\ttestReportFiles.value = []\r\n\t\tisGenerating.value = false\r\n\t\tclearProgressTimer()\r\n\t}\r\n\r\n\t// ÂàõÂª∫ÂÆû‰æãÂØπË±°\r\n\tinstance = {\r\n\t\t// Áä∂ÊÄÅ\r\n\t\treportGenerated,\r\n\t\treportType,\r\n\t\ttestReportFiles,\r\n\t\tpreviewTitle,\r\n\t\tcanDownloadReport,\r\n\t\tisGenerating,\r\n\t\ttaskProgress,\r\n\t\ttaskStatusText,\r\n\t\ttaskState,\r\n\t\treportTypes,\r\n\r\n\t\t// ÊñπÊ≥ï\r\n\t\tchangeReportType,\r\n\t\tgenerateReport,\r\n\t\tdownloadReport,\r\n\t\tloadReportCache,\r\n\t\tsaveReportCache,\r\n\t\tclearReportCache,\r\n\t\tresetState\r\n\t}\r\n\r\n\treturn instance\r\n}\r\n"],"names":["ref","computed","uni","apiGenerateReport","apiDownloadReport","wx"],"mappings":"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"}