{"version":3,"file":"useMonitorPlan.js","sources":["composables/useMonitorPlan.js"],"sourcesContent":["import { ref, computed } from 'vue'\r\nimport { generateMonitorPlan as apiGenerateMonitorPlan, downloadMonitorPlan as apiDownloadMonitorPlan } from '@/api/acceptance.js'\r\n\r\n/**\r\n * ÁõëÊµãÊñπÊ°àÁÆ°ÁêÜ Composable\r\n * ÁÆ°ÁêÜÁõëÊµãÊñπÊ°àÁöÑÁîüÊàê„ÄÅ‰∏ãËΩΩ„ÄÅÁºìÂ≠òÁ≠âÂäüËÉΩ\r\n */\r\n\r\n// ÂàõÂª∫Âçï‰æãÁä∂ÊÄÅÔºàÁ°Æ‰øùÊâÄÊúâÁªÑ‰ª∂ÂÖ±‰∫´Âêå‰∏Ä‰ªΩÊï∞ÊçÆÔºâ\r\nlet instance = null\r\n\r\nexport function useMonitorPlan() {\r\n\t// Â¶ÇÊûúÂ∑≤ÁªèÂàõÂª∫ËøáÂÆû‰æãÔºåÁõ¥Êé•ËøîÂõû\r\n\tif (instance) {\r\n\t\treturn instance\r\n\t}\r\n\r\n\t// Áä∂ÊÄÅÁÆ°ÁêÜ\r\n\tconst plan = ref(null)                    // ÊñπÊ°àÊï∞ÊçÆÔºàtrue Ë°®Á§∫Â∑≤ÁîüÊàêÔºâ\r\n\tconst isGenerating = ref(false)           // ÊòØÂê¶Ê≠£Âú®ÁîüÊàê\r\n\tconst taskProgress = ref(0)               // ÁîüÊàêËøõÂ∫¶ 0-100\r\n\tconst taskStatusText = ref('')            // ÂΩìÂâçÊ≠•È™§ÊèèËø∞\r\n\tconst taskState = ref('pending')          // ‰ªªÂä°Áä∂ÊÄÅÔºöpending/running/success/failed\r\n\r\n\t// ËÆ°ÁÆóÂ±ûÊÄß\r\n\tconst canDownload = computed(() => plan.value !== null)\r\n\r\n\t// ËøõÂ∫¶Âπ≥ÊªëÂ§ÑÁêÜÂèòÈáè\r\n\tlet smoothProgressTimer = null\r\n\tlet currentDisplayProgress = 0\r\n\tlet targetProgress = 0\r\n\tlet lastTargetProgress = 0\r\n\tlet lastUpdateTime = 0\r\n\r\n\t/**\r\n\t * Âπ≥ÊªëÊõ¥Êñ∞ËøõÂ∫¶Êù°\r\n\t * @param {number} newProgress - Êñ∞ËøõÂ∫¶ÂÄº\r\n\t * @param {string} statusText - Áä∂ÊÄÅÊñáÊú¨\r\n\t * @param {string} state - ‰ªªÂä°Áä∂ÊÄÅ\r\n\t */\r\n\tfunction updateProgressSmooth(newProgress, statusText, state = 'running') {\r\n\t\tconst progressChanged = newProgress !== lastTargetProgress\r\n\r\n\t\ttargetProgress = newProgress\r\n\t\ttaskStatusText.value = statusText\r\n\t\ttaskState.value = state\r\n\r\n\t\tif (progressChanged) {\r\n\t\t\tlastUpdateTime = Date.now()\r\n\t\t\tlastTargetProgress = newProgress\r\n\t\t}\r\n\r\n\t\tif (!smoothProgressTimer) {\r\n\t\t\tsmoothProgressTimer = setInterval(() => {\r\n\t\t\t\tconst now = Date.now()\r\n\t\t\t\tconst timeSinceLastUpdate = now - lastUpdateTime\r\n\r\n\t\t\t\tif (currentDisplayProgress < targetProgress) {\r\n\t\t\t\t\tconst diff = targetProgress - currentDisplayProgress\r\n\t\t\t\t\tconst step = Math.max(0.5, diff / 10)\r\n\t\t\t\t\tcurrentDisplayProgress = Math.min(currentDisplayProgress + step, targetProgress)\r\n\t\t\t\t} else if (currentDisplayProgress >= targetProgress && targetProgress < 100) {\r\n\t\t\t\t\tif (timeSinceLastUpdate > 5000) {\r\n\t\t\t\t\t\tconst maxAllowedProgress = Math.min(targetProgress + 5, 99)\r\n\t\t\t\t\t\tif (currentDisplayProgress < maxAllowedProgress) {\r\n\t\t\t\t\t\t\tcurrentDisplayProgress += 0.1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttaskProgress.value = Math.floor(currentDisplayProgress)\r\n\r\n\t\t\t\tif (currentDisplayProgress >= 99.9 && targetProgress >= 100) {\r\n\t\t\t\t\tclearInterval(smoothProgressTimer)\r\n\t\t\t\t\tsmoothProgressTimer = null\r\n\t\t\t\t\tcurrentDisplayProgress = 100\r\n\t\t\t\t\ttaskProgress.value = 100\r\n\t\t\t\t\ttaskState.value = 'success'\r\n\t\t\t\t\ttaskStatusText.value = 'ÁõëÊµãÊñπÊ°àÁîüÊàêÂÆåÊàê'\r\n\t\t\t\t}\r\n\t\t\t}, 50)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ê∏ÖÁêÜËøõÂ∫¶ËÆ°Êó∂Âô®\r\n\t */\r\n\tfunction clearProgressTimer() {\r\n\t\tif (smoothProgressTimer) {\r\n\t\t\tclearInterval(smoothProgressTimer)\r\n\t\t\tsmoothProgressTimer = null\r\n\t\t}\r\n\t\tcurrentDisplayProgress = 0\r\n\t\ttargetProgress = 0\r\n\t\tlastTargetProgress = 0\r\n\t\tlastUpdateTime = 0\r\n\t\ttaskProgress.value = 0\r\n\t\ttaskStatusText.value = 'Ê≠£Âú®ÂàùÂßãÂåñ...'\r\n\t\ttaskState.value = 'running'\r\n\t}\r\n\r\n\t/**\r\n\t * ÁîüÊàêÁõëÊµãÊñπÊ°à\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t * @param {boolean} hasExtracted - ÊòØÂê¶Â∑≤ÊèêÂèñÈ°πÁõÆ‰ø°ÊÅØ\r\n\t * @param {Object} modalRef - ËøõÂ∫¶ÂºπÁ™óÁöÑ ref\r\n\t */\r\n\tasync function generatePlan(projectId, hasExtracted, modalRef) {\r\n\t\t// ÂâçÁΩÆÊ£ÄÊü•\r\n\t\tif (!projectId) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÊèêÁ§∫',\r\n\t\t\t\tcontent: 'ËØ∑ÂÖàÈÄâÊã©È°πÁõÆ',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (!hasExtracted) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÊèêÁ§∫',\r\n\t\t\t\tcontent: 'ËØ∑ÂÖàÊèêÂèñÈ°πÁõÆ‰ø°ÊÅØ',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tisGenerating.value = true\r\n\t\tclearProgressTimer()\r\n\r\n\t\t// ÊâìÂºÄËøõÂ∫¶ÂºπÁ™ó\r\n\t\tif (modalRef) {\r\n\t\t\tmodalRef.open()\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait apiGenerateMonitorPlan({\r\n\t\t\t\tprojectId: projectId,\r\n\t\t\t\tonProgress: (progress, statusText) => {\r\n\t\t\t\t\tupdateProgressSmooth(progress, statusText)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// ÁîüÊàêÊàêÂäü\r\n\t\t\tconsole.log('üéâ ÁõëÊµãÊñπÊ°àÁîüÊàêÊàêÂäüÔºåËÆæÁΩÆ plan.value = true')\r\n\t\t\tplan.value = true\r\n\t\t\tconsole.log('üìä ÂΩìÂâç plan.value:', plan.value)\r\n\t\t\tconsole.log('üìä ÂΩìÂâç canDownload.value:', canDownload.value)\r\n\t\t\t\r\n\t\t\tsavePlanCache(projectId, true)\r\n\r\n\t\t\t// ÂÖ≥Èó≠ÂºπÁ™ó\r\n\t\t\tif (modalRef) {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tmodalRef.close()\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'ÁîüÊàêÊàêÂäüÔºåÂèØ‰∏ãËΩΩÊä•Âëä',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\r\n\t\t} catch (error) {\r\n\t\t\tclearProgressTimer()\r\n\t\t\t\r\n\t\t\tif (modalRef) {\r\n\t\t\t\tmodalRef.close()\r\n\t\t\t}\r\n\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: 'ÁîüÊàêÂ§±Ë¥•',\r\n\t\t\t\tcontent: error.message || 'ËØ∑Á®çÂêéÈáçËØï',\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t} finally {\r\n\t\t\tisGenerating.value = false\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ‰∏ãËΩΩÁõëÊµãÊñπÊ°à\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t */\r\n\tasync function downloadPlan(projectId) {\r\n\t\tif (!projectId) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'ËØ∑ÂÖàÈÄâÊã©È°πÁõÆ',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: 'Ê≠£Âú®‰∏ãËΩΩÁõëÊµãÊñπÊ°à‚Ä¶',\r\n\t\t\tmask: true\r\n\t\t})\r\n\r\n\t\ttry {\r\n\t\t\tconst { ab, filename } = await apiDownloadMonitorPlan(projectId)\r\n\t\t\tawait saveArrayBuffer(ab, filename)\r\n\t\t\t\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: 'Â∑≤‰øùÂ≠òÔºö' + filename,\r\n\t\t\t\ticon: 'success'\r\n\t\t\t})\r\n\t\t} catch (error) {\r\n\t\t\tuni.hideLoading()\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '‰∏ãËΩΩÂ§±Ë¥•',\r\n\t\t\t\tcontent: error.message,\r\n\t\t\t\tshowCancel: false\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ë∑®Âπ≥Âè∞‰øùÂ≠òÊñá‰ª∂\r\n\t * @param {ArrayBuffer} arrayBuffer - Êñá‰ª∂Êï∞ÊçÆ\r\n\t * @param {string} filename - Êñá‰ª∂Âêç\r\n\t */\r\n\tasync function saveArrayBuffer(arrayBuffer, filename) {\r\n\t\t// #ifdef H5\r\n\t\tconst blob = new Blob([arrayBuffer], {\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n\t\t})\r\n\t\tconst url = URL.createObjectURL(blob)\r\n\t\tconst a = document.createElement('a')\r\n\t\ta.href = url\r\n\t\ta.download = filename\r\n\t\tdocument.body.appendChild(a)\r\n\t\ta.click()\r\n\t\tdocument.body.removeChild(a)\r\n\t\tURL.revokeObjectURL(url)\r\n\t\t// #endif\r\n\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tconst fs = wx.getFileSystemManager()\r\n\t\tconst filePath = `${wx.env.USER_DATA_PATH}/${filename}`\r\n\t\tfs.writeFile({\r\n\t\t\tfilePath,\r\n\t\t\tdata: arrayBuffer,\r\n\t\t\tencoding: 'binary',\r\n\t\t\tsuccess: () => wx.openDocument({\r\n\t\t\t\tfilePath,\r\n\t\t\t\tfileType: 'docx'\r\n\t\t\t}),\r\n\t\t\tfail: () => uni.showToast({\r\n\t\t\t\ttitle: '‰øùÂ≠òÂ§±Ë¥•',\r\n\t\t\t\ticon: 'error'\r\n\t\t\t})\r\n\t\t})\r\n\t\t// #endif\r\n\r\n\t\t// #ifdef APP-PLUS\r\n\t\tplus.io.requestFileSystem(plus.io.PUBLIC_DOWNLOADS, fs => {\r\n\t\t\tfs.root.getFile(filename, {\r\n\t\t\t\tcreate: true\r\n\t\t\t}, entry => {\r\n\t\t\t\tentry.createWriter(writer => {\r\n\t\t\t\t\twriter.write(arrayBuffer)\r\n\t\t\t\t\twriter.onwrite = () => uni.showToast({\r\n\t\t\t\t\t\ttitle: 'Â∑≤‰øùÂ≠òÂà∞‰∏ãËΩΩÁõÆÂΩï'\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t\t// #endif\r\n\t}\r\n\r\n\t/**\r\n\t * ‰øùÂ≠òÊñπÊ°àÁºìÂ≠òÂà∞Êú¨Âú∞\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t * @param {boolean} planData - ÊñπÊ°àÊï∞ÊçÆ\r\n\t */\r\n\tfunction savePlanCache(projectId, planData) {\r\n\t\ttry {\r\n\t\t\tconst cacheKey = `monitor_plan_${projectId}`\r\n\t\t\tconst cacheData = {\r\n\t\t\t\tplan: planData,\r\n\t\t\t\tgeneratedAt: Date.now()\r\n\t\t\t}\r\n\t\t\tuni.setStorageSync(cacheKey, JSON.stringify(cacheData))\r\n\t\t\tconsole.log(`‚úÖ È°πÁõÆ ${projectId} ÁöÑÁõëÊµãÊñπÊ°àÂ∑≤ÁºìÂ≠ò`)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('‰øùÂ≠òÁõëÊµãÊñπÊ°àÁºìÂ≠òÂ§±Ë¥•:', error)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ‰ªéÊú¨Âú∞Âä†ËΩΩÊñπÊ°àÁºìÂ≠ò\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t */\r\n\tfunction loadPlanCache(projectId) {\r\n\t\ttry {\r\n\t\t\tconst cacheKey = `monitor_plan_${projectId}`\r\n\t\t\tconst cachedData = uni.getStorageSync(cacheKey)\r\n\r\n\t\t\tif (cachedData) {\r\n\t\t\t\tconst cacheData = JSON.parse(cachedData)\r\n\t\t\t\tplan.value = cacheData.plan\r\n\t\t\t\tconsole.log(`‚úÖ Â∑≤Âä†ËΩΩÈ°πÁõÆ ${projectId} ÁöÑÁõëÊµãÊñπÊ°àÁºìÂ≠ò`)\r\n\t\t\t} else {\r\n\t\t\t\tplan.value = null\r\n\t\t\t\tconsole.log(`‚ÑπÔ∏è È°πÁõÆ ${projectId} ÊöÇÊó†ÁõëÊµãÊñπÊ°àÁºìÂ≠ò`)\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Âä†ËΩΩÁõëÊµãÊñπÊ°àÁºìÂ≠òÂ§±Ë¥•:', error)\r\n\t\t\tplan.value = null\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Ê∏ÖÈô§ÊñπÊ°àÁºìÂ≠ò\r\n\t * @param {number} projectId - È°πÁõÆID\r\n\t */\r\n\tfunction clearPlanCache(projectId) {\r\n\t\ttry {\r\n\t\t\tconst cacheKey = `monitor_plan_${projectId}`\r\n\t\t\tuni.removeStorageSync(cacheKey)\r\n\t\t\tplan.value = null\r\n\t\t\tconsole.log(`‚úÖ Â∑≤Ê∏ÖÈô§È°πÁõÆ ${projectId} ÁöÑÁõëÊµãÊñπÊ°àÁºìÂ≠ò`)\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Ê∏ÖÈô§ÁõëÊµãÊñπÊ°àÁºìÂ≠òÂ§±Ë¥•:', error)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * ÈáçÁΩÆÁä∂ÊÄÅÔºàÂàáÊç¢È°πÁõÆÊó∂‰ΩøÁî®Ôºâ\r\n\t */\r\n\tfunction resetState() {\r\n\t\tplan.value = null\r\n\t\tisGenerating.value = false\r\n\t\tclearProgressTimer()\r\n\t}\r\n\r\n\t// ÂàõÂª∫ÂÆû‰æãÂØπË±°\r\n\tinstance = {\r\n\t\t// Áä∂ÊÄÅ\r\n\t\tplan,\r\n\t\tcanDownload,\r\n\t\tisGenerating,\r\n\t\ttaskProgress,\r\n\t\ttaskStatusText,\r\n\t\ttaskState,\r\n\r\n\t\t// ÊñπÊ≥ï\r\n\t\tgeneratePlan,\r\n\t\tdownloadPlan,\r\n\t\tloadPlanCache,\r\n\t\tsavePlanCache,\r\n\t\tclearPlanCache,\r\n\t\tresetState\r\n\t}\r\n\r\n\treturn instance\r\n}\r\n"],"names":["ref","computed","uni","apiGenerateMonitorPlan","apiDownloadMonitorPlan","wx"],"mappings":"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"}