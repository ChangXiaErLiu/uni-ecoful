"use strict";const e=require("../../common/vendor.js"),t=require("../../common/assets.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const s={__name:"ChatMessage",props:{message:{type:Object,default:()=>({})}},emits:["feedback","request-edit","edit"],setup(s,{emit:n}){const a=s,o=n,i=e.computed((()=>{var e;return"user"===(null==(e=a.message)?void 0:e.role)}));e.watch((()=>a.message),(e=>{}),{deep:!0}),e.onMounted((()=>{}));const l=e=>{if(!e)return"";const t=new Date(e);return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},c=()=>{var e,t,s,n,i;o("request-edit",{id:null==(e=a.message)?void 0:e.id,content:"string"==typeof(null==(t=a.message)?void 0:t.content)?a.message.content:(null==(n=null==(s=a.message)?void 0:s.content)?void 0:n.content)||"",attachments:(null==(i=a.message)?void 0:i.attachments)||[]})},d=async t=>{var s;let n="";if("string"==typeof t?n=t:t&&"object"==typeof t&&(n=t.content||""),n=String(n||"").trim(),n){try{return await new Promise(((t,s)=>{try{e.index.setClipboardData({data:n,success:t,fail:s})}catch(a){s(a)}})),void e.index.showToast({title:"已复制到剪贴板",icon:"success"})}catch(a){}try{if("undefined"!=typeof navigator&&(null==(s=navigator.clipboard)?void 0:s.writeText))return await navigator.clipboard.writeText(n),void e.index.showToast({title:"已复制到剪贴板",icon:"success"})}catch(a){}try{if("undefined"!=typeof document){const t=document.createElement("textarea");t.value=n,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();const s=document.execCommand("copy");if(document.body.removeChild(t),s)return void e.index.showToast({title:"已复制到剪贴板",icon:"success"})}}catch(a){}e.index.showToast({title:"复制失败",icon:"error"})}},r=e=>{var t;(null==(t=a.message)?void 0:t.id)&&o("feedback",a.message.id,e)};return(n,a)=>{var o,m,u,p,g,v,f,h,b,y,k,w,x,_,z,j,C;return e.e({a:i.value},i.value?{b:t._imports_0$1}:{c:t._imports_1},{d:e.t(i.value?"我":"AI助手"),e:e.t(l(null==(o=s.message)?void 0:o.timestamp)),f:i.value},i.value?e.e({g:e.t("string"==typeof(null==(m=s.message)?void 0:m.content)?s.message.content:(null==(p=null==(u=s.message)?void 0:u.content)?void 0:p.content)||""),h:(null==(g=s.message)?void 0:g.attachments)&&s.message.attachments.length},(null==(v=s.message)?void 0:v.attachments)&&s.message.attachments.length?{i:e.f(s.message.attachments,((t,s,n)=>e.e({a:/\\.(png|jpe?g|gif|bmp|webp|heic|heif)$/i.test((null==t?void 0:t.name)||(null==t?void 0:t.url)||"")},/\\.(png|jpe?g|gif|bmp|webp|heic|heif)$/i.test((null==t?void 0:t.name)||(null==t?void 0:t.url)||"")?{b:t.url}:{c:"7e97c1db-0-"+n,d:e.p({type:"paperclip",size:"14",color:"#64748b"})},{e:e.t(t.name||"附件"),f:s})))}:{},{j:e.p({type:"compose",size:"16",color:"#ffffff"}),k:e.o(c),l:e.p({type:"paperclip",size:"16",color:"#ffffff"}),m:e.o((e=>{var t;return d(null==(t=s.message)?void 0:t.content)}))}):e.e({n:e.t("string"==typeof(null==(f=s.message)?void 0:f.content)?s.message.content:(null==(b=null==(h=s.message)?void 0:h.content)?void 0:b.content)||" "),o:(null==(y=s.message)?void 0:y.attachments)&&s.message.attachments.length},(null==(k=s.message)?void 0:k.attachments)&&s.message.attachments.length?{p:e.f(s.message.attachments,((t,s,n)=>({a:"7e97c1db-3-"+n,b:e.t(t.name),c:s}))),q:e.p({type:"paperclip",size:"14",color:"#64748b"})}:{},{r:e.p({type:"like"===(null==(w=s.message)?void 0:w.feedback)?"hand-up-filled":"hand-up",size:"16",color:"like"===(null==(x=s.message)?void 0:x.feedback)?"#ffffff":"#64748b"}),s:"like"===(null==(_=s.message)?void 0:_.feedback)?1:"",t:e.o((e=>r("like"))),v:e.p({type:"dislike"===(null==(z=s.message)?void 0:z.feedback)?"hand-down-filled":"hand-down",size:"16",color:"dislike"===(null==(j=s.message)?void 0:j.feedback)?"#ef4444":"#64748b"}),w:"dislike"===(null==(C=s.message)?void 0:C.feedback)?1:"",x:e.o((e=>r("dislike"))),y:e.p({type:"paperclip",size:"16",color:"#64748b"}),z:e.o((e=>{var t;return d(null==(t=s.message)?void 0:t.content)}))}),{A:i.value?1:"",B:i.value?"":1})}}},n=e._export_sfc(s,[["__scopeId","data-v-7e97c1db"]]);wx.createComponent(n);
